import{f as v}from"./chunk-4XLIKA67-cached.js";import{a as m}from"./chunk-OMOH7TRL-cached.js";var p={name:"Avatar",props:{src:[String,Object],alt:{type:String,default:""},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)}},mounted(){console.log(`Avatar under ${this.$parent.$vnode.tag} blobURL:`,this.blobURL,"src:",this.src),this.src&&typeof this.src=="object"&&this.downloadFile(this.src).catch(e=>{console.error("[Avatar.vue] Error in downloadFile",e)})},beforeDestroy(){this.revokeObjectURL()},data(){return{revokableObjectURL:null,blobURL:null}},methods:{revokeObjectURL(){this.revokableObjectURL&&URL.revokeObjectURL(this.revokableObjectURL),this.revokableObjectURL=null},setFromBlob(e){this.revokableObjectURL=this.blobURL=URL.createObjectURL(e)},async downloadFile(e){let r=await m("gi.db/filesCache/load",e.manifestCid).catch(n=>{console.error("[Avatar.vue] Error loading file from cache",n)}),i=r?new Blob([r]):null;if(e===this.src){if(i){this.setFromBlob(i);return}try{let n=await m("chelonia/fileDownload",new v(e)),o=await n.arrayBuffer();if(m("gi.db/filesCache/save",e.manifestCid,o).catch(d=>{console.error("[Avatar.vue] Error caching avatar blob",d)}),e!==this.src)return;this.setFromBlob(n)}catch(n){console.error("[Avatar.vue] Error setting avatar blob",n)}}}},watch:{src(e){e&&typeof e=="object"&&this.downloadFile(e).catch(r=>{console.error("[Avatar.vue] Error in downloadFile",r)})}},computed:{imageURL(){return this.blobURL||typeof this.src=="string"&&this.src}}},g=function(){var e=this,r=e.$createElement,i=e._self._c||r;return e.imageURL?i("img",e._g({ref:"img",staticClass:"c-avatar",class:"is-"+e.size,attrs:{src:e.imageURL,alt:e.alt,draggable:"false"},on:{load:e.revokeObjectURL,error:e.revokeObjectURL}},e.$listeners)):i("div",{staticClass:"c-avatar is-empty",class:"is-"+e.size})},y=[],R=function(e){e&&e("data-v-5f148adb_0",{source:'.c-avatar[data-v-5f148adb]{border-radius:50%;object-fit:cover;flex-shrink:0}.c-avatar[data-v-5f148adb]::after{content:"";display:block;padding-bottom:100%}.c-avatar.is-empty[data-v-5f148adb]{background-color:var(--general_0)}.c-avatar.is-xs[data-v-5f148adb]{width:1.5rem;height:1.5rem}.c-avatar.is-sm[data-v-5f148adb]{width:2rem;height:2rem}.c-avatar.is-md[data-v-5f148adb]{width:2.5rem;height:2.5rem}.c-avatar.is-lg[data-v-5f148adb]{width:4.5rem;height:4.5rem}.c-avatar.is-xl[data-v-5f148adb]{width:8rem;height:8rem}',map:void 0,media:void 0})},x="data-v-5f148adb",U=void 0,L=!1;function j(e,r,i,n,o,d,a,c,l,f){let t=(typeof i=="function"?i.options:i)||{};t.__file=`style>
`,t.render||(t.render=e.render,t.staticRenderFns=e.staticRenderFns,t._compiled=!0,o&&(t.functional=!0)),t._scopeId=n;{let u;if(r&&(u=a?function(s){r.call(this,f(s,this.$root.$options.shadowRoot))}:function(s){r.call(this,c(s))}),u!==void 0)if(t.functional){let s=t.render;t.render=function(b,h){return u.call(h),s(b,h)}}else{let s=t.beforeCreate;t.beforeCreate=s?[].concat(s,u):[u]}}return t}function _(){let e=_.styles||(_.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(n,o){if(document.querySelector('style[data-vue-ssr-id~="'+n+'"]'))return;let d=r?o.media||"default":n,a=e[d]||(e[d]={ids:[],parts:[],element:void 0});if(!a.ids.includes(n)){let c=o.source,l=a.ids.length;if(a.ids.push(n),o.map&&(c+=`
/*# sourceURL=`+o.map.sources[0]+" */",c+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),r&&(a.element=a.element||document.querySelector("style[data-group="+d+"]")),!a.element){let f=document.head||document.getElementsByTagName("head")[0],t=a.element=document.createElement("style");t.type="text/css",o.media&&t.setAttribute("media",o.media),r&&(t.setAttribute("data-group",d),t.setAttribute("data-next-index","0")),f.appendChild(t)}if(r&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let f=document.createTextNode(c),t=a.element.childNodes;t[l]&&a.element.removeChild(t[l]),t.length?a.element.insertBefore(f,t[l]):a.element.appendChild(f)}}}}var w=j({render:g,staticRenderFns:y},R,p,x,L,U,!1,_,void 0,void 0),O=w;export{O as a};
//# sourceMappingURL=chunk-TMYX4GL6-cached.js.map
