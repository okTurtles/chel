var s=Object.create(null),t=Object.create(null),p=[],f=Object.create(null),a=Object.create(null),i=Object.create(null),w=/^[^/]+/;function u(e,...o){let r=d(e),n=`${r}/*`,c=!!s[e],l=e;if(!c)if(s[n])l=n;else throw new Error(`SBP: selector not registered: ${e}`);for(let b of[a[e],f[r],p])if(b){for(let m of b)if(m(r,e,o)===!1)return}return c||o.unshift(e),s[l].apply(t[r].state,o)}function d(e){let o=w.exec(e);if(o===null)throw new Error(`SBP: selector missing domain: ${e}`);return o[0]}var g={"sbp/selectors/register":e=>{let o=[];for(let r in e){let n=d(r),c=n in t?t[n]:t[n]={state:Object.create(null),locked:!1};if(c.locked)(console.warn||console.log)(`[SBP WARN]: not registering selector on locked domain: '${r}'`);else if(s[r])(console.warn||console.log)(`[SBP WARN]: not registering already registered selector: '${r}'`);else if(typeof e[r]=="function"){i[r]&&(console.warn||console.log)(`[SBP WARN]: registering unsafe selector: '${r}' (remember to lock after overwriting)`);let l=s[r]=e[r];o.push(r),r===`${n}/_init`&&l.call(c.state)}}return o},"sbp/selectors/unregister":e=>{var o;for(let r of e){if(!i[r])throw new Error(`SBP: can't unregister locked selector: ${r}`);if(!((o=t[d(r)])===null||o===void 0)&&o.locked)throw new Error(`SBP: can't unregister selector on a locked domain: '${r}'`);delete s[r]}},"sbp/selectors/overwrite":e=>(u("sbp/selectors/unregister",Object.keys(e)),u("sbp/selectors/register",e)),"sbp/selectors/unsafe":e=>{for(let o of e){if(s[o])throw new Error("unsafe must be called before registering selector");i[o]=!0}},"sbp/selectors/lock":e=>{for(let o of e)delete i[o]},"sbp/selectors/fn":e=>s[e],"sbp/filters/global/add":e=>{p.push(e)},"sbp/filters/domain/add":(e,o)=>{f[e]||(f[e]=[]),f[e].push(o)},"sbp/filters/selector/add":(e,o)=>{a[e]||(a[e]=[]),a[e].push(o)},"sbp/domains/lock":e=>{if(e)for(let o of e){if(!t[o])throw new Error(`SBP: cannot lock non-existent domain: ${o}`);t[o].locked=!0}else for(let o in t)t[o].locked=!0}};g["sbp/selectors/register"](g);var S=u;export{S as a};
//# sourceMappingURL=chunk-OMOH7TRL-cached.js.map
