import{a as x}from"./chunk-XHZPFS4B-cached.js";import{c as b}from"./chunk-6P74MMKF-cached.js";import"./chunk-VUYUNB2W-cached.js";import{b as $}from"./chunk-R4DRX7L2-cached.js";import{a as I}from"./chunk-FTWBMR5D-cached.js";import{a as R}from"./chunk-GA3LN23N-cached.js";import"./chunk-3VFZYJBQ-cached.js";import"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import"./chunk-TEH4GFTX-cached.js";import{b as f}from"./chunk-QVCKPSEU-cached.js";import{a as g}from"./chunk-OMOH7TRL-cached.js";import{b as v,d as C}from"./chunk-WBBXU2FL-cached.js";import{e as p}from"./chunk-XMZXE55N-cached.js";var y=p(I());var N=p($());var T={name:"EditChannelNameModal",mixins:[y.validationMixin,x],components:{ModalTemplate:R,BannerScoped:b},computed:{...v(["currentGroupId"]),...C(["currentChatRoomId","currentChatRoomState","groupGeneralChatRoomId","groupChatRooms"]),maxNameCharacters(){return this.currentChatRoomState.settings.maxNameLength}},data(){return{channelId:this.$route.query.channel,submitting:!1,form:{name:null,existingNames:[]}}},created(){this.form.name=this.currentChatRoomState.attributes.name,this.form.existingNames=Object.keys(this.groupChatRooms).map(e=>this.groupChatRooms[e].name)},mounted(){this.groupGeneralChatRoomId===this.currentChatRoomId&&this.close(),this.$refs.name.focus()},methods:{close(){this.$refs.modal.close()},async submit(){try{if(this.submitting)return;this.submitting=!0,this.currentChatRoomState.attributes.name===this.form.name?console.log("TODO: Channel name is not changed"):this.currentChatRoomId===this.groupGeneralChatRoomId?console.log('TODO: "General" chatroom can not be renamed'):await g("gi.actions/group/renameChatRoom",{contractID:this.currentGroupId,data:{chatRoomID:this.currentChatRoomId,name:this.form.name}}),this.close()}catch(e){console.error("RenameChannelModal submit() error:",e),this.$refs.formMsg.danger(e.message)}finally{this.submitting=!1}}},validations:{form:{name:{[f("This field is required")]:N.default,[f("Reached character limit.")]:function(e){return e?Number(e.length)<=this.maxNameCharacters:!1},[f("Duplicate channel name")]:(e,r)=>{for(let n of r.existingNames)if(e.toUpperCase()===n.toUpperCase())return!1;return!0}}}}},E=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("modal-template",{ref:"modal",attrs:{a11yTitle:e.L("Rename channel")}},[n("template",{slot:"title"},[n("i18n",[e._v("Rename channel")])],1),n("form",{attrs:{novalidate:"novalidate"},on:{submit:function(o){o.preventDefault()}}},[n("label",{staticClass:"field"},[n("i18n",{staticClass:"label c-label-name"},[e._v("Name")]),e.form.name?n("div",{staticClass:"c-max-count",class:{"is-danger":e.form.name.length>=e.maxNameCharacters}},[e._v(e._s(e.maxNameCharacters-e.form.name.length))]):e._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"},{name:"error",rawName:"v-error:name",arg:"name"}],ref:"name",staticClass:"input",class:{error:e.$v.form.name.$error},attrs:{type:"text",name:"name",maxlength:e.maxNameCharacters,"data-test":"updateChannelName"},domProps:{value:e.form.name},on:{input:[function(o){o.target.composing||e.$set(e.form,"name",o.target.value)},function(o){return e.debounceField("name")}],blur:function(o){return e.updateField("name")}}})],1),n("banner-scoped",{ref:"formMsg"}),n("div",{staticClass:"buttons"},[n("i18n",{staticClass:"button is-outlined",on:{click:e.close}},[e._v("Cancel")]),n("i18n",{staticClass:"is-success",attrs:{tag:"button",disabled:e.submitting||e.$v.form.$invalid,"data-test":"updateChannelNameSubmit"},on:{click:e.submit}},[e._v("Save")])],1)],1)],2)},O=[],M=function(e){e&&e("data-v-6feba681_0",{source:".c-label-name[data-v-6feba681]{float:left}.c-max-count[data-v-6feba681]{float:right;color:var(--text_1)}.c-max-count.is-danger[data-v-6feba681]{color:var(--danger_0)}",map:void 0,media:void 0})},j="data-v-6feba681",D=void 0,G=!1;function U(e,r,n,o,i,d,a,m,l,c){let t=(typeof n=="function"?n.options:n)||{};t.__file=`style>
`,t.render||(t.render=e.render,t.staticRenderFns=e.staticRenderFns,t._compiled=!0,i&&(t.functional=!0)),t._scopeId=o;{let u;if(r&&(u=a?function(s){r.call(this,c(s,this.$root.$options.shadowRoot))}:function(s){r.call(this,m(s))}),u!==void 0)if(t.functional){let s=t.render;t.render=function(S,_){return u.call(_),s(S,_)}}else{let s=t.beforeCreate;t.beforeCreate=s?[].concat(s,u):[u]}}return t}function h(){let e=h.styles||(h.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(o,i){if(document.querySelector('style[data-vue-ssr-id~="'+o+'"]'))return;let d=r?i.media||"default":o,a=e[d]||(e[d]={ids:[],parts:[],element:void 0});if(!a.ids.includes(o)){let m=i.source,l=a.ids.length;if(a.ids.push(o),i.map&&(m+=`
/*# sourceURL=`+i.map.sources[0]+" */",m+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),r&&(a.element=a.element||document.querySelector("style[data-group="+d+"]")),!a.element){let c=document.head||document.getElementsByTagName("head")[0],t=a.element=document.createElement("style");t.type="text/css",i.media&&t.setAttribute("media",i.media),r&&(t.setAttribute("data-group",d),t.setAttribute("data-next-index","0")),c.appendChild(t)}if(r&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(m),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let c=document.createTextNode(m),t=a.element.childNodes;t[l]&&a.element.removeChild(t[l]),t.length?a.element.insertBefore(c,t[l]):a.element.appendChild(c)}}}}var k=U({render:E,staticRenderFns:O},M,T,j,G,D,!1,h,void 0,void 0),X=k;export{X as default};
//# sourceMappingURL=EditChannelNameModal-J2H4JMXH-cached.js.map
