import{a as ki,b as eo,c as no,d as Li}from"./chunk-UITB4T2U-cached.js";import{a as Wi}from"./chunk-GBFBB32L-cached.js";import{g as Oi}from"./chunk-O3LEEXWO-cached.js";import{a as Hi}from"./chunk-FMXZTXSJ-cached.js";import{a as nt,b as zi}from"./chunk-I2AIXHXH-cached.js";import{c as xi,d as Si}from"./chunk-GEXW5JDJ-cached.js";import{a as Zt,b as Bi}from"./chunk-4JOX3BCB-cached.js";import{a as tr,b as bi}from"./chunk-URDQIHOO-cached.js";import{a as xt,b as ec,c as tc,d as Jt,e as ge,f as li,g as ui,h as de,i as Te,j as wt,k as Qo,l as Zo,m as gi,o as ji}from"./chunk-5SBNFUND-cached.js";import{b as Jo,c as Xo,d as ti,e as ke,f as Yo,g as oi}from"./chunk-GTDX6B7Q-cached.js";import{a as rt}from"./chunk-OJPGIG5M-cached.js";import{d as vi}from"./chunk-OYX4NVDU-cached.js";import{a as Qt,c as _i,e as yi}from"./chunk-MMWHE4QG-cached.js";import{a as $i}from"./chunk-XK3SURHI-cached.js";import{b as yt,c as et,d as Vn,e as qn}from"./chunk-WP4ONFFS-cached.js";import{a as Gi}from"./chunk-L3DDQKT5-cached.js";import{a as Di}from"./chunk-K4AJNIFK-cached.js";import{a as Ui}from"./chunk-HHDZK5AY-cached.js";import"./chunk-VEV6LVHD-cached.js";import{a as wi,b as Ii}from"./chunk-FCHVKZ6M-cached.js";import{a as It,b as Fe,c as Ce,d as di,e as Xt,f as Yt,g as pi,h as mi,i as fi,l as hi}from"./chunk-WWKTCH3O-cached.js";import{b as Mi}from"./chunk-VNKQZXVF-cached.js";import{a as Zn}from"./chunk-6XMQ6J6P-cached.js";import{a as qt}from"./chunk-GKXQDYNU-cached.js";import{a as Kn}from"./chunk-NAVF63QR-cached.js";import{a as I,b as Za,c as Z}from"./chunk-AZT5ZK4I-cached.js";import"./chunk-VJZRITMK-cached.js";import{a as Ri}from"./chunk-IFUUWYFC-cached.js";import"./chunk-3NAXAUG3-cached.js";import{a as oo}from"./chunk-KRTYB7RO-cached.js";import{a as Ai}from"./chunk-P7FSS7WT-cached.js";import{a as ro}from"./chunk-TMYX4GL6-cached.js";import{a as Fi}from"./chunk-3IOIYPZC-cached.js";import{a as er,c as Ei,d as to}from"./chunk-Z73GTKES-cached.js";import{d as ci,e as Ge,f as oe}from"./chunk-4XLIKA67-cached.js";import{a as Ci}from"./chunk-WMVHT3GJ-cached.js";import"./chunk-XHZPFS4B-cached.js";import{a as Ti,b as Pi}from"./chunk-6P74MMKF-cached.js";import{a as Jn,b as Y,c as Xn,h as Yn,k as Qn,n as tt}from"./chunk-VUYUNB2W-cached.js";import"./chunk-B4L7IMS4-cached.js";import{O as si,P as ai,R as Kt,V as St,a as ot,b as ee,n as ri,p as ni,r as ii}from"./chunk-SZPI64OI-cached.js";import"./chunk-R4DRX7L2-cached.js";import"./chunk-FTWBMR5D-cached.js";import{a as io}from"./chunk-GA3LN23N-cached.js";import"./chunk-3VFZYJBQ-cached.js";import{a as Ni}from"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import{E as Me,F as De,J as vt,N as Fn,O as Wt,P as Un,Q as $n,R as jn,S as bt,T as Bn,U as zn,V as Hn,W as _t,X as Vt,Y as Wn,a as Qe,b as Pe,c as Ie,d as Ze,e as Tn,f as Ho,g as Cn,h as En,i as An,j as Nn,k as Wo,l as Ht,m as Rn,n as On,o as Ln,p as Pn,q as Mn,r as Dn,u as Gn,v as z,w as Vo,x as gt,y as qo}from"./chunk-TEH4GFTX-cached.js";import{a as Se,b,c as Ye,i as In,j as kn,k as we}from"./chunk-QVCKPSEU-cached.js";import{a as c}from"./chunk-OMOH7TRL-cached.js";import{a as Ko,b as re,c as ei,d as H}from"./chunk-WBBXU2FL-cached.js";import{c as zt,e as he,f as Qa}from"./chunk-XMZXE55N-cached.js";var es=zt((Kp,Zi)=>{Zi.exports=function(e){function t(r){if(o[r])return o[r].exports;var s=o[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var o={};return t.m=e,t.c=o,t.i=function(r){return r},t.d=function(r,s,a){t.o(r,s)||Object.defineProperty(r,s,{configurable:!1,enumerable:!0,get:a})},t.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(s,"a",s),s},t.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},t.p="/",t(t.s=5)}([function(e,t){function o(s,a){var n=s[1]||"",l=s[3];if(!l)return n;if(a&&typeof btoa=="function"){var m=r(l);return[n].concat(l.sources.map(function(p){return"/*# sourceURL="+l.sourceRoot+p+" */"})).concat([m]).join(`
`)}return[n].join(`
`)}function r(s){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"}e.exports=function(s){var a=[];return a.toString=function(){return this.map(function(n){var l=o(n,s);return n[2]?"@media "+n[2]+"{"+l+"}":l}).join("")},a.i=function(n,l){typeof n=="string"&&(n=[[null,n,""]]);for(var m={},p=0;p<this.length;p++){var i=this[p][0];typeof i=="number"&&(m[i]=!0)}for(p=0;p<n.length;p++){var u=n[p];typeof u[0]=="number"&&m[u[0]]||(l&&!u[2]?u[2]=l:l&&(u[2]="("+u[2]+") and ("+l+")"),a.push(u))}},a}},function(e,t){e.exports=function(o,r,s,a,n){var l,m=o=o||{},p=typeof o.default;p!=="object"&&p!=="function"||(l=o,m=o.default);var i=typeof m=="function"?m.options:m;r&&(i.render=r.render,i.staticRenderFns=r.staticRenderFns),a&&(i._scopeId=a);var u;if(n?(u=function(g){g=g||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,g||typeof __VUE_SSR_CONTEXT__>"u"||(g=__VUE_SSR_CONTEXT__),s&&s.call(this,g),g&&g._registeredComponents&&g._registeredComponents.add(n)},i._ssrRegister=u):s&&(u=s),u){var d=i.functional,h=d?i.render:i.beforeCreate;d?i.render=function(g,v){return u.call(v),h(g,v)}:i.beforeCreate=h?[].concat(h,u):[u]}return{esModule:l,exports:m,options:i}}},function(e,t,o){function r(y){for(var A=0;A<y.length;A++){var C=y[A],O=i[C.id];if(O){O.refs++;for(var N=0;N<O.parts.length;N++)O.parts[N](C.parts[N]);for(;N<C.parts.length;N++)O.parts.push(a(C.parts[N]));O.parts.length>C.parts.length&&(O.parts.length=C.parts.length)}else{for(var U=[],N=0;N<C.parts.length;N++)U.push(a(C.parts[N]));i[C.id]={id:C.id,refs:1,parts:U}}}}function s(){var y=document.createElement("style");return y.type="text/css",u.appendChild(y),y}function a(y){var A,C,O=document.querySelector('style[data-vue-ssr-id~="'+y.id+'"]');if(O){if(g)return v;O.parentNode.removeChild(O)}if(E){var N=h++;O=d||(d=s()),A=n.bind(null,O,N,!1),C=n.bind(null,O,N,!0)}else O=s(),A=l.bind(null,O),C=function(){O.parentNode.removeChild(O)};return A(y),function(U){if(U){if(U.css===y.css&&U.media===y.media&&U.sourceMap===y.sourceMap)return;A(y=U)}else C()}}function n(y,A,C,O){var N=C?"":O.css;if(y.styleSheet)y.styleSheet.cssText=L(A,N);else{var U=document.createTextNode(N),w=y.childNodes;w[A]&&y.removeChild(w[A]),w.length?y.insertBefore(U,w[A]):y.appendChild(U)}}function l(y,A){var C=A.css,O=A.media,N=A.sourceMap;if(O&&y.setAttribute("media",O),N&&(C+=`
/*# sourceURL=`+N.sources[0]+" */",C+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(N))))+" */"),y.styleSheet)y.styleSheet.cssText=C;else{for(;y.firstChild;)y.removeChild(y.firstChild);y.appendChild(document.createTextNode(C))}}var m=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!m)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var p=o(16),i={},u=m&&(document.head||document.getElementsByTagName("head")[0]),d=null,h=0,g=!1,v=function(){},E=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(y,A,C){g=C;var O=p(y,A);return r(O),function(N){for(var U=[],w=0;w<O.length;w++){var W=O[w],j=i[W.id];j.refs--,U.push(j)}N?(O=p(y,N),r(O)):O=[];for(var w=0;w<U.length;w++){var j=U[w];if(j.refs===0){for(var _e=0;_e<j.parts.length;_e++)j.parts[_e]();delete i[j.id]}}}};var L=function(){var y=[];return function(A,C){return y[A]=C,y.filter(Boolean).join(`
`)}}()},function(e,t,o){(function(r,s){e.exports=s()})(0,function(){return function(r){function s(n){if(a[n])return a[n].exports;var l=a[n]={exports:{},id:n,loaded:!1};return r[n].call(l.exports,l,l.exports,s),l.loaded=!0,l.exports}var a={};return s.m=r,s.c=a,s.p="",s(0)}([function(r,s){"use strict";function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var n=Object.assign||function(u){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(u[g]=h[g])}return u},l=function(){function u(d,h){for(var g=0;g<h.length;g++){var v=h[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(d,v.key,v)}}return function(d,h,g){return h&&u(d.prototype,h),g&&u(d,g),d}}(),m=function(u,d,h){d.forEach(function(g){u.addEventListener(g,function(v){h(v)})})},p=function(u,d){d.forEach(function(h){u.removeEventListener(h)})},i=function(){function u(d){a(this,u),this.defaults={idle:1e4,events:["mousemove","keydown","mousedown","touchstart"],onIdle:function(){},onActive:function(){},onHide:function(){},onShow:function(){},keepTracking:!0,startAtIdle:!1,recurIdleCall:!1},this.settings=n({},this.defaults,d),this.idle=this.settings.startAtIdle,this.visible=!this.settings.startAtIdle,this.visibilityEvents=["visibilitychange","webkitvisibilitychange","mozvisibilitychange","msvisibilitychange"],this.lastId=null}return l(u,[{key:"resetTimeout",value:function(d,h){if(this.idle&&(h.onActive.call(),this.idle=!1),clearTimeout(d),this.settings.keepTracking)return this.timeout(this.settings)}},{key:"timeout",value:function(d){var h=this.settings.recurIdleCall?setInterval:setTimeout;return h(function(){this.idle=!0,this.settings.onIdle.call()}.bind(this),this.settings.idle)}},{key:"start",value:function(){window.addEventListener("idle:stop",function(d){p(window,this.settings.events),this.settings.keepTracking=!1,this.resetTimeout(this.lastId,this.settings)}),this.lastId=this.timeout(this.settings),m(window,this.settings.events,function(d){this.lastId=this.resetTimeout(this.lastId,this.settings)}.bind(this)),(this.settings.onShow||this.settings.onHide)&&m(document,this.visibilityEvents,function(d){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?this.visible&&(this.visible=!1,this.settings.onHide.call()):this.visible||(this.visible=!0,this.settings.onShow.call())}.bind(this))}}]),u}();r.exports=i}])})},function(e,t,o){function r(a){o(15)}var s=o(1)(o(6),o(13),r,null,null);e.exports=s.exports},function(e,t,o){"use strict";function r(p){return p&&p.__esModule?p:{default:p}}function s(p,i,u){return i in p?Object.defineProperty(p,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):p[i]=u,p}Object.defineProperty(t,"__esModule",{value:!0});var a=o(3),n=r(a),l=o(4),m=r(l);t.default={IdleView:m.default,install:function(p,i){var u=i||{},d=u.eventEmitter,h=u.store,g=u.moduleName,v=g===void 0?"idleVue":g,E=u.idleTime,L=E===void 0?6e4:E,y=u.events,A=y===void 0?["mousemove","keydown","mousedown","touchstart"]:y,C=u.keepTracking,O=C===void 0||C,N=u.startAtIdle,U=N===void 0||N;if(!d&&!h)throw Error("Either `eventEmitter` or `store` must be passed in options");h&&h.registerModule(v,{state:{isIdle:U},mutations:s({},v+"/IDLE_CHANGED",function(j,_e){j.isIdle=_e})});var w=v+"_onIdle",W=v+"_onActive";new n.default({idle:L,events:A,keepTracking:O,startAtIdle:U,onIdle:function(){d&&d.$emit(w),h&&h.commit(v+"/IDLE_CHANGED",!0)},onActive:function(){d&&d.$emit(W),h&&h.commit(v+"/IDLE_CHANGED",!1)}}).start(),p.component("IdleView",m.default),p.mixin({data:function(){var j;return j={},s(j,w,null),s(j,W,null),j},created:function(){d&&this.$options.onIdle&&(this[w]=this.$options.onIdle.bind(this),d.$on(w,this[w])),d&&this.$options.onActive&&(this[W]=this.$options.onActive.bind(this),d.$on(W,this[W]))},destroyed:function(){d&&this[w]&&d.$off(w,this[w]),d&&this[W]&&d.$off(W,this[W])},computed:{isAppIdle:function(){return h&&h.state[v].isIdle}}})}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(11),s=function(a){return a&&a.__esModule?a:{default:a}}(r);t.default={components:{Sprite:s.default},onIdle:function(){this.$refs.sprite.play()},onActive:function(){this.$refs.sprite.stop()}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"sprite",props:{spriteSrc:{type:String,default:""},spriteId:{type:String,default:"sprite"},spriteW:{type:Number,default:1},spriteH:{type:Number,default:1},spriteSpeed:{type:Number,default:1}},data:function(){return{visible:!0,frameIndex:0,tickCount:0,frameLength:0,ticksPerFrame:0,numberOfFrames:0,frameRate:20,ctx:"",canvas:"",mySprite:"",animationFrameId:-1}},mounted:function(){var r=this;this.$nextTick(function(){r.mySprite=new Image,r.mySprite.onload=function(s){r.spriteInit(s.target)},r.mySprite.src=r.spriteSrc})},methods:{spriteInit:function(r){this.canvas=this.$el.querySelector("#"+this.spriteId),this.ctx=this.canvas.getContext("2d"),this.ticksPerFrame=this.spriteSpeed,this.frameLength=r.width,this.numberOfFrames=r.width/this.spriteW,this.spriteLoop()},spriteUpdate:function(){++this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.numberOfFrames-1?this.frameIndex++:this.frameIndex=0)},spriteRender:function(){this.ctx.clearRect(0,0,this.spriteW,this.spriteH);var r=this.frameIndex*this.spriteW;this.ctx.drawImage(this.mySprite,r,0,this.spriteW,this.spriteH,0,0,this.spriteW,this.spriteH)},spriteLoop:function(){this.animationFrameId=window.requestAnimationFrame(this.spriteLoop),this.spriteUpdate(),this.spriteRender()},stop:function(){window.cancelAnimationFrame(this.animationFrameId)},play:function(){this.spriteLoop()}}}},function(e,t,o){t=e.exports=o(0)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Sprite.vue",sourceRoot:""}])},function(e,t,o){t=e.exports=o(0)(!0),t.push([e.i,".idle-view{position:fixed;top:0;width:100vw;height:100vh;z-index:8888;pointer-events:none;display:none}.idle-view.isIdle{pointer-events:all;display:block}.idle-view .sprite{position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);height:10px;width:180px;z-index:9999;-webkit-transform:scale(.7)}.idle-view .overlay{width:100%;height:100%;position:absolute;z-index:8888;background:#000;opacity:0;-webkit-transition:opacity .8s cubic-bezier(.77,0,.175,1)}.idle-view.isIdle .overlay{opacity:.6}@-webkit-keyframes SlowMo{0%{background-position:0 50%}50%{background-position:100% 50%}to{background-position:0 50%}}","",{version:3,sources:["/home/afonso/Dev/idle-vue/src/components/Idle.vue"],names:[],mappings:"AACA,WACE,eAAgB,AAChB,MAAO,AACP,YAAa,AACb,aAAc,AACd,aAAc,AAEd,oBAAqB,AACrB,YAAc,CACf,AACD,kBACE,mBAAoB,AACpB,aAAe,CAChB,AACD,mBACE,kBAAmB,AACnB,QAAS,AACT,SAAU,AACV,4CAA6C,AAE7C,YAAa,AACb,YAAa,AACb,aAAc,AACd,2BAA8B,CAC/B,AACD,oBACE,WAAY,AACZ,YAAa,AACb,kBAAmB,AACnB,aAAc,AAEd,gBAAiB,AACjB,UAAW,AAEX,yDAAkE,CACnE,AACD,2BACE,UAAa,CACd,AACD,0BACA,GAAG,yBAA0B,CAC5B,AACD,IAAI,4BAA4B,CAC/B,AACD,GAAK,yBAA0B,CAC9B,CACA",file:"Idle.vue",sourcesContent:[`
.idle-view {
  position: fixed;
  top: 0;
  width: 100vw;
  height: 100vh;
  z-index: 8888;

  pointer-events: none;
  display: none;
}
.idle-view.isIdle {
  pointer-events: all;
  display: block;
}
.idle-view .sprite {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translateX(-50%) translateY(-50%);

  height: 10px;
  width: 180px;
  z-index: 9999;
  -webkit-transform: scale(0.7);
}
.idle-view .overlay {
  width: 100%;
  height: 100%;
  position: absolute;
  z-index: 8888;

  background: #000;
  opacity: 0;
  /*-webkit-animation: SlowMo 5s cubic-bezier(0.77, 0, 0.175, 1) infinite;*/
  -webkit-transition: opacity 800ms cubic-bezier(0.77, 0, 0.175, 1);
}
.idle-view.isIdle .overlay {
  opacity: 0.6;
}
@-webkit-keyframes SlowMo {
0%{background-position:0% 50%
}
50%{background-position:100% 50%
}
100%{background-position:0% 50%
}
}
`],sourceRoot:""}])},function(e,t,o){e.exports=o.p+"static/img/touch.ba3be66.png"},function(e,t,o){function r(a){o(14)}var s=o(1)(o(7),o(12),r,null,null);e.exports=s.exports},function(e,t){e.exports={render:function(){var o=this,r=o.$createElement,s=o._self._c||r;return s("div",{staticClass:"sprite"},[s("canvas",{attrs:{id:o.spriteId,width:o.spriteW,height:o.spriteH}})])},staticRenderFns:[]}},function(e,t,o){e.exports={render:function(){var r=this,s=r.$createElement,a=r._self._c||s;return a("div",{staticClass:"idle-view",class:{isIdle:r.isIdle}},[a("div",{staticClass:"overlay"}),r._v(" "),a("sprite",{ref:"sprite",attrs:{spriteId:"touch",spriteSrc:o(10),spriteW:180,spriteH:215}})],1)},staticRenderFns:[]}},function(e,t,o){var r=o(8);typeof r=="string"&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),o(2)("b6696284",r,!0)},function(e,t,o){var r=o(9);typeof r=="string"&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),o(2)("25b5ba8a",r,!0)},function(e,t){e.exports=function(o,r){for(var s=[],a={},n=0;n<r.length;n++){var l=r[n],m=l[0],p=l[1],i=l[2],u=l[3],d={id:o+":"+n,css:p,media:i,sourceMap:u};a[m]?a[m].parts.push(d):s.push(a[m]={id:m,parts:[d]})}return s}}])});var ea=zt((xv,Fr)=>{(function(){function e(p){for(var i=0;i<l.length;i++)l[i]=0;for(var i=0;i<p.length;i++)l[i%4]=(l[i%4]<<5)-l[i%4]+p.charCodeAt(i)}function t(){var p=l[0]^l[0]<<11;return l[0]=l[1],l[1]=l[2],l[2]=l[3],l[3]=l[3]^l[3]>>19^p^p>>8,(l[3]>>>0)/(1<<31>>>0)}function o(){var p=Math.floor(360*t()),i=60*t()+40+"%",u=25*(t()+t()+t()+t())+"%",d="hsl("+p+","+i+","+u+")";return d}function r(p){for(var i=p,u=p,d=Math.ceil(i/2),h=i-d,g=[],v=0;u>v;v++){for(var E=[],L=0;d>L;L++)E[L]=Math.floor(2.3*t());var y=E.slice(0,h);y.reverse(),E=E.concat(y);for(var A=0;A<E.length;A++)g.push(E[A])}return g}function s(p){var i={};return i.seed=p.seed||Math.floor(Math.random()*Math.pow(10,16)).toString(16),e(i.seed),i.size=p.size||8,i.scale=p.scale||4,i.color=p.color||o(),i.bgcolor=p.bgcolor||o(),i.spotcolor=p.spotcolor||o(),i}function a(p,i){var u=r(p.size),d=Math.sqrt(u.length);i.width=i.height=p.size*p.scale;var h=i.getContext("2d");h.fillStyle=p.bgcolor,h.fillRect(0,0,i.width,i.height),h.fillStyle=p.color;for(var g=0;g<u.length;g++)if(u[g]){var v=Math.floor(g/d),E=g%d;h.fillStyle=u[g]==1?p.color:p.spotcolor,h.fillRect(E*p.scale,v*p.scale,p.scale,p.scale)}return i}function n(i){var i=s(i||{}),u=document.createElement("canvas");return a(i,u),u}var l=new Array(4),m={create:n,render:a};typeof Fr<"u"&&(Fr.exports=m)})()});var Br=zt(($r,jr)=>{(function(e,t){typeof $r=="object"&&typeof jr<"u"?jr.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.DOMPurify=t())})($r,function(){"use strict";function e(x){if(Array.isArray(x)){for(var S=0,R=Array(x.length);S<x.length;S++)R[S]=x[S];return R}else return Array.from(x)}var t=Object.hasOwnProperty,o=Object.setPrototypeOf,r=Object.isFrozen,s=Object.getPrototypeOf,a=Object.getOwnPropertyDescriptor,n=Object.freeze,l=Object.seal,m=Object.create,p=typeof Reflect<"u"&&Reflect,i=p.apply,u=p.construct;i||(i=function(S,R,P){return S.apply(R,P)}),n||(n=function(S){return S}),l||(l=function(S){return S}),u||(u=function(S,R){return new(Function.prototype.bind.apply(S,[null].concat(e(R))))});var d=N(Array.prototype.forEach),h=N(Array.prototype.pop),g=N(Array.prototype.push),v=N(String.prototype.toLowerCase),E=N(String.prototype.match),L=N(String.prototype.replace),y=N(String.prototype.indexOf),A=N(String.prototype.trim),C=N(RegExp.prototype.test),O=U(TypeError);function N(x){return function(S){for(var R=arguments.length,P=Array(R>1?R-1:0),q=1;q<R;q++)P[q-1]=arguments[q];return i(x,S,P)}}function U(x){return function(){for(var S=arguments.length,R=Array(S),P=0;P<S;P++)R[P]=arguments[P];return u(x,R)}}function w(x,S){o&&o(x,null);for(var R=S.length;R--;){var P=S[R];if(typeof P=="string"){var q=v(P);q!==P&&(r(S)||(S[R]=q),P=q)}x[P]=!0}return x}function W(x){var S=m(null),R=void 0;for(R in x)i(t,x,[R])&&(S[R]=x[R]);return S}function j(x,S){for(;x!==null;){var R=a(x,S);if(R){if(R.get)return N(R.get);if(typeof R.value=="function")return N(R.value)}x=s(x)}function P(q){return console.warn("fallback value for",q),null}return P}var _e=n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Io=n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ko=n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_a=n(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),To=n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ya=n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Xr=n(["#text"]),Yr=n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),Co=n(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qr=n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Lt=n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xa=l(/\{\{[\s\S]*|[\s\S]*\}\}/gm),Sa=l(/<%[\s\S]*|[\s\S]*%>/gm),wa=l(/^data-[\-\w.\u00B7-\uFFFF]/),Ia=l(/^aria-[\-\w]+$/),ka=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ta=l(/^(?:\w+script|data):/i),Ca=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x};function ce(x){if(Array.isArray(x)){for(var S=0,R=Array(x.length);S<x.length;S++)R[S]=x[S];return R}else return Array.from(x)}var Ea=function(){return typeof window>"u"?null:window},Aa=function(S,R){if((typeof S>"u"?"undefined":dt(S))!=="object"||typeof S.createPolicy!="function")return null;var P=null,q="data-tt-policy-suffix";R.currentScript&&R.currentScript.hasAttribute(q)&&(P=R.currentScript.getAttribute(q));var Pt="dompurify"+(P?"#"+P:"");try{return S.createPolicy(Pt,{createHTML:function(Mt){return Mt}})}catch{return console.warn("TrustedTypes policy "+Pt+" could not be created."),null}};function Zr(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ea(),S=function(f){return Zr(f)};if(S.version="2.2.7",S.removed=[],!x||!x.document||x.document.nodeType!==9)return S.isSupported=!1,S;var R=x.document,P=x.document,q=x.DocumentFragment,Pt=x.HTMLTemplateElement,Ve=x.Node,Mt=x.Element,Dt=x.NodeFilter,en=x.NamedNodeMap,Ra=en===void 0?x.NamedNodeMap||x.MozNamedAttrMap:en,Oa=x.Text,La=x.Comment,Pa=x.DOMParser,Ma=x.trustedTypes,Gt=Mt.prototype,Da=j(Gt,"cloneNode"),Ga=j(Gt,"nextSibling"),Fa=j(Gt,"childNodes"),Eo=j(Gt,"parentNode");if(typeof Pt=="function"){var Ao=P.createElement("template");Ao.content&&Ao.content.ownerDocument&&(P=Ao.content.ownerDocument)}var ye=Aa(Ma,R),tn=ye&&$t?ye.createHTML(""):"",Ft=P,No=Ft.implementation,Ua=Ft.createNodeIterator,$a=Ft.getElementsByTagName,ja=Ft.createDocumentFragment,Ba=R.importNode,on={};try{on=W(P).documentMode?P.documentMode:{}}catch{}var le={};S.isSupported=typeof Eo=="function"&&No&&typeof No.createHTMLDocument<"u"&&on!==9;var Ro=xa,Oo=Sa,za=wa,Ha=Ia,Wa=Ta,rn=Ca,Lo=ka,K=null,nn=w({},[].concat(ce(_e),ce(Io),ce(ko),ce(To),ce(Xr))),J=null,sn=w({},[].concat(ce(Yr),ce(Co),ce(Qr),ce(Lt))),Po=null,an=null,cn=!0,Mo=!0,ln=!1,qe=!1,pt=!1,Do=!1,Go=!1,Ke=!1,Ut=!1,un=!0,$t=!1,dn=!0,Fo=!0,mt=!1,Je={},Va=w({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),pn=null,mn=w({},["audio","video","img","source","image","track"]),Uo=null,fn=w({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Xe=null,qa=P.createElement("form"),$o=function(f){Xe&&Xe===f||((!f||(typeof f>"u"?"undefined":dt(f))!=="object")&&(f={}),f=W(f),K="ALLOWED_TAGS"in f?w({},f.ALLOWED_TAGS):nn,J="ALLOWED_ATTR"in f?w({},f.ALLOWED_ATTR):sn,Uo="ADD_URI_SAFE_ATTR"in f?w(W(fn),f.ADD_URI_SAFE_ATTR):fn,pn="ADD_DATA_URI_TAGS"in f?w(W(mn),f.ADD_DATA_URI_TAGS):mn,Po="FORBID_TAGS"in f?w({},f.FORBID_TAGS):{},an="FORBID_ATTR"in f?w({},f.FORBID_ATTR):{},Je="USE_PROFILES"in f?f.USE_PROFILES:!1,cn=f.ALLOW_ARIA_ATTR!==!1,Mo=f.ALLOW_DATA_ATTR!==!1,ln=f.ALLOW_UNKNOWN_PROTOCOLS||!1,qe=f.SAFE_FOR_TEMPLATES||!1,pt=f.WHOLE_DOCUMENT||!1,Ke=f.RETURN_DOM||!1,Ut=f.RETURN_DOM_FRAGMENT||!1,un=f.RETURN_DOM_IMPORT!==!1,$t=f.RETURN_TRUSTED_TYPE||!1,Go=f.FORCE_BODY||!1,dn=f.SANITIZE_DOM!==!1,Fo=f.KEEP_CONTENT!==!1,mt=f.IN_PLACE||!1,Lo=f.ALLOWED_URI_REGEXP||Lo,qe&&(Mo=!1),Ut&&(Ke=!0),Je&&(K=w({},[].concat(ce(Xr))),J=[],Je.html===!0&&(w(K,_e),w(J,Yr)),Je.svg===!0&&(w(K,Io),w(J,Co),w(J,Lt)),Je.svgFilters===!0&&(w(K,ko),w(J,Co),w(J,Lt)),Je.mathMl===!0&&(w(K,To),w(J,Qr),w(J,Lt))),f.ADD_TAGS&&(K===nn&&(K=W(K)),w(K,f.ADD_TAGS)),f.ADD_ATTR&&(J===sn&&(J=W(J)),w(J,f.ADD_ATTR)),f.ADD_URI_SAFE_ATTR&&w(Uo,f.ADD_URI_SAFE_ATTR),Fo&&(K["#text"]=!0),pt&&w(K,["html","head","body"]),K.table&&(w(K,["tbody"]),delete Po.tbody),n&&n(f),Xe=f)},hn=w({},["mi","mo","mn","ms","mtext"]),gn=w({},["foreignobject","desc","title","annotation-xml"]),jt=w({},Io);w(jt,ko),w(jt,_a);var jo=w({},To);w(jo,ya);var Bo="http://www.w3.org/1998/Math/MathML",zo="http://www.w3.org/2000/svg",Bt="http://www.w3.org/1999/xhtml",Ka=function(f){var _=Eo(f);(!_||!_.tagName)&&(_={namespaceURI:Bt,tagName:"template"});var k=v(f.tagName),M=v(_.tagName);if(f.namespaceURI===zo)return _.namespaceURI===Bt?k==="svg":_.namespaceURI===Bo?k==="svg"&&(M==="annotation-xml"||hn[M]):!!jt[k];if(f.namespaceURI===Bo)return _.namespaceURI===Bt?k==="math":_.namespaceURI===zo?k==="math"&&gn[M]:!!jo[k];if(f.namespaceURI===Bt){if(_.namespaceURI===zo&&!gn[M]||_.namespaceURI===Bo&&!hn[M])return!1;var X=w({},["title","style","font","a","script"]);return!jo[k]&&(X[k]||!jt[k])}return!1},xe=function(f){g(S.removed,{element:f});try{f.parentNode.removeChild(f)}catch{try{f.outerHTML=tn}catch{f.remove()}}},vn=function(f,_){try{g(S.removed,{attribute:_.getAttributeNode(f),from:_})}catch{g(S.removed,{attribute:null,from:_})}if(_.removeAttribute(f),f==="is"&&!J[f])if(Ke||Ut)try{xe(_)}catch{}else try{_.setAttribute(f,"")}catch{}},bn=function(f){var _=void 0,k=void 0;if(Go)f="<remove></remove>"+f;else{var M=E(f,/^[\r\n\t ]+/);k=M&&M[0]}var X=ye?ye.createHTML(f):f;try{_=new Pa().parseFromString(X,"text/html")}catch{}if(!_||!_.documentElement){_=No.createHTMLDocument("");var Q=_,B=Q.body;B.parentNode.removeChild(B.parentNode.firstElementChild),B.outerHTML=X}return f&&k&&_.body.insertBefore(P.createTextNode(k),_.body.childNodes[0]||null),$a.call(_,pt?"html":"body")[0]},_n=function(f){return Ua.call(f.ownerDocument||f,f,Dt.SHOW_ELEMENT|Dt.SHOW_COMMENT|Dt.SHOW_TEXT,function(){return Dt.FILTER_ACCEPT},!1)},Ja=function(f){return f instanceof Oa||f instanceof La?!1:typeof f.nodeName!="string"||typeof f.textContent!="string"||typeof f.removeChild!="function"||!(f.attributes instanceof Ra)||typeof f.removeAttribute!="function"||typeof f.setAttribute!="function"||typeof f.namespaceURI!="string"||typeof f.insertBefore!="function"},ft=function(f){return(typeof Ve>"u"?"undefined":dt(Ve))==="object"?f instanceof Ve:f&&(typeof f>"u"?"undefined":dt(f))==="object"&&typeof f.nodeType=="number"&&typeof f.nodeName=="string"},fe=function(f,_,k){le[f]&&d(le[f],function(M){M.call(S,_,k,Xe)})},yn=function(f){var _=void 0;if(fe("beforeSanitizeElements",f,null),Ja(f)||E(f.nodeName,/[\u0080-\uFFFF]/))return xe(f),!0;var k=v(f.nodeName);if(fe("uponSanitizeElement",f,{tagName:k,allowedTags:K}),!ft(f.firstElementChild)&&(!ft(f.content)||!ft(f.content.firstElementChild))&&C(/<[/\w]/g,f.innerHTML)&&C(/<[/\w]/g,f.textContent))return xe(f),!0;if(!K[k]||Po[k]){if(Fo&&!Va[k]){var M=Eo(f),X=Fa(f);if(X&&M)for(var Q=X.length,B=Q-1;B>=0;--B)M.insertBefore(Da(X[B],!0),Ga(f))}return xe(f),!0}return f instanceof Mt&&!Ka(f)||(k==="noscript"||k==="noembed")&&C(/<\/no(script|embed)/i,f.innerHTML)?(xe(f),!0):(qe&&f.nodeType===3&&(_=f.textContent,_=L(_,Ro," "),_=L(_,Oo," "),f.textContent!==_&&(g(S.removed,{element:f.cloneNode()}),f.textContent=_)),fe("afterSanitizeElements",f,null),!1)},xn=function(f,_,k){if(dn&&(_==="id"||_==="name")&&(k in P||k in qa))return!1;if(!(Mo&&C(za,_))){if(!(cn&&C(Ha,_))){if(!J[_]||an[_])return!1;if(!Uo[_]){if(!C(Lo,L(k,rn,""))){if(!((_==="src"||_==="xlink:href"||_==="href")&&f!=="script"&&y(k,"data:")===0&&pn[f])){if(!(ln&&!C(Wa,L(k,rn,"")))){if(k)return!1}}}}}}return!0},Sn=function(f){var _=void 0,k=void 0,M=void 0,X=void 0;fe("beforeSanitizeAttributes",f,null);var Q=f.attributes;if(Q){var B={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J};for(X=Q.length;X--;){_=Q[X];var ue=_,ht=ue.name,wn=ue.namespaceURI;if(k=A(_.value),M=v(ht),B.attrName=M,B.attrValue=k,B.keepAttr=!0,B.forceKeepAttr=void 0,fe("uponSanitizeAttribute",f,B),k=B.attrValue,!B.forceKeepAttr&&(vn(ht,f),!!B.keepAttr)){if(C(/\/>/i,k)){vn(ht,f);continue}qe&&(k=L(k,Ro," "),k=L(k,Oo," "));var Ya=f.nodeName.toLowerCase();if(xn(Ya,M,k))try{wn?f.setAttributeNS(wn,ht,k):f.setAttribute(ht,k),h(S.removed)}catch{}}}fe("afterSanitizeAttributes",f,null)}},Xa=function T(f){var _=void 0,k=_n(f);for(fe("beforeSanitizeShadowDOM",f,null);_=k.nextNode();)fe("uponSanitizeShadowNode",_,null),!yn(_)&&(_.content instanceof q&&T(_.content),Sn(_));fe("afterSanitizeShadowDOM",f,null)};return S.sanitize=function(T,f){var _=void 0,k=void 0,M=void 0,X=void 0,Q=void 0;if(T||(T="<!-->"),typeof T!="string"&&!ft(T)){if(typeof T.toString!="function")throw O("toString is not a function");if(T=T.toString(),typeof T!="string")throw O("dirty is not a string, aborting")}if(!S.isSupported){if(dt(x.toStaticHTML)==="object"||typeof x.toStaticHTML=="function"){if(typeof T=="string")return x.toStaticHTML(T);if(ft(T))return x.toStaticHTML(T.outerHTML)}return T}if(Do||$o(f),S.removed=[],typeof T=="string"&&(mt=!1),!mt)if(T instanceof Ve)_=bn("<!---->"),k=_.ownerDocument.importNode(T,!0),k.nodeType===1&&k.nodeName==="BODY"||k.nodeName==="HTML"?_=k:_.appendChild(k);else{if(!Ke&&!qe&&!pt&&T.indexOf("<")===-1)return ye&&$t?ye.createHTML(T):T;if(_=bn(T),!_)return Ke?null:tn}_&&Go&&xe(_.firstChild);for(var B=_n(mt?T:_);M=B.nextNode();)M.nodeType===3&&M===X||yn(M)||(M.content instanceof q&&Xa(M.content),Sn(M),X=M);if(X=null,mt)return T;if(Ke){if(Ut)for(Q=ja.call(_.ownerDocument);_.firstChild;)Q.appendChild(_.firstChild);else Q=_;return un&&(Q=Ba.call(R,Q,!0)),Q}var ue=pt?_.outerHTML:_.innerHTML;return qe&&(ue=L(ue,Ro," "),ue=L(ue,Oo," ")),ye&&$t?ye.createHTML(ue):ue},S.setConfig=function(T){$o(T),Do=!0},S.clearConfig=function(){Xe=null,Do=!1},S.isValidAttribute=function(T,f,_){Xe||$o({});var k=v(T),M=v(f);return xn(k,M,_)},S.addHook=function(T,f){typeof f=="function"&&(le[T]=le[T]||[],g(le[T],f))},S.removeHook=function(T){le[T]&&h(le[T])},S.removeHooks=function(T){le[T]&&(le[T]=[])},S.removeAllHooks=function(){le={}},S}var Na=Zr();return Na})});var ga=zt(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});function rp(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Ot=rp((Z(),Qa(Za)));function wo(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wo=function(t){return typeof t}:wo=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(e)}function np(e){return ip(e)||sp(e)||ap()}function ip(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}function sp(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function ap(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var So=typeof window<"u";function cp(e){return Array.isArray(e)||wo(e)==="object"?Object.freeze(e):e}function lp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.reduce(function(o,r){var s=r.passengers[0],a=typeof s=="function"?s(t):r.passengers;return o.concat(a)},[])}function up(e,t){return e.map(function(o,r){return[r,o]}).sort(function(o,r){return t(o[1],r[1])||o[0]-r[0]}).map(function(o){return o[1]})}function ma(e,t){return t.reduce(function(o,r){return e.hasOwnProperty(r)&&(o[r]=e[r]),o},{})}var fa={},dp={},pp={},mp=Ot.extend({data:function(){return{transports:fa,targets:dp,sources:pp,trackInstances:So}},methods:{open:function(t){if(So){var o=t.to,r=t.from,s=t.passengers,a=t.order,n=a===void 0?1/0:a;if(!(!o||!r||!s)){var l={to:o,from:r,passengers:cp(s),order:n},m=Object.keys(this.transports);m.indexOf(o)===-1&&Ot.set(this.transports,o,[]);var p=this.$_getTransportIndex(l),i=this.transports[o].slice(0);p===-1?i.push(l):i[p]=l,this.transports[o]=up(i,function(u,d){return u.order-d.order})}}},close:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=t.to,s=t.from;if(!(!r||!s&&o===!1)&&this.transports[r])if(o)this.transports[r]=[];else{var a=this.$_getTransportIndex(t);if(a>=0){var n=this.transports[r].slice(0);n.splice(a,1),this.transports[r]=n}}},registerTarget:function(t,o,r){So&&(this.trackInstances&&!r&&this.targets[t]&&console.warn("[portal-vue]: Target ".concat(t," already exists")),this.$set(this.targets,t,Object.freeze([o])))},unregisterTarget:function(t){this.$delete(this.targets,t)},registerSource:function(t,o,r){So&&(this.trackInstances&&!r&&this.sources[t]&&console.warn("[portal-vue]: source ".concat(t," already exists")),this.$set(this.sources,t,Object.freeze([o])))},unregisterSource:function(t){this.$delete(this.sources,t)},hasTarget:function(t){return!!(this.targets[t]&&this.targets[t][0])},hasSource:function(t){return!!(this.sources[t]&&this.sources[t][0])},hasContentFor:function(t){return!!this.transports[t]&&!!this.transports[t].length},$_getTransportIndex:function(t){var o=t.to,r=t.from;for(var s in this.transports[o])if(this.transports[o][s].from===r)return+s;return-1}}}),ie=new mp(fa),fp=1,Kr=Ot.extend({name:"portal",props:{disabled:{type:Boolean},name:{type:String,default:function(){return String(fp++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}}},created:function(){var t=this;this.$nextTick(function(){ie.registerSource(t.name,t)})},mounted:function(){this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){ie.unregisterSource(this.name),this.clear()},watch:{to:function(t,o){o&&o!==t&&this.clear(o),this.sendUpdate()}},methods:{clear:function(t){var o={from:this.name,to:t||this.to};ie.close(o)},normalizeSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},normalizeOwnChildren:function(t){return typeof t=="function"?t(this.slotProps):t},sendUpdate:function(){var t=this.normalizeSlots();if(t){var o={from:this.name,to:this.to,passengers:np(t),order:this.order};ie.open(o)}else this.clear()}},render:function(t){var o=this.$slots.default||this.$scopedSlots.default||[],r=this.tag;return o&&this.disabled?o.length<=1&&this.slim?this.normalizeOwnChildren(o)[0]:t(r,[this.normalizeOwnChildren(o)]):this.slim?t():t(r,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}}),Jr=Ot.extend({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},data:function(){return{transports:ie.transports,firstRender:!0}},created:function(){var t=this;this.$nextTick(function(){ie.registerTarget(t.name,t)})},watch:{ownTransports:function(){this.$emit("change",this.children().length>0)},name:function(t,o){ie.unregisterTarget(o),ie.registerTarget(t,this)}},mounted:function(){var t=this;this.transition&&this.$nextTick(function(){t.firstRender=!1})},beforeDestroy:function(){ie.unregisterTarget(this.name)},computed:{ownTransports:function(){var t=this.transports[this.name]||[];return this.multiple?t:t.length===0?[]:[t[t.length-1]]},passengers:function(){return lp(this.ownTransports,this.slotProps)}},methods:{children:function(){return this.passengers.length!==0?this.passengers:this.$scopedSlots.default?this.$scopedSlots.default(this.slotProps):this.$slots.default||[]},noWrapper:function(){var t=this.slim&&!this.transition;return t&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),t}},render:function(t){var o=this.noWrapper(),r=this.children(),s=this.transition||this.tag;return o?r[0]:this.slim&&!s?t():t(s,{props:{tag:this.transition&&this.tag?this.tag:void 0},class:{"vue-portal-target":!0}},r)}}),hp=0,gp=["disabled","name","order","slim","slotProps","tag","to"],vp=["multiple","transition"],ha=Ot.extend({name:"MountingPortal",inheritAttrs:!1,props:{append:{type:[Boolean,String]},bail:{type:Boolean},mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:function(){return"mounted_"+String(hp++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}},multiple:{type:Boolean,default:!1},targetSlim:{type:Boolean},targetSlotProps:{type:Object,default:function(){return{}}},targetTag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},created:function(){if(!(typeof document>"u")){var t=document.querySelector(this.mountTo);if(!t){console.error("[portal-vue]: Mount Point '".concat(this.mountTo,"' not found in document"));return}var o=this.$props;if(ie.targets[o.name]){o.bail?console.warn("[portal-vue]: Target ".concat(o.name,` is already mounted.
        Aborting because 'bail: true' is set`)):this.portalTarget=ie.targets[o.name];return}var r=o.append;if(r){var s=typeof r=="string"?r:"DIV",a=document.createElement(s);t.appendChild(a),t=a}var n=ma(this.$props,vp);n.slim=this.targetSlim,n.tag=this.targetTag,n.slotProps=this.targetSlotProps,n.name=this.to,this.portalTarget=new Jr({el:t,parent:this.$parent||this,propsData:n})}},beforeDestroy:function(){var t=this.portalTarget;if(this.append){var o=t.$el;o.parentNode.removeChild(o)}t.$destroy()},render:function(t){if(!this.portalTarget)return console.warn("[portal-vue] Target wasn't mounted"),t();if(!this.$scopedSlots.manual){var o=ma(this.$props,gp);return t(Kr,{props:o,attrs:this.$attrs,on:this.$listeners,scopedSlots:this.$scopedSlots},this.$slots.default)}var r=this.$scopedSlots.manual({to:this.to});return Array.isArray(r)&&(r=r[0]),r||t()}});function bp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.component(t.portalName||"Portal",Kr),e.component(t.portalTargetName||"PortalTarget",Jr),e.component(t.MountingPortalName||"MountingPortal",ha)}var _p={install:bp};We.default=_p;We.Portal=Kr;We.PortalTarget=Jr;We.MountingPortal=ha;We.Wormhole=ie});var kt=class{#e;#r=0;#n="";#o=!1;#t=0;constructor(t,o=""){this.#e=new Array(t).fill(o),this.#r=t,this.#n=o}add(t){let o=this.#r,r=this.#t;this.#e[r]=t,r===o-1&&(this.#o=!0),this.#t=(r+1)%o}addAll(t){for(let o of t)this.add(o)}clear(){this.#e.fill(this.#n),this.#o=!1,this.#t=0}toArray(){let t=this.#e,o=this.#t;return this.#o?[...t.slice(o),...t.slice(0,o)]:t.slice(0,o)}};var Vi=["debug","error","info","log","warn"],or=console,oc=(...e)=>{};async function qi(e,{getItem:t,removeItem:o,setItem:r}){let s=new kt(e.maxEntries),a=Object.fromEntries(Vi.map(i=>[i,(...u)=>{or[i](...u),rc(m,i,e.source,...u)}])),n=[],l=new Proxy({...a},{get(i,u,d){return Reflect.has(i,u)?Reflect.get(i,u,d):Reflect.get(or,u,d)},has(i,u){return Reflect.has(or,u)}}),m={get appLogsFilter(){return[...n]},console:l,entries:s,async clear(){await o("entries"),s.clear()},async save(){try{await r("entries",this.entries.toArray())}catch(i){l.error(i)}},setAppLogsFilter(i){n.splice(0,n.length,...i);for(let u of Vi)l[u]=n.includes(u)?a[u]:oc}},p=await(async()=>{try{let i=await t("entries");return i?JSON.parse(i):[]}catch(i){return l.error("Failed to parse stored entries:",i),[]}})();return e.maxEntries<p.length&&p.splice(0,p.length-e.maxEntries),p.length&&m.entries.addAll(p),m}function rc(e,t,o,...r){let s={timestamp:new Date().toISOString(),source:o,type:t,msg:r.map(a=>{try{let n=new WeakSet;return JSON.parse(JSON.stringify(a,(l,m)=>{if(m instanceof Error)return{name:m.name,message:m.message,stack:m.stack};if(typeof m=="object"&&m!==null){if(n.has(m))return"[Circular Reference]";n.add(m)}return m}))}catch(n){return`[captureLogs failed to stringify argument of type '${typeof a}'. Err: ${n.message}]`}})};e.entries.add(s),c("sbp/selectors/fn","okTurtles.events/emit")(Me,s)}var Ee=new Map,Ep=c("sbp/selectors/register",{"okTurtles.data/get":function(e){return Ee.get(e)},"okTurtles.data/set":function(e,t){return Ee.set(e,t),t},"okTurtles.data/delete":function(e){return Ee.delete(e)},"okTurtles.data/add":function(e,t){let o=Ee.get(e);o?o.push(t):Ee.set(e,[t])},"okTurtles.data/remove":function(e,t){let o=Ee.get(e);if(o){let r=o.length,s=o.filter(a=>a!==t);return Ee.set(e,s),r-s.length}},"okTurtles.data/apply":function(e,t){return t(Ee.get(e))}});var so=e=>`events/${e}/listeners`,Op=c("sbp/selectors/register",{"okTurtles.events/_init":function(){this.errorHandler=(e,t)=>{console.error(`[okTurtles.events] Error at handler for ${e}`,t)}},"okTurtles.events/on":function(e,t){return c("okTurtles.data/add",so(e),t),()=>c("okTurtles.events/off",e,t)},"okTurtles.events/once":function(e,t){let o=(...r)=>{t(...r),c("okTurtles.events/off",e,o)};return c("okTurtles.events/on",e,o)},"okTurtles.events/emit":function(e,...t){var o;for(let r of c("okTurtles.data/get",so(e))||[])try{r(...t)}catch(s){(o=this.errorHandler)===null||o===void 0||o.call(this,e,s)}},"okTurtles.events/off":function(e,t){t?c("okTurtles.data/remove",so(e),t):c("okTurtles.data/delete",so(e))},"okTurtles.events/setErrorHandler":function(e){this.errorHandler=e}});var Ki=e=>{};var Ji={maxEntries:Vn,source:"browser"},rr=self.console,Ae=null,Ue="",nc=e=>sessionStorage.getItem(`giConsole/${Ue}/${e}`),ic=e=>sessionStorage.removeItem(`giConsole/${Ue}/${e}`),Xi=(e,t)=>{sessionStorage.setItem(`giConsole/${Ue}/${e}`,typeof t=="string"?t:JSON.stringify(t))};async function sc(e){Ue=e,Ae=await qi(Ji,{getItem:nc,removeItem:ic,setItem:Xi}),Xi("config",Ji),Ae.setAppLogsFilter(c("state/vuex/state").settings?.appLogsFilter??[]),c("okTurtles.events/on",De,Ae.setAppLogsFilter),self.console=Ae.console;let t=!sessionStorage.getItem("NEW_SESSION");t&&sessionStorage.setItem("NEW_SESSION","1"),rr.log(t?"NEW_SESSION":"NEW_VISIT","Starting to capture logs of type:",Ae.appLogsFilter)}async function ac({wipeOut:e}){e&&await Yi(),c("okTurtles.events/off",De),console.log("captureLogs paused"),self.console=rr}async function Yi(){await Ae?.clear()}window.addEventListener("visibilitychange",e=>c("appLogs/save").catch(t=>{console.error("Error saving logs during visibilitychange event handler",t)}));Ki(rr);var zp=c("sbp/selectors/register",{"appLogs/get"(){return Ae?.entries.toArray()??[]},async"appLogs/save"(){await Ae?.save()},"appLogs/pauseCapture":ac,"appLogs/startCapture":sc,async"appLogs/clearLogs"(e){let t=Ue;Ue=e;try{await Yi()}catch{}Ue=t}});var Qi=e=>Object.prototype.hasOwnProperty.call(e,"sbpInvocation"),Vp=c("sbp/selectors/register",{"okTurtles.eventQueue/_init":function(){this.eventQueues=Object.create(null)},"okTurtles.eventQueue/isWaiting":function(e){var t;return!!(!((t=this.eventQueues[e])===null||t===void 0)&&t.length)},"okTurtles.eventQueue/queuedInvocations":function(e){var t,o;return e==null?Object.fromEntries(Object.entries(this.eventQueues).map(([r,s])=>[r,s.map(a=>Qi(a)?a.sbpInvocation:a.fn)])):(o=(t=this.eventQueues[e])===null||t===void 0?void 0:t.map(r=>Qi(r)?r.sbpInvocation:r.fn))!==null&&o!==void 0?o:[]},"okTurtles.eventQueue/queueEvent":async function(e,t){Object.prototype.hasOwnProperty.call(this.eventQueues,e)||(this.eventQueues[e]=[]);let o=this.eventQueues[e],r,s=new Promise(n=>{r=n}),a=typeof t=="function"?{fn:t,promise:s}:{sbpInvocation:t,promise:s};for(o.push(a);o.length>0;){let n=o[0];if(n===a)try{return typeof t=="function"?await t():await c(...t)}finally{r(),o.shift()}else await n.promise}}});var ba=he(es());var nr=function(){function e(t,o){for(var r=0;r<o.length;r++){var s=o[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}();function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(function(){if(typeof window>"u")return;var e=Array.prototype.slice,t=Element.prototype.matches||Element.prototype.msMatchesSelector,o=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","details","summary","iframe","object","embed","[contenteditable]"].join(","),r=function(){function p(i,u){ir(this,p),this._inertManager=u,this._rootElement=i,this._managedNodes=new Set,this._rootElement.hasAttribute("aria-hidden")?this._savedAriaHidden=this._rootElement.getAttribute("aria-hidden"):this._savedAriaHidden=null,this._rootElement.setAttribute("aria-hidden","true"),this._makeSubtreeUnfocusable(this._rootElement),this._observer=new MutationObserver(this._onMutation.bind(this)),this._observer.observe(this._rootElement,{attributes:!0,childList:!0,subtree:!0})}return nr(p,[{key:"destructor",value:function(){this._observer.disconnect(),this._rootElement&&(this._savedAriaHidden!==null?this._rootElement.setAttribute("aria-hidden",this._savedAriaHidden):this._rootElement.removeAttribute("aria-hidden")),this._managedNodes.forEach(function(u){this._unmanageNode(u.node)},this),this._observer=null,this._rootElement=null,this._managedNodes=null,this._inertManager=null}},{key:"_makeSubtreeUnfocusable",value:function(u){var d=this;n(u,function(E){return d._visitNode(E)});var h=document.activeElement;if(!document.body.contains(u)){for(var g=u,v=void 0;g;){if(g.nodeType===Node.DOCUMENT_FRAGMENT_NODE){v=g;break}g=g.parentNode}v&&(h=v.activeElement)}u.contains(h)&&(h.blur(),h===document.activeElement&&document.body.focus())}},{key:"_visitNode",value:function(u){if(u.nodeType===Node.ELEMENT_NODE){var d=u;d!==this._rootElement&&d.hasAttribute("inert")&&this._adoptInertRoot(d),(t.call(d,o)||d.hasAttribute("tabindex"))&&this._manageNode(d)}}},{key:"_manageNode",value:function(u){var d=this._inertManager.register(u,this);this._managedNodes.add(d)}},{key:"_unmanageNode",value:function(u){var d=this._inertManager.deregister(u,this);d&&this._managedNodes.delete(d)}},{key:"_unmanageSubtree",value:function(u){var d=this;n(u,function(h){return d._unmanageNode(h)})}},{key:"_adoptInertRoot",value:function(u){var d=this._inertManager.getInertRoot(u);d||(this._inertManager.setInert(u,!0),d=this._inertManager.getInertRoot(u)),d.managedNodes.forEach(function(h){this._manageNode(h.node)},this)}},{key:"_onMutation",value:function(u,d){u.forEach(function(h){var g=h.target;if(h.type==="childList")e.call(h.addedNodes).forEach(function(E){this._makeSubtreeUnfocusable(E)},this),e.call(h.removedNodes).forEach(function(E){this._unmanageSubtree(E)},this);else if(h.type==="attributes"){if(h.attributeName==="tabindex")this._manageNode(g);else if(g!==this._rootElement&&h.attributeName==="inert"&&g.hasAttribute("inert")){this._adoptInertRoot(g);var v=this._inertManager.getInertRoot(g);this._managedNodes.forEach(function(E){g.contains(E.node)&&v._manageNode(E.node)})}}},this)}},{key:"managedNodes",get:function(){return new Set(this._managedNodes)}},{key:"hasSavedAriaHidden",get:function(){return this._savedAriaHidden!==null}},{key:"savedAriaHidden",set:function(u){this._savedAriaHidden=u},get:function(){return this._savedAriaHidden}}]),p}(),s=function(){function p(i,u){ir(this,p),this._node=i,this._overrodeFocusMethod=!1,this._inertRoots=new Set([u]),this._savedTabIndex=null,this._destroyed=!1,this.ensureUntabbable()}return nr(p,[{key:"destructor",value:function(){if(this._throwIfDestroyed(),this._node&&this._node.nodeType===Node.ELEMENT_NODE){var u=this._node;this._savedTabIndex!==null?u.setAttribute("tabindex",this._savedTabIndex):u.removeAttribute("tabindex"),this._overrodeFocusMethod&&delete u.focus}this._node=null,this._inertRoots=null,this._destroyed=!0}},{key:"_throwIfDestroyed",value:function(){if(this.destroyed)throw new Error("Trying to access destroyed InertNode")}},{key:"ensureUntabbable",value:function(){if(this.node.nodeType===Node.ELEMENT_NODE){var u=this.node;if(t.call(u,o)){if(u.tabIndex===-1&&this.hasSavedTabIndex)return;u.hasAttribute("tabindex")&&(this._savedTabIndex=u.tabIndex),u.setAttribute("tabindex","-1"),u.nodeType===Node.ELEMENT_NODE&&(u.focus=function(){},this._overrodeFocusMethod=!0)}else u.hasAttribute("tabindex")&&(this._savedTabIndex=u.tabIndex,u.removeAttribute("tabindex"))}}},{key:"addInertRoot",value:function(u){this._throwIfDestroyed(),this._inertRoots.add(u)}},{key:"removeInertRoot",value:function(u){this._throwIfDestroyed(),this._inertRoots.delete(u),this._inertRoots.size===0&&this.destructor()}},{key:"destroyed",get:function(){return this._destroyed}},{key:"hasSavedTabIndex",get:function(){return this._savedTabIndex!==null}},{key:"node",get:function(){return this._throwIfDestroyed(),this._node}},{key:"savedTabIndex",set:function(u){this._throwIfDestroyed(),this._savedTabIndex=u},get:function(){return this._throwIfDestroyed(),this._savedTabIndex}}]),p}(),a=function(){function p(i){if(ir(this,p),!i)throw new Error("Missing required argument; InertManager needs to wrap a document.");this._document=i,this._managedNodes=new Map,this._inertRoots=new Map,this._observer=new MutationObserver(this._watchForInert.bind(this)),l(i.head||i.body||i.documentElement),i.readyState==="loading"?i.addEventListener("DOMContentLoaded",this._onDocumentLoaded.bind(this)):this._onDocumentLoaded()}return nr(p,[{key:"setInert",value:function(u,d){if(d){if(this._inertRoots.has(u))return;var h=new r(u,this);if(u.setAttribute("inert",""),this._inertRoots.set(u,h),!this._document.body.contains(u))for(var g=u.parentNode;g;)g.nodeType===11&&l(g),g=g.parentNode}else{if(!this._inertRoots.has(u))return;var v=this._inertRoots.get(u);v.destructor(),this._inertRoots.delete(u),u.removeAttribute("inert")}}},{key:"getInertRoot",value:function(u){return this._inertRoots.get(u)}},{key:"register",value:function(u,d){var h=this._managedNodes.get(u);return h!==void 0?h.addInertRoot(d):h=new s(u,d),this._managedNodes.set(u,h),h}},{key:"deregister",value:function(u,d){var h=this._managedNodes.get(u);return h?(h.removeInertRoot(d),h.destroyed&&this._managedNodes.delete(u),h):null}},{key:"_onDocumentLoaded",value:function(){var u=e.call(this._document.querySelectorAll("[inert]"));u.forEach(function(d){this.setInert(d,!0)},this),this._observer.observe(this._document.body||this._document.documentElement,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(u,d){var h=this;u.forEach(function(g){switch(g.type){case"childList":e.call(g.addedNodes).forEach(function(L){if(L.nodeType===Node.ELEMENT_NODE){var y=e.call(L.querySelectorAll("[inert]"));t.call(L,"[inert]")&&y.unshift(L),y.forEach(function(A){this.setInert(A,!0)},h)}},h);break;case"attributes":if(g.attributeName!=="inert")return;var v=g.target,E=v.hasAttribute("inert");h.setInert(v,E);break}},this)}}]),p}();function n(p,i,u){if(p.nodeType==Node.ELEMENT_NODE){var d=p;i&&i(d);var h=d.shadowRoot;if(h){n(h,i,h);return}if(d.localName=="content"){for(var g=d,v=g.getDistributedNodes?g.getDistributedNodes():[],E=0;E<v.length;E++)n(v[E],i,u);return}if(d.localName=="slot"){for(var L=d,y=L.assignedNodes?L.assignedNodes({flatten:!0}):[],A=0;A<y.length;A++)n(y[A],i,u);return}}for(var C=p.firstChild;C!=null;)n(C,i,u),C=C.nextSibling}function l(p){if(!p.querySelector("style#inert-style, link#inert-style")){var i=document.createElement("style");i.setAttribute("id","inert-style"),i.textContent=`
[inert] {
  pointer-events: none;
  cursor: default;
}

[inert], [inert] * {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
`,p.appendChild(i)}}var m=new a(document);Element.prototype.hasOwnProperty("inert")||Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(i){m.setInert(this,i)}})})();var Qp=c("sbp/selectors/register",{"chelonia/externalStateSetup":function({stateSelector:e,reactiveSet:t=Reflect.set.bind(Reflect),reactiveDel:o=Reflect.deleteProperty.bind(Reflect)}){this.stateSelector=e,c("okTurtles.events/on",ke,(r,s)=>{c("okTurtles.eventQueue/queueEvent",ke,async()=>{let{contractState:a,cheloniaState:n}=await c("chelonia/contract/fullState",r),l=c(e);n?(l.contracts||t(l,"contracts",Object.create(null)),t(l.contracts,r,xt(n))):l.contracts&&o(l.contracts,r),a?t(l,r,xt(a)):o(l,r),c("okTurtles.events/emit",Yo,r,s)})}),c("okTurtles.events/on",Xo,(r,{added:s,removed:a,permanent:n})=>{c("okTurtles.eventQueue/queueEvent",ke,async()=>{let l=s.length?await c("chelonia/contract/fullState",s):{},m=c("state/vuex/state");m.contracts||t(m,"contracts",Object.create(null)),a.forEach(p=>{n?t(m.contracts,p,null):o(m.contracts,p),o(m,p)});for(let p of s){let{contractState:i,cheloniaState:u}=l[p];u&&t(m.contracts,p,xt(u)),i&&t(m,p,xt(i))}c("okTurtles.events/emit",ti,r,{added:s,removed:a})})})},"chelonia/externalStateWait":async function(e){await c("chelonia/contract/wait",e);let{cheloniaState:t}=await c("chelonia/contract/fullState",e),o=c(this.stateSelector);if(!(!t||t.height<=o.contracts[e]?.height))return new Promise(r=>{let s=c("okTurtles.events/on",Yo,a=>{if(a!==e)return;let n=c(this.stateSelector);t.height<=n.contracts[e]?.height&&(r(),s())})})}});var ts=({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");e&&r.loggedIn?.identityContractID!==e||r[t]&&r.chatroom.currentChatRoomIDs[t]===o&&c("state/vuex/commit","setCurrentChatRoomId",{groupID:t})};c("okTurtles.events/on",Pn,({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");if(r.loggedIn?.identityContractID===e&&(!r.chatroom.currentChatRoomIDs[t]||r.chatroom.pendingChatRoomIDs[t]===o)){let s=0,a=()=>{if(c("state/vuex/getters").isJoinedChatRoom(o,e))c("state/vuex/commit","setCurrentChatRoomId",{groupID:t,chatRoomID:o});else{if(++s>5){console.warn("[JOINED_CHATROOM] Given up on setCurrentChatRoomId after 5 attempts",{identityContractID:e,groupContractID:t,chatRoomID:o});return}setTimeout(a,5*Math.pow(1.75,s))}};a()}});c("okTurtles.events/on",Mn,ts);c("okTurtles.events/on",Dn,ts);c("okTurtles.events/on",bt,({chatRoomID:e,messageHash:t})=>{t?c("state/vuex/commit","setChatRoomScrollPosition",{chatRoomID:e,messageHash:t}):c("state/vuex/commit","deleteChatRoomScrollPosition",{chatRoomID:e})});c("okTurtles.events/on",_t,({chatRoomID:e,settings:t})=>{c("state/vuex/commit","setChatroomNotificationSettings",{chatRoomID:e,settings:t})});c("okTurtles.events/on",Ln,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");o.loggedIn?.identityContractID===e&&o[t]&&c("chelonia/contract/wait",t).then(()=>{if(!c("state/vuex/getters").ourGroups.includes(t))return;c("state/vuex/state")[t].generalChatRoomId||c("gi.ui/prompt",{heading:b("Error joining the #general chatroom"),question:b("There was an error joining the #general chatroom because it doesn't exist"),primaryButton:b("Close")})})});c("okTurtles.events/on",Gn,({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");r.loggedIn?.identityContractID===e&&r[t]&&c("chelonia/contract/wait",t).then(()=>{if(!c("state/vuex/getters").ourGroups.includes(t))return;let a=c("state/vuex/state"),n=c("state/vuex/getters");a[t].chatRooms[o]?.members[e]?.status===ee.ACTIVE&&!n.isJoinedChatRoom(o,e)&&c("gi.ui/prompt",{heading:b("Error joining chatroom"),question:b("There was an error joining the {chatRoomName} chatroom",{chatRoomName:a[t].chatRooms[o]?.name?`#${a[t].chatRooms[o].name}`:b("(unknown)")}),primaryButton:b("Close")})})});c("okTurtles.events/on",Rn,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");o.loggedIn?.identityContractID===e&&o[t]&&(o.currentGroupId||(c("state/vuex/commit","setCurrentGroupId",{contractID:t}),c("state/vuex/commit","setCurrentChatRoomId",{})))});c("okTurtles.events/on",On,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");if(o.loggedIn?.identityContractID!==e)return;let r=o[e],s=o.currentGroupId;if(!s||s===t){let a=Object.entries(r.groups).map(([n,{hasLeft:l}])=>!l&&n).filter(n=>n&&n!==t).sort(n=>c("state/vuex/state")[n]?.profiles?.[t]?-1:1)[0]||null;c("state/vuex/commit","setCurrentChatRoomId",{}),c("state/vuex/commit","setCurrentGroupId",{contractID:a,forceRefresh:s===t})}});c("okTurtles.events/on",Bn,([e,t])=>{c("state/vuex/commit","setLastLoggedIn",[e,t])});var cc=c("sbp/selectors/register",{"gi.app/group/createAndSwitch":async function(e){let t=await c("gi.actions/group/create",e);return c("gi.app/group/switch",t,!0),t},"gi.app/group/switch":function(e,t){c("okTurtles.events/emit",Ht,{contractID:e,isNewlyCreated:t}),c("state/vuex/commit","setCurrentGroupId",{contractID:e,isNewlyCreated:t})},"gi.app/group/joinAndSwitch":async function(e){return await c("gi.actions/group/join",e),c("gi.app/group/switch",e.contractID,!0)},"gi.app/group/joinWithInviteSecret":async function(e,t){let o=await c("gi.actions/group/joinWithInviteSecret",e,t);return c("gi.app/group/switch",e,!0),o},"gi.app/group/addAndJoinChatRoom":async function(e){let t=await c("gi.actions/group/addAndJoinChatRoom",e);return c("state/vuex/commit","setPendingChatRoomId",{chatRoomID:t,groupID:e.contractID}),t},"gi.app/group/checkGroupSizeAndProposeMember":async function(){let{groupMembersCount:t,currentGroupState:o}=c("state/vuex/getters"),r=Object.values(o.invites||{}).filter(a=>a.creatorID!==ot).length;if(t+r>=ii){let a={a_:`<a class='link' href='${qt.WIKIPEDIA_DUNBARS_NUMBER}' target='_blank'>`,_a:"</a>"},n={heading:"Large group size",question:b("Group sizes are limited to {a_}Dunbar's Number{_a} to prevent fraud.",a),primaryButton:b("OK")},l=await c("gi.ui/prompt",n);return!1}else c("okTurtles.events/emit",z,"AddMembers")},"gi.app/group/checkAndSeeProposal":function({contractID:e,data:t}){let o=c("state/vuex/getters");c("state/vuex/state").currentGroupId!==e&&c("state/vuex/commit","setCurrentGroupId",{contractID:e}),Object.keys(o.currentGroupState.proposals||{}).includes(t.proposalHash)?c("controller/router").push({path:"/dashboard#proposals"}):c("okTurtles.events/emit",z,"PropositionsAllModal",{targetProposal:t.proposalHash})},"gi.app/group/displayMincomeChangedPrompt":async function({contractID:e,data:t}){let o=c("state/vuex/getters");c("state/vuex/state").currentGroupId!==e&&c("state/vuex/commit","setCurrentGroupId",{contractID:e});let{withGroupCurrency:s}=o,a=t.increased?{heading:b("Mincome changed"),question:b("Do you make at least {amount} per month?",{amount:s(t.amount)}),primaryButton:t.memberType==="pledging"?b("No"):b("Yes"),secondaryButton:t.memberType==="pledging"?b("Yes"):b("No")}:{heading:b("Automatically switched to pledging {zero}",{zero:s(0)}),question:b("You now make more than the mincome. Would you like to increase your pledge?"),primaryButton:b("Yes"),secondaryButton:b("No")};await c("gi.ui/prompt",a)&&c("okTurtles.events/emit",gt,"IncomeDetails")}});Z();var ho=he(Kn());var $=he(Kn(),1),ns=he(ec(),1),G=he(tc(),1);var sr="AUTHSALT",ar="CONTRACTSALT",os="CS",rs="SU";var co=e=>e.replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,""),is=e=>e.replace(/_/g,"/").replace(/-/g,"+")+"=".repeat((4-e.length%4)%4),it=(...e)=>G.default.hash($.Buffer.concat(e.map(t=>G.default.hash($.Buffer.from(t))))),ss=(...e)=>G.default.hash($.Buffer.concat(e.map(t=>$.Buffer.from(t)))),cr=()=>co($.Buffer.from(G.default.randomBytes(12)).toString("base64"));var lo=e=>co($.Buffer.from(G.default.hash($.Buffer.from(e))).toString("base64")),lr=(e,t,o)=>{let r=it(e,t),s=it(o,r),a=G.default.hash(s);return[s,a]};var uo=(e,t)=>{let o=ss(os,e).slice(0,G.default.secretbox.keyLength),r=$.Buffer.from(is(t),"base64"),s=r.subarray(0,G.default.secretbox.nonceLength),a=r.subarray(G.default.secretbox.nonceLength),n=G.default.secretbox.open(a,s,o);if(!n)throw new Error("Failed to decrypt contract salt");return $.Buffer.from(n).toString()};var Tt=(e,t)=>new Promise(o=>(0,ns.default)(e,t,{N:16384,r:8,p:1,dkLen:32,encoding:"hex"},o)),as=()=>G.default.box.keyPair(),lc=(e,t)=>{let o=$.Buffer.from(is(e),"base64"),r=G.default.box.before(o,t);if(!o||o.byteLength!==G.default.box.publicKeyLength)return!1;let s=$.Buffer.from(it(sr,r)).subarray(0,24).toString("base64"),a=$.Buffer.from(it(ar,r)).subarray(0,24).toString("base64");return[s,a]};var cs=async(e,t,o)=>{let r=lc(e,t);if(!r)throw new Error("Invalid public or secret key");let[s,a]=r,n=await Tt(o,s),l=G.default.randomBytes(G.default.box.nonceLength),m=G.default.hash($.Buffer.from(s+a)).slice(0,G.default.secretbox.keyLength),p=G.default.secretbox($.Buffer.from(n),l,m);return[a,co($.Buffer.concat([l,p]).toString("base64")),m]},ls=async(e,t)=>{let o=$.Buffer.from(it(sr,t)).subarray(0,24).toString("base64"),r=$.Buffer.from(it(ar,t)).subarray(0,24).toString("base64"),s=ss(rs,t).slice(0,G.default.secretbox.keyLength),a=G.default.randomBytes(G.default.secretbox.nonceLength),n=await Tt(e,o),l=G.default.secretbox($.Buffer.from(n),a,s),m=$.Buffer.concat([a,l]);return[r,co(m.toString("base64"))]};var us=[],Ct={async ready(){await Promise.all(us.map(e=>e()))},createInstance({name:e,storeName:t}){let o=(()=>{let r;return()=>(r||(r=new Promise((s,a)=>{if(e.includes("-")||t.includes("-")){a(new Error("Unsupported characters in name: -"));return}let n=l=>{let m=self.indexedDB.open(e+"--"+t,l);m.onupgradeneeded=p=>{p.target.result.createObjectStore(t)},m.onsuccess=p=>{let i=p.target.result;if(!i.objectStoreNames.contains(t))return n(i.version+1);s(i)},m.onerror=p=>{a(p)},m.onblocked=p=>{a(new Error("DB is blocked"))}};n()})),r)})();return us.push(o),{async clear(){let n=(await o()).transaction([t],"readwrite").objectStore(t).clear();return new Promise((l,m)=>{n.onsuccess=()=>{l()},n.onerror=p=>{m(p)}})},async getItem(r){let l=(await o()).transaction([t],"readonly").objectStore(t).get(r);return new Promise((m,p)=>{l.onsuccess=i=>{m(i.target.result)},l.onerror=i=>{p(i)}})},async removeItem(r){let l=(await o()).transaction([t],"readwrite").objectStore(t).delete(r);return new Promise((m,p)=>{l.onsuccess=()=>{m()},l.onerror=i=>{p(i.target.error)}})},async setItem(r,s){let m=(await o()).transaction([t],"readwrite").objectStore(t).put(s,r);return new Promise((p,i)=>{m.onsuccess=()=>{p()},m.onerror=u=>{i(u.target.error)}})}}}},uc=async e=>{let t=li(ge),o=wt(t),r=Te(t,!0),s=Te(t,!1),a=ui(),n=await e(o,a),l=Qo(n,r,o);return{encryptionParams:{stateEncryptionKeyId:o,salt:a,encryptedStateEncryptionKey:l},stateEncryptionKeyP:s}},pe=Ct.createInstance({name:"Group Income",storeName:"Settings"}),fo=class extends Error{},ps="@settings/currentUser",ms="CHELONIA_STATE";c("sbp/selectors/register",{"gi.db/ready":function(){return Ct.ready()},"gi.db/settings/save":function(e,t){return pe.setItem("u"+e,t)},"gi.db/settings/load":function(e){return pe.getItem("u"+e)},"gi.db/settings/delete":function(e){return pe.removeItem("u"+e)},"gi.db/settings/saveEncrypted":async function(e,t,o){let{stateEncryptionKeyId:r,salt:s,encryptedStateEncryptionKey:a}=o,n=await pe.getItem("k"+r);if(!n)throw new Error(`Unable to retrieve the key corresponding to key ID ${r}`);let l=Qo(n,JSON.stringify(t),e);return pe.setItem("e"+e,`${btoa(r)}.${btoa(s)}.${btoa(a)}.${btoa(l)}`).finally(()=>{c("gi.db/settings/delete",e).catch(m=>{console.error("[gi.db/settings/saveEncrypted] Error deleting unencrypted data for key",e,m)})})},"gi.db/settings/loadEncrypted":function(e,t){return pe.getItem("e"+e).then(async o=>{if(!o||typeof o!="string")throw new fo(`Unable to retrive state for ${e||""}`);let[r,s,a,n]=o.split(".").map(u=>atob(u)),l=await t(r,s),m=Zo(l,a,r),p=wt(m);if(p!==r)throw new Error(`Invalid state key ID: expected ${r} but got ${p}`);let i=JSON.parse(Zo(m,n,e||""));return await pe.setItem("k"+r,m),{encryptionParams:{stateEncryptionKeyId:r,salt:s,encryptedStateEncryptionKey:a},value:i}}).catch(async o=>{if(!t)throw o;o instanceof fo||console.warn("Error while retrieving local state",o);let{encryptionParams:r,stateEncryptionKeyP:s}=await uc(t);return await pe.setItem("k"+r.stateEncryptionKeyId,s),{encryptionParams:r,value:null}})},"gi.db/settings/deleteStateEncryptionKey":function({stateEncryptionKeyId:e}){return pe.removeItem("k"+e)},"gi.db/settings/deleteEncrypted":function(e){return pe.removeItem("e"+e)}});var se=Ct.createInstance({name:"Group Income",storeName:"Files Cache"}),ds=100;c("sbp/selectors/register",{"gi.db/filesCache/save":async function(e,t){if(e.startsWith("__"))throw new Error("Invalid key");let o=await se.getItem("keys")??[];return c("okTurtles.eventQueue/queueEvent","gi.db/files",()=>se.setItem(e,t).then(async r=>{console.log("successfully saved:",e);let s=o.indexOf(e);if(s!==-1&&o.splice(s,1),o.push(e),o.length>ds){let a=o.splice(0,o.length-ds);await Promise.all(a.map(n=>se.removeItem(n)))}await se.setItem("keys",o)}).catch(r=>{console.error("error saving:",e,r)}))},"gi.db/filesCache/load":async function(e){if(e.startsWith("__"))throw new Error("Invalid key");let t=await se.getItem(e);return t&&c("okTurtles.eventQueue/queueEvent","gi.db/files",async()=>{let o=await se.getItem("keys")??[],r=o.indexOf(e);r!==-1&&(o.splice(r,1),o.push(e),await se.setItem("keys",o))}).catch(o=>{console.error("[gi.db/filesCache/load] Error updating keys")}),t},"gi.db/filesCache/delete":async function(e){if(e.startsWith("__"))throw new Error("Invalid key");await se.removeItem(e),c("okTurtles.eventQueue/queueEvent","gi.db/files",async()=>{let t=await se.getItem("keys")??[],o=t.indexOf(e);o!==-1&&(t.splice(o,1),await se.setItem("keys",t))}).catch(t=>{console.error("[gi.db/filesCache/delete] Error updating keys")})},"gi.db/filesCache/clear":async function(){await se.clear()}});var po=Ct.createInstance({name:"Group Income",storeName:"Archive"});c("sbp/selectors/register",{"gi.db/archive/save":function(e,t){return po.setItem(e,t)},"gi.db/archive/load":function(e){return po.getItem(e)},"gi.db/archive/delete":function(e){return po.removeItem(e)},"gi.db/archive/clear":function(){return po.clear()}});var mo=Ct.createInstance({name:"Group Income",storeName:"Logs"});c("sbp/selectors/register",{"gi.db/logs/save":function(e,t){return mo.setItem(e,t)},"gi.db/logs/load":function(e){return mo.getItem(e)},"gi.db/logs/delete":function(e){return mo.removeItem(e)},"gi.db/logs/clear":function(){return mo.clear()}});function Ne(e){return function(t){if(!t.ok){let o=`${t.status}: ${t.statusText}`;throw t.status===404||t.status===410?new kn(o,{cause:t.status}):new In(o)}return t[e]()}}var dc=async(e,t)=>{if(t){let o=(a,n)=>de(ge,t,n+a),{encryptionParams:r,value:s}=await c("gi.db/settings/loadEncrypted",e,o);if(s){let a=s.cheloniaState;return delete s.cheloniaState,{encryptionParams:r,state:s,cheloniaState:a}}else return{encryptionParams:r,state:null,cheloniaState:null}}else return{encryptionParams:null,state:await c("gi.db/settings/load",e),cheloniaState:null}};c("okTurtles.events/on",Qe,async({identityContractID:e,encryptionParams:t,state:o})=>{await c("okTurtles.eventQueue/queueEvent",ke,async()=>{try{let r=c("state/vuex/state");if(r.loggedIn&&r.loggedIn.identityContractID!==e)throw console.error("Received login event during active session",{receivedIdentityContractID:e,existingIdentityContractID:r.loggedIn.identityContractID}),new Error("Received login event but there already is an active session");let s=Y(await c("chelonia/rootState"));if(o)o.contracts&&Object.keys(o.contracts).forEach(n=>{delete o[n]}),Object.keys(s.contracts).forEach(n=>{s[n]&&(o[n]=s[n])}),o.contracts=s.contracts,s.namespaceLookups&&(o.namespaceLookups=s.namespaceLookups),c("state/vuex/postUpgradeVerification",o),c("state/vuex/replace",o);else{let n=r;n.contracts&&Object.keys(n.contracts).forEach(l=>{I.delete(n,l)}),Object.keys(s.contracts).forEach(l=>{s[l]&&I.set(n,l,s[l])}),I.set(n,"contracts",s.contracts),s.namespaceLookups&&I.set(n,"namespaceLookups",s.namespaceLookups),c("state/vuex/postUpgradeVerification",n)}t&&c("state/vuex/commit","login",{identityContractID:e,encryptionParams:t});let a=c("state/vuex/state");if(!a.currentGroupId){let n=Object.keys(a.contracts).find(l=>a[e].groups[l]&&!a[e].groups[l].hasLeft);n&&c("gi.app/group/switch",n)}c("gi.db/settings/deleteEncrypted",e).catch(n=>{console.error("Error deleting encrypted settings after login")}),c("okTurtles.events/emit",Ie,{identityContractID:e})}catch(r){c("okTurtles.events/emit",Pe,{identityContractID:e,error:r})}})});c("okTurtles.events/on",zn,e=>{c("state/vuex/commit","setUnreadMessages",e)});c("okTurtles.events/on",Hn,e=>{c("state/vuex/commit","setPreferences",e)});c("okTurtles.events/on",Nn,e=>{c("state/vuex/commit","setKvStoreStatus",e)});var pc=c("sbp/selectors/register",{"gi.app/identity/retrieveSalt":async(e,t)=>{let o=cr(),r=lo(o),s=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/auth_hash?b=${encodeURIComponent(r)}`).then(Ne("json")),{authSalt:a,s:n,sig:l}=s,m=await Tt(t.valueOf(),a),[p,i]=lr(o,n,m),u=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/contract_hash?${new URLSearchParams({r:o,s:n,sig:l,hc:ho.Buffer.from(i).toString("base64").replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,"")}).toString()}`).then(Ne("text"));return JSON.parse(uo(p,u))},"gi.app/identity/updateSaltRequest":async(e,t,o)=>{let r=cr(),s=lo(r),a=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/auth_hash?b=${encodeURIComponent(s)}`).then(Ne("json")),{authSalt:n,s:l,sig:m}=a,p=await Tt(t.valueOf(),n),[i,u]=lr(r,l,p),[d,h]=await ls(o.valueOf(),i),g=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/updatePasswordHash`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`${new URLSearchParams({r,s:l,sig:m,hc:ho.Buffer.from(u).toString("base64").replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,""),Ea:h}).toString()}`}).then(Ne("text")),[v,E]=JSON.parse(uo(i,g));return[d,v,E]},"gi.app/identity/create":async function({data:{username:e,email:t,password:o,picture:r},publishOptions:s}){o=o.valueOf();let a=as(),n=ho.Buffer.from(a.publicKey).toString("base64").replace(/\//g,"_").replace(/\+/g,"-"),l=lo(n),m=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/register/${encodeURIComponent(e)}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`b=${encodeURIComponent(l)}`}).then(Ne("json")),{p,s:i,sig:u}=m,[d,h,g]=await cs(p,a.secretKey,o),v=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/register/${encodeURIComponent(e)}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:new URLSearchParams({r:n,s:i,sig:u,Eh:h})});if(!v.ok)throw new Error("Unable to register hash");let E=await v.text(),L=uo(g,E),y=await de(Jt,o,d),A=await de(ge,o,d);try{return await c("gi.actions/identity/create",{IPK:new oe(Te(y,!0)),IEK:new oe(Te(A,!0)),publishOptions:s,username:e,email:t,picture:r,token:new oe(L)})}catch(C){throw console.error("gi.app/identity/create failed!",C),new we(b("Failed to create user identity: {reportError}",Ye(C)))}},"gi.app/identity/signup":async function({username:e,email:t,password:o},r){try{let s=c("gi.utils/avatar/create");return await c("gi.app/identity/create",{data:{username:e,email:t,password:o,picture:s},publishOptions:r})}catch(s){console.error("gi.app/identity/signup failed!",s),await c("gi.app/identity/logout");let a=Ye(s);throw s.name==="GIErrorUIRuntimeError"&&(a.reportError=s.message),new we(b("Failed to signup: {reportError}",a))}},"gi.app/identity/login":function({username:e,password:t,identityContractID:o}){return c("okTurtles.eventQueue/queueEvent","APP-LOGIN",async()=>{if(console.debug("[gi.app/identity/login] Scheduled call starting",o,e),e){let n=await c("namespace/lookup",e,{skipCache:!1});if(!o)o=n;else if(n!==o)throw console.error(new Error(`Identity contract ID mismatch during login: ${o} != ${n}`)),new we(b("Identity contract ID mismatch during login"))}if(!o)throw new we(b("Incorrect username or password"));let r=t?.valueOf(),s=[],a;if(r)try{let[n,l]=await c("gi.app/identity/retrieveSalt",o,t),m=await de(ge,r,n);s.push(m),a=l}catch(n){throw console.error("caught error calling retrieveSalt:",n),new we(b("Incorrect username or password"))}try{await c("appLogs/startCapture",o);let{state:n,cheloniaState:l,encryptionParams:m}=await dc(o,r),p,i;try{let u=new Promise((d,h)=>{let g=({identityContractID:y})=>{L(),y===o?d(c("state/vuex/save")):h(new Error(`Identity contract ID mismatch during login: ${o} != ${y}`))},v=({identityContractID:y,error:A})=>{E(),h(y===o?A:new Error(`Identity contract ID mismatch during login (on error): ${o} != ${y}`))},E=c("okTurtles.events/once",Ie,g),L=c("okTurtles.events/once",Pe,v)});if(r)await c("gi.actions/identity/login",{identityContractID:o,encryptionParams:m,cheloniaState:l,state:n,transientSecretKeys:new oe(s.map(d=>Te(d,!0))),oldKeysAnchorCid:a});else{try{await c("chelonia/contract/sync",o)}catch(d){throw u.catch(h=>{console.warn("[gi.app/identity/login] Error in login complete promise",h)}),d}c("okTurtles.events/emit",Qe,{identityContractID:o,state:n})}await u}catch(u){c("okTurtles.events/off",Ie,p),c("okTurtles.events/off",Pe,i);let d=u?.message||String(u);console.error("[gi.app/identity] Error during login contract sync",u);let h=u&&(u.name==="ChelErrorForkedChain"||u.cause?.name==="ChelErrorForkedChain"),g=u&&(u.name==="ChelErrorResourceGone"||u.cause?.name==="ChelErrorResourceGone"),v={heading:b("Login error"),question:h?b("The server's history for your identity contract has diverged from ours. This can happen in extremely rare circumstances due to either malicious activity or a bug. {br_}To fix this, the contract needs to be resynced, and some recent events may be missing. {br_}Would you like to log out and resync data on your next login? {br_}Error details: {err}.",{err:d,...Se()}):g?b("Your account seems to have been deleted from the server. {br_}To fix this, you need to log out and create a new account. {br_}Error details: {err}.",{err:d,...Se()}):b("An error occurred while logging in. Please try logging in again. {br_}Error details: {err}.",{err:d,...Se()}),primaryButton:b("Log out"),primaryButtonStyle:"primary",isContentCentered:!h&&!g};if(await c("gi.ui/prompt",v))return c("gi.ui/clearBanner"),c("gi.app/identity/_private/logout",n,h);throw c("okTurtles.events/emit",Pe,{username:e,identityContractID:o,error:u}),u}return o}catch(n){console.error("gi.app/identity/login failed!",n);let l=b("Failed to log in: {reportError}",Ye(n));throw alert(l),await c("gi.app/identity/_private/logout").catch(m=>{console.error("[gi.app/identity/login] Error calling logout (after failure to login)",m)}),new we(l)}})},"gi.app/identity/signupAndLogin":async function({username:e,email:t,password:o}){let r=await c("gi.app/identity/signup",{username:e,email:t,password:o});return await c("gi.app/identity/login",{username:e,password:o,identityContractID:r}),r},"gi.app/identity/_private/logout":async function(e,t){try{let o=e||Y(c("state/vuex/state"));if(!o.loggedIn)return;let r=await c("gi.actions/identity/logout"),{identityContractID:s,encryptionParams:a}=o.loggedIn;a&&(t||(o.cheloniaState=r,Object.keys(r.contracts||{}).forEach(n=>{delete o[n]}),delete o.contracts,await c("state/vuex/save",!0,o)),await c("gi.db/settings/deleteStateEncryptionKey",a),await c("appLogs/pauseCapture",{wipeOut:!0})),t&&await Promise.all([c("gi.db/settings/delete",s),c("gi.db/settings/deleteEncrypted",s),c("gi.db/settings/delete",ms)])}catch(o){console.error(`${o.name} during logout: ${o.message}`,o)}},"gi.app/identity/logout":(...e)=>c("okTurtles.eventQueue/queueEvent","APP-LOGIN",["gi.app/identity/_private/logout",...e]),"gi.app/identity/changePassword":async(e,t)=>{let o=c("state/vuex/state");if(!o.loggedIn)return;let r=c("state/vuex/getters"),{identityContractID:s}=o.loggedIn,a=r.usernameFromID(s),n=e.valueOf(),l=t.valueOf(),[m,p,i]=await c("gi.app/identity/updateSaltRequest",s,e,t),u=await de(Jt,n,p),d=await de(ge,n,p),h=await de(Jt,l,m),g=await de(ge,l,m);return c("gi.actions/identity/changePassword",{identityContractID:s,username:a,oldIPK:new oe(u),oldIEK:new oe(d),newIPK:new oe(h),newIEK:new oe(g),updateToken:new oe(i)})},"gi.app/identity/delete":async(e,t)=>{let o=t?.valueOf(),r=[],s;if(o)try{let[a,n]=await c("gi.app/identity/retrieveSalt",e,t),l=await de(ge,o,a);r.push(l),s=n}catch(a){throw console.error("caught error calling retrieveSalt:",a),new we(b("Incorrect username or password"))}await c("gi.actions/identity/delete",{contractID:e,transientSecretKeys:new oe(r.map(a=>Te(a,!0))),oldKeysAnchorCid:s})}});var Re=new Map,Mm=c("sbp/selectors/register",{"okTurtles.data/get":function(e){return Re.get(e)},"okTurtles.data/set":function(e,t){return Re.set(e,t),t},"okTurtles.data/delete":function(e){return Re.delete(e)},"okTurtles.data/add":function(e,t){let o=Re.get(e);o?o.push(t):Re.set(e,[t])},"okTurtles.data/remove":function(e,t){let o=Re.get(e);if(o){let r=o.length,s=o.filter(a=>a!==t);return Re.set(e,s),r-s.length}},"okTurtles.data/apply":function(e,t){return t(Re.get(e))}});var go=e=>`events/${e}/listeners`,Um=c("sbp/selectors/register",{"okTurtles.events/_init":function(){this.errorHandler=(e,t)=>{console.error(`[okTurtles.events] Error at handler for ${e}`,t)}},"okTurtles.events/on":function(e,t){return c("okTurtles.data/add",go(e),t),()=>c("okTurtles.events/off",e,t)},"okTurtles.events/once":function(e,t){let o=(...r)=>{t(...r),c("okTurtles.events/off",e,o)};return c("okTurtles.events/on",e,o)},"okTurtles.events/emit":function(e,...t){var o;for(let r of c("okTurtles.data/get",go(e))||[])try{r(...t)}catch(s){(o=this.errorHandler)===null||o===void 0||o.call(this,e,s)}},"okTurtles.events/off":function(e,t){t?c("okTurtles.data/remove",go(e),t):c("okTurtles.data/delete",go(e))},"okTurtles.events/setErrorHandler":function(e){this.errorHandler=e}});var ne=Object.freeze({ENTRY:"entry",DELETION:"deletion",KV:"kv",KV_FILTER:"kv_filter",PING:"ping",PONG:"pong",PUB:"pub",SUB:"sub",UNSUB:"unsub",VERSION_INFO:"version_info"}),$e=Object.freeze({PUB:"pub",SUB:"sub",UNSUB:"unsub",PUSH_ACTION:"push_action",KV_FILTER:"kv_filter"}),fs=Object.freeze({ERROR:"error",OK:"ok"}),zm=Object.freeze({SEND_PUBLIC_KEY:"send-public-key",STORE_SUBSCRIPTION:"store-subscription",DELETE_SUBSCRIPTION:"delete-subscription",SEND_PUSH_NOTIFICATION:"send-push-notification"});var hs="pubsub-error";var mc="pubsub-reconnection-failed";var fc="pubsub-reconnection-succeeded",hc="pubsub-subscription-succeeded";function gc(e,t,o){let r={...o,type:e,data:t},s,a=function(){return s||(s=JSON.stringify(this)),s};return Object.defineProperties(r,{[Symbol.toPrimitive]:{value:a}}),r}function vc(e,t){return JSON.stringify(Object.assign({type:e},t))}var bc={close(e){let t=this;if(console.debug("[pubsub] Event: close",e.code,e.reason),t.failedConnectionAttempts++,t.socket)for(let o of gs)t.socket.removeEventListener(o,t.listeners[o]);t.socket=null,t.clearAllTimers(),t.shouldReconnect&&t.subscriptionSet.forEach(o=>{t.pendingUnsubscriptionSet.has(o)||t.pendingSubscriptionSet.add(o)}),t.subscriptionSet.clear(),t.pendingUnsubscriptionSet.clear(),t.shouldReconnect&&t.options.reconnectOnDisconnection&&(t.failedConnectionAttempts>t.options.maxRetries?c("okTurtles.events/emit",mc,t):(!xc()||t.isLocal)&&t.scheduleConnectionAttempt())},error(e){let t=this;console.warn("[pubsub] Event: error",e),clearTimeout(t.pingTimeoutID)},message(e){let t=this,{data:o}=e;if(typeof o!="string")return c("okTurtles.events/emit",hs,t,{message:`Wrong data type: ${typeof o}`}),t.destroy();let r={type:""};try{r=Sc(o)}catch(a){return c("okTurtles.events/emit",hs,t,{message:`Malformed message: ${a?.message}`}),t.destroy()}let s=t.messageHandlers[r.type];if(s)s.call(t,r);else throw new Error(`Unhandled message type: ${r.type}`)},offline(){console.info("[pubsub] Event: offline");let e=this;e.clearAllTimers(),e.failedConnectionAttempts=0,e.socket?.close()},online(){console.info("[pubsub] Event: online");let e=this;e.options.reconnectOnOnline&&e.shouldReconnect&&(e.socket||(e.failedConnectionAttempts=0,e.scheduleConnectionAttempt()))},open(){console.debug("[pubsub] Event: open");let e=this,{options:t}=this;e.connectionTimeUsed=void 0,e.clearAllTimers(),c("okTurtles.events/emit",fc,e),e.failedConnectionAttempts=-1,e.isNew=!1,t.pingTimeout>0&&t.pingTimeout<1/0&&(e.pingTimeoutID=setTimeout(()=>{e.socket?.close()},t.pingTimeout)),e.pendingSubscriptionSet.forEach(o=>{let r=this.kvFilter.get(o);e.socket?.send(vc($e.SUB,r?{channelID:o,kvFilter:r}:{channelID:o}))})},"reconnection-attempt"(){console.info("[pubsub] Trying to reconnect...")},"reconnection-succeeded"(){console.info("[pubsub] Connection re-established")},"reconnection-failed"(){console.warn("[pubsub] Reconnection failed"),this.destroy()},"reconnection-scheduled"(e){let{delay:t,nth:o}=e.detail;console.info(`[pubsub] Scheduled connection attempt ${o} in ~${t} ms`)},"subscription-succeeded"(e){let{channelID:t}=e.detail;console.debug(`[pubsub] Subscribed to channel ${t}`)}},Hm={[ne.ENTRY](e){console.debug("[pubsub] Received ENTRY:",e)},[ne.PING]({data:e}){let t=this;t.options.logPingMessages&&console.debug(`[pubsub] Ping received in ${Date.now()-Number(e)} ms`),t.socket?.send(gc(ne.PONG,e)),clearTimeout(t.pingTimeoutID),t.pingTimeoutID=setTimeout(()=>{t.socket?.close()},t.options.pingTimeout)},[ne.PUB]({channelID:e,data:t}){console.log(`[pubsub] Received data from channel ${e}:`,t)},[ne.KV]({channelID:e,key:t,data:o}){console.log(`[pubsub] Received KV update from channel ${e} ${t}:`,o)},[ne.SUB](e){console.debug(`[pubsub] Ignoring ${e.type} message:`,e.data)},[ne.UNSUB](e){console.debug(`[pubsub] Ignoring ${e.type} message:`,e.data)},[fs.ERROR]({data:e}){let{type:t,channelID:o,reason:r}=e;console.warn(`[pubsub] Received ERROR response for ${t} request to ${o}`);let s=this;switch(t){case $e.SUB:{console.warn(`[pubsub] Could not subscribe to ${o}: ${r}`),s.pendingSubscriptionSet.delete(o);break}case $e.UNSUB:{console.warn(`[pubsub] Could not unsubscribe from ${o}: ${r}`),s.pendingUnsubscriptionSet.delete(o);break}case $e.PUSH_ACTION:{let{actionType:a,message:n}=e;console.warn(`[pubsub] Received ERROR for PUSH_ACTION request with the action type '${a}' and the following message: ${n}`);break}default:console.error(`[pubsub] Malformed response: invalid request type ${t}`)}},[fs.OK]({data:{type:e,channelID:t}}){let o=this;switch(e){case $e.SUB:{o.pendingSubscriptionSet.delete(t),o.subscriptionSet.add(t),c("okTurtles.events/emit",hc,o,{channelID:t});break}case $e.UNSUB:{console.debug(`[pubsub] Unsubscribed from ${t}`),o.pendingUnsubscriptionSet.delete(t),o.subscriptionSet.delete(t),o.kvFilter.delete(t);break}case $e.KV_FILTER:{console.debug(`[pubsub] Set KV filter for ${t}`);break}default:console.error(`[pubsub] Malformed response: invalid request type ${e}`)}}},_c=["offline","online"],gs=["close","error","message","open"],yc=new Map;if(typeof self=="object"&&self instanceof EventTarget)for(let e of _c){let t=o=>yc.get(e)?.(o);self.addEventListener(e,t,!1)}var xc=()=>typeof navigator=="object"&&navigator.onLine===!1,Sc=e=>{let t=JSON.parse(e);if(typeof t!="object"||t===null)throw new TypeError("Message is null or not an object");let{type:o}=t;if(typeof o!="string"||o==="")throw new TypeError("Message type must be a non-empty string");return t};for(let e of Object.keys(bc))(e==="error"||!gs.includes(e))&&c("okTurtles.events/on",`pubsub-${e}`,(t,o)=>{let r=new CustomEvent(e,{detail:o});t.listeners[e].call(t,r)});var vs="@instance/pubsub";var wc=new Map([["fr","french.json"]]);c("okTurtles.events/on",ne.VERSION_INFO,e=>{if(e.GI_VERSION==="2.0.4"){sessionStorage.removeItem(ne.VERSION_INFO);return}console.info("New Group Income version available:",e);try{let t=sessionStorage.getItem(ne.VERSION_INFO);if(t){let o=JSON.parse(t);if(Array.isArray(o)&&!(Date.now()-o[0]>=2.5*Fe)&&e.GI_VERSION===o[1].GI_VERSION){console.warn("[NOTIFICATION_TYPE.VERSION_INFO] A different Group Income version is available, but reloading has failed to address it",{existingVersionInfo:o,versionInfo:e});return}}sessionStorage.setItem(ne.VERSION_INFO,JSON.stringify([Date.now(),e]))}catch(t){console.error("[NOTIFICATION_TYPE.VERSION_INFO] Error in handler",t)}c("okTurtles.data/get",vs)?.destroy(),window.location.reload()});var Qm=c("sbp/selectors/register",{async"backend/translations/get"(e){let[t]=e.toLowerCase().split("-"),o=wc.get(t)||"";if(o!=="")return await fetch(`${c("okTurtles.data/get","API_URL")}/assets/strings/${o}`).then(Ne("json"))}});c("sbp/selectors/register",{"namespace/lookupCached":e=>c("state/vuex/state").namespaceLookups?.[e]??null,"namespace/lookupReverseCached":e=>c("state/vuex/state").reverseNamespaceLookups?.[e]??null,"namespace/lookup":(e,{skipCache:t}={skipCache:!1})=>{if(!t){let o=c("namespace/lookupCached",e);if(o)return Promise.resolve(o)}return c("sw-namespace/lookup",e,{skipCache:t})}});Z();var vo=60*Ce,bo=180*Ce,Et=30,bs=20,_s=30;var Ic=2*Fe;function ve(e){return Date.now()-e.timestamp}function ys(e,t={}){let o=e.filter(r=>!Tc({...r,...t[r.hash]}));return o.length>Et&&(o.sort(kc),[[r=>r.read,bs],[r=>!r.read,_s]].forEach(([r,s])=>{if(s!==-1&&s<Et){let a=0;o=o.filter(n=>!r(n)||(a++,a<=s))}})),o.length>Et&&(o.length=Et),o.sort(ur)}function ur(e,t){return t.timestamp-e.timestamp}function kc(e,t){let o=2*Ce,r=15*Ce,s=21*Ce,a=-1,n=1;if(e.read===t.read)return e.timestamp>t.timestamp?a:n;{let l=e.read?e:t,m=e.read?t:e,p=m;return[(u,d)=>ve(u)<Ce&&ve(d)>r,(u,d)=>ve(u)<o&&ve(d)>s].some(u=>u(l,m))&&(p=l),p===e?a:n}}function Tc(e){return ve(e)>Cc(e)}function dr(e){return ve(e)<Ic}function xs(e){return!dr(e)}function Cc(e){return e.read?vo:bo}var Ss={chatRoomSettings(e,t){return t.currentChatRoomState.settings||{}},chatRoomAttributes(e,t){return t.currentChatRoomState.attributes||{}},chatRoomMembers(e,t){return t.currentChatRoomState.members||{}},chatRoomRecentMessages(e,t){return t.currentChatRoomState.messages||[]},chatRoomPinnedMessages(e,t){return(t.currentChatRoomState.pinnedMessages||[]).sort((o,r)=>o.height<r.height?1:-1)},isJoinedChatRoomForChatRoom(e,t){return(o,r)=>{r||(r=t.ourIdentityContractId);let s=o?.members;return!!s?.[r]&&!s[r].hasLeft}},chatRoomActiveMemberIdsForChatRoom(){return e=>{let t=e?.members;return t?Object.keys(t).filter(o=>!t[o].hasLeft):[]}}};var ws={currentGroupOwnerID(e,t){return t.currentGroupState.groupOwnerID},groupSettingsForGroup(e,t){return o=>o.settings||{}},groupSettings(e,t){return t.groupSettingsForGroup(t.currentGroupState)},profileActive(e,t){return o=>t.currentGroupState.profiles?.[o]?.status===ee.ACTIVE},pendingAccept(e,t){return o=>t.currentGroupState.profiles?.[o]?.status===ee.PENDING},groupProfileForGroup(e,t){return(o,r)=>{let s=o.profiles;return s&&s[r]&&{...s[r],get lastLoggedIn(){return t.currentGroupLastLoggedIn[r]||this.joinedDate}}}},groupProfile(e,t){return o=>t.groupProfileForGroup(t.currentGroupState,o)},groupProfilesForGroup(e,t){return o=>{let r={};for(let s in o.profiles||{}){let a=t.groupProfileForGroup(o,s);a.status===ee.ACTIVE&&(r[s]=a)}return r}},groupProfiles(e,t){return t.groupProfilesForGroup(t.currentGroupState)},groupCreatedDate(e,t){return t.groupProfile(t.currentGroupOwnerID).joinedDate},groupMincomeAmountForGroup(e,t){return o=>t.groupSettingsForGroup(o).mincomeAmount},groupMincomeAmount(e,t){return t.groupMincomeAmountForGroup(t.currentGroupState)},groupMincomeCurrency(e,t){return t.groupSettings.mincomeCurrency},groupSortedPeriodKeysForGroup(e,t){return o=>{let{distributionDate:r,distributionPeriodLength:s}=t.groupSettingsForGroup(o);if(!r)return[];let a=Object.keys(t.groupPeriodPaymentsForGroup(o)).sort();return!a.length&&ni>0&&a.push(Yt(fi(r,-s))),a[a.length-1]!==r&&a.push(r),a}},groupSortedPeriodKeys(e,t){return t.groupSortedPeriodKeysForGroup(t.currentGroupState)},periodStampGivenDateForGroup(e,t){return(o,r,s)=>Xt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).current},periodStampGivenDate(e,t){return(o,r)=>t.periodStampGivenDateForGroup(t.currentGroupState,o,r)},periodBeforePeriodForGroup(e,t){return(o,r,s)=>Xt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).previous},periodBeforePeriod(e,t){return(o,r)=>t.periodBeforePeriodForGroup(t.currentGroupState,o,r)},periodAfterPeriodForGroup(e,t){return(o,r,s)=>Xt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).next},periodAfterPeriod(e,t){return(o,r)=>t.periodAfterPeriodForGroup(t.currentGroupState,o,r)},dueDateForPeriodForGroup(e,t){return(o,r,s)=>t.periodAfterPeriodForGroup(o,r,s)},dueDateForPeriod(e,t){return(o,r)=>t.dueDateForPeriodForGroup(t.currentGroupState,o,r)},paymentHashesForPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o)[r];if(s)return wi(s)}},paymentHashesForPeriod(e,t){return o=>t.paymentHashesForPeriodForGroup(t.currentGroupState,o)},groupMembersByContractID(e,t){return Object.keys(t.groupProfiles)},groupMembersCount(e,t){return t.groupMembersByContractID.length},groupMembersPending(e,t){let o=t.currentGroupState.invites,r=t.currentGroupState._vm.invites,s=Object.create(null);for(let a in o)r[a].status===rt.VALID&&o[a].creatorID!==ot&&(s[a]={displayName:o[a].invitee,invitedBy:o[a].creatorID,expires:r[a].expires});return s},groupShouldPropose(e,t){return t.groupMembersCount>=3},groupDistributionStarted(e,t){return o=>o>=t.groupSettings?.distributionDate},groupProposalSettings(e,t){return(o=ri)=>t.groupSettings.proposals?.[o]},groupCurrency(e,t){let o=t.groupMincomeCurrency;return o&&vi[o]},groupMincomeFormatted(e,t){return t.withGroupCurrency?.(t.groupMincomeAmount)},groupMincomeSymbolWithCode(e,t){return t.groupCurrency?.symbolWithCode},groupPeriodPaymentsForGroup(e,t){return o=>o.paymentsByPeriod||{}},groupPeriodPayments(e,t){return t.groupPeriodPaymentsForGroup(t.currentGroupState)},groupThankYousFrom(e,t){return t.currentGroupState.thankYousFrom||{}},groupStreaks(e,t){return t.currentGroupState.streaks||{}},groupTotalPledgeAmount(e,t){return t.currentGroupState.totalPledgeAmount||0},withGroupCurrency(e,t){return t.groupCurrency?.displayWithCurrency},groupChatRooms(e,t){return t.currentGroupState.chatRooms},groupGeneralChatRoomId(e,t){return t.currentGroupState.generalChatRoomId},haveNeedsForThisPeriodForGroup(e,t){return(o,r)=>{let s=t.groupProfilesForGroup(o),a=[];for(let n in s){let{incomeDetailsType:l,joinedDate:m}=s[n];if(l){let p=s[n][l],i=l==="incomeAmount"?p-t.groupMincomeAmountForGroup(o):p,u=pi(r).toISOString();mi({date:m,periodStart:r,periodLength:t.groupSettingsForGroup(o).distributionPeriodLength})&&(u=m),a.push({memberID:n,haveNeed:i,when:u})}}return a}},haveNeedsForThisPeriod(e,t){return o=>t.haveNeedsForThisPeriodForGroup(t.currentGroupState,o)},paymentsForPeriodForGroup(e,t){return(o,r)=>{let s=t.paymentHashesForPeriodForGroup(o,r),a=[];if(s&&s.length>0){let n=o.payments;for(let l of s){let m=n[l];m.data.status===Si&&a.push(Ii(l,m))}}return a}},paymentsForPeriod(e,t){return o=>t.paymentsForPeriodForGroup(t.currentGroupState,o)}};var Is={loginState(e,t){return t.currentIdentityState.loginState},ourDirectMessages(e,t){return t.currentIdentityState.chatRooms||{}}};var ks=(e,t,o)=>{if(t&&e.namespaceLookups?.[t]===o)return t},Ec=(e,t)=>Object.keys(e).find(o=>e[o].creatorID===ot&&t.currentGroupState._vm.invites[o].status===rt.VALID&&!(t.currentGroupState._vm.invites[o].expires<Date.now())&&!(t.currentGroupState._vm.invites[o].quantity<=0)),Ac={currentGroupState(e){return e[e.currentGroupId]||{}},currentIdentityState(e){return e.loggedIn&&e[e.loggedIn.identityContractID]||{}},ourUsername(e,t){return e.loggedIn&&t.usernameFromID(e.loggedIn.identityContractID)},ourPreferences(e){return e.preferences},ourProfileActive(e,t){return t.profileActive(t.ourIdentityContractId)},ourPendingAccept(e,t){return t.pendingAccept(t.ourIdentityContractId)},ourGroupProfileForGroup(e,t){return o=>t.groupProfileForGroup(o,t.ourIdentityContractId)},ourGroupProfile(e,t){return t.ourGroupProfileForGroup(t.currentGroupState)},ourUserDisplayName(e,t){return(t.currentIdentityState||{}).attributes?.displayName||t.ourUsername||t.ourIdentityContractId},ourIdentityContractId(e){return e.loggedIn&&e.loggedIn.identityContractID},ourGroups(e,t){let o=t.ourIdentityContractId;return o?Object.keys(e[o]?.groups||{}).filter(r=>!e[o].groups[r].hasLeft&&e[r]):[]},currentGroupLastLoggedIn(e){return e.lastLoggedIn[e.currentGroupId]||{}},ourContributionSummary(e,t){let o=t.groupProfiles,r=t.ourIdentityContractId,s=t.ourGroupProfile;if(!s||!s.incomeDetailsType)return{};let a=s.incomeDetailsType==="incomeAmount",n=t.groupIncomeDistribution,l=m=>o[m].nonMonetaryContributions||[];return{givingMonetary:(()=>{if(a)return null;let m=[],p=[],i=n.filter(u=>u.fromMemberID===r).reduce((u,d)=>(m.push(t.userDisplayNameFromID(d.toMemberID)),p.push(d.toMemberID),u+d.amount),0);return{who:m,whoIds:p,total:i,pledged:s.pledgeAmount}})(),receivingMonetary:(()=>{if(!a)return null;let m=t.groupSettings.mincomeAmount-s.incomeAmount,p=[],i=[],u=n.filter(d=>d.toMemberID===r).reduce((d,h)=>(p.push(t.userDisplayNameFromID(h.fromMemberID)),i.push(h.fromMemberID),d+h.amount),0);return{who:p,whoIds:i,total:u,needed:m}})(),receivingNonMonetary:(()=>{let m=Object.keys(o).filter(i=>i!==r&&l(i).length>0),p=m.reduce((i,u)=>{let d=t.userDisplayNameFromID(u);return l(u).forEach(g=>{let v=i.findIndex(E=>E.what===g);v>=0?(i[v].who.push(d),i[v].whoIds.push(u)):i.push({who:[d],whoIds:[u],what:g})}),i},[]);return m.length>0?{what:p,who:m}:null})(),givingNonMonetary:(()=>{let m=s.nonMonetaryContributions;return m.length>0?m:null})()}},usernameFromID(e,t){return o=>t.ourContactProfilesById[o]?.username||e.reverseNamespaceLookups[o]||o},userDisplayNameFromID(e,t){return o=>{if(o===t.ourIdentityContractId)return t.ourUserDisplayName;let r=t.ourContactProfilesById[o];return r?.displayName||r?.username||e.reverseNamespaceLookups[o]||o}},thisPeriodPaymentInfoForGroup(e,t){return o=>t.groupPeriodPaymentsForGroup(o)[t.currentPaymentPeriodForGroup(o)]},thisPeriodPaymentInfo(e,t){return t.thisPeriodPaymentInfoForGroup(t.currentGroupState)},latePayments(e,t){let o=t.groupPeriodPayments;if(Object.keys(o).length===0)return;let r=t.ourIdentityContractId,s=t.periodBeforePeriod(t.currentPaymentPeriod),a=o[s];if(a)return a.lastAdjustedDistribution.filter(n=>n.fromMemberID===r)},groupIncomeDistribution(e,t){return tr({haveNeeds:t.haveNeedsForThisPeriod(t.currentPaymentPeriod),minimize:!1})},groupIncomeAdjustedDistributionForGroup(e,t){return o=>{let r=t.thisPeriodPaymentInfoForGroup(o);if(r&&r.lastAdjustedDistribution)return r.lastAdjustedDistribution;{let s=t.currentPaymentPeriodForGroup(o);return bi({distribution:tr({haveNeeds:t.haveNeedsForThisPeriodForGroup(o,s),minimize:t.groupSettingsForGroup(o).minimizeDistribution}),payments:t.paymentsForPeriodForGroup(o,s),dueOn:t.dueDateForPeriodForGroup(o,s)})}}},groupIncomeAdjustedDistribution(e,t){return t.groupIncomeAdjustedDistributionForGroup(t.currentGroupState)},ourPaymentsSentInPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o);if(Object.keys(s).length===0)return;let a=[],n=s[r],l=n&&n.paymentsFrom;if(l){let m=t.ourIdentityContractId,p=o.payments;for(let i in l[m])for(let u of l[m][i]){let{data:d,meta:h,height:g}=p[u];a.push({hash:u,height:g,data:d,meta:h,amount:d.amount,period:r})}}return a.sort((m,p)=>p.height-m.height)}},ourPaymentsSentInPeriod(e,t){return o=>t.ourPaymentsSentInPeriodForGroup(t.currentGroupState,o)},ourPaymentsReceivedInPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o);if(Object.keys(s).length===0)return;let a=[],n=s[r],l=n&&n.paymentsFrom;if(l){let m=t.ourIdentityContractId,p=o.payments;for(let i in l)for(let u in l[i])if(u===m)for(let d of l[i][u]){let{data:h,meta:g,height:v}=p[d];a.push({hash:d,height:v,data:h,meta:g,amount:h.amount})}}return a.sort((m,p)=>p.height-m.height)}},ourPaymentsReceivedInPeriod(e,t){return o=>t.ourPaymentsReceivedInPeriodForGroup(t.currentGroupState,o)},ourPaymentsForGroup(e,t){return o=>{let r=t.groupPeriodPaymentsForGroup(o);if(Object.keys(r).length===0)return;let s=t.ourIdentityContractId,a=t.currentPaymentPeriodForGroup(o),n=t.periodBeforePeriodForGroup(o,a),l=t.ourPaymentsSentInPeriodForGroup(o,a),m=t.ourPaymentsSentInPeriodForGroup(o,n),p=t.ourPaymentsReceivedInPeriodForGroup(o,a),i=t.ourPaymentsReceivedInPeriodForGroup(o,n),u=()=>t.groupIncomeAdjustedDistributionForGroup(o).filter(d=>d.fromMemberID===s);return{sent:[...l,...m],received:[...p,...i],todo:u()}}},ourPayments(e,t){return t.ourPaymentsForGroup(t.currentGroupState)},ourPaymentsSummary(e,t){let o=t.ourGroupProfile.incomeDetailsType==="incomeAmount",r=t.ourIdentityContractId,s=y=>o?y.toMemberID===r:y.fromMemberID===r,a=(y,A)=>y+A.amount,n=t.currentPaymentPeriod,l=t.groupIncomeAdjustedDistribution.filter(s),m=o?t.ourPaymentsReceivedInPeriod(n):t.ourPaymentsSentInPeriod(n),p=m.filter(y=>y.data.status===xi),i=p.reduce(a,0),u=l.length+m.length,d=l.filter(y=>!y.isLate),h=u-d.length-p.length,g=l.some(y=>y.partial),v=m.reduce(a,0)-i,E=l.reduce((y,A)=>y+A.amount,0)+i,L=v+E;return{paymentsDone:h,hasPartials:g,paymentsTotal:u,amountDone:v,amountTotal:L}},currentWelcomeInvite(e,t){let o=t.currentGroupState.invites,r=Ec(o,t),s=t.currentGroupState._vm.invites[r].expires;return{inviteId:r,expires:s}},groupsByName(e,t){let o=t.ourIdentityContractId,r=e[o]?.groups;return r?Object.entries(r).filter(([,{hasLeft:s}])=>!s).map(([s])=>({groupName:e[s]?.settings?.groupName||b("Pending"),contractID:s,active:e[s]?.profiles?.[o]?.status===ee.ACTIVE})):[]},profilesByGroup(e,t){return o=>{let r={};if(e.contracts[o]?.type!=="gi.contracts/group")return r;let s=e[o].profiles||{};for(let a in s){let n=s[a];n.status===ee.ACTIVE&&(r[a]=n)}return r}},groupMembersSorted(e,t){let o=t.currentGroupState.profiles;if(!o||!o[t.ourIdentityContractId])return[];let r=o[t.ourIdentityContractId].joinedHeight,s=n=>{if(n===t.ourIdentityContractId)return!1;let l=o[n];if(!l)return!1;let m=l.joinedHeight,p=new Date(l.joinedDate).getTime();return r<m&&Date.now()-p<6048e5},a=t.groupMembersPending;return[a,t.groupProfiles].flatMap(Object.keys).filter(n=>t.groupProfiles[n]||!(t.groupMembersPending[n].expires<Date.now())).map(n=>{let{contractID:l,displayName:m,username:p}=t.globalProfile(n)||a[n]||(t.groupProfiles[n]?{contractID:n}:{});return{id:n,contractID:l,username:p,displayName:m||p||n,invitedBy:t.groupMembersPending[n],isNew:s(n)}}).sort((n,l)=>{let m=n.displayName.normalize().toUpperCase(),p=l.displayName.normalize().toUpperCase();return n.invitedBy&&!l.invitedBy?-1:!n.invitedBy&&l.invitedBy?1:n.isNew&&!l.isNew?-1:!n.isNew&&l.isNew?1:m<p?-1:1})},groupProposals(e,t){return o=>e[o]?.proposals},globalProfile(e,t){return o=>t.ourContactProfilesById[o]},ourContactProfilesByUsername(e,t){let o={};return Object.keys(e.contracts).filter(r=>e.contracts[r]?.type==="gi.contracts/identity").forEach(r=>{let s=e[r].attributes;if(s){let a=ks(e,s.username,r);if(!a)return;o[a]={...s,username:a,contractID:r}}}),o},ourContactProfilesById(e,t){let o={};return Object.keys(e.contracts).filter(r=>e.contracts[r]?.type==="gi.contracts/identity").forEach(r=>{let s=e[r]?.attributes;if(s){let a=ks(e,s.username,r);o[r]={...s,username:a,contractID:r}}else o[r]={contractID:r}}),Object.keys(e.reverseNamespaceLookups).forEach(r=>{o[r]||e.contracts[r]===null||(o[r]={username:e.reverseNamespaceLookups[r],contractID:r})}),o},currentGroupContactProfilesById(e,t){let o=Object.keys(t.currentGroupState.profiles||{}),r={};for(let s in t.ourContactProfilesById)o.includes(s)&&(r[s]=t.ourContactProfilesById[s]);return r},ourContactsById(e,t){return Object.keys(t.ourContactProfilesById).sort((o,r)=>{let s=t.ourContactProfilesById[o].displayName||t.ourContactProfilesById[o].username||o,a=t.ourContactProfilesById[r].displayName||t.ourContactProfilesById[r].username||r;return s.normalize().toUpperCase()>a.normalize().toUpperCase()?1:-1})},ourContactsByUsername(e,t){return Object.keys(t.ourContactProfilesByUsername).sort((o,r)=>{let s=t.ourContactProfilesByUsername[o].displayName||o,a=t.ourContactProfilesByUsername[r].displayName||r;return s.normalize().toUpperCase()>a.normalize().toUpperCase()?1:-1})},seenWelcomeScreen(e,t){return t.currentIdentityState?.groups?.[e.currentGroupId]?.hasLeft||t.ourProfileActive&&t.currentIdentityState?.groups?.[e.currentGroupId]?.seenWelcomeScreen},...Ss,...ws,...Is},Ts=Ac;Z();var Nc={notifications(e,t,o){return e.items.map(r=>{let s={...r,...e.status[r.hash]};return ve(s)>bo?null:(!s.read&&ve(s)>vo&&(s.read=!0),s)}).filter(Boolean)},currentGroupNotifications(e,t,o){return t.notifications.filter(r=>r.groupID===o.currentGroupId)},notificationsByGroup(e,t){return o=>t.notifications.filter(r=>r.groupID===o)},currentGroupUnreadNotificationCount(e,t){return t.currentGroupUnreadNotifications.length},currentGroupUnreadNotifications(e,t,o){return t.currentGroupNotifications.filter(r=>!r.read)},currentNewNotifications(e,t){return t.currentNotifications.filter(dr)},currentNotificationCount(e,t){return t.currentNotifications.length},currentNotifications(e,t,o){return t.notifications.filter(r=>!r.groupID||r.groupID===o.currentGroupId)},currentOlderNotifications(e,t){return t.currentNotifications.filter(xs)},currentUnreadNotificationCount(e,t){return t.currentNotifications.filter(o=>!o.read).length},currentUnreadNotifications(e,t){return t.currentNotifications.filter(o=>!o.read)},totalUnreadNotificationCount(e,t){return t.notifications.filter(o=>!o.read).length},unreadGroupNotificationCountFor(e,t){return o=>t.unreadGroupNotificationsFor(o).length},unreadGroupNotificationsFor(e,t,o){return r=>r===o.currentGroupId?t.currentGroupUnreadNotifications:t.notifications.filter(s=>!s.read&&s.groupID===r)}},Cs=Nc;var pr="addNotification";var Es="removeAllNotifications",mr="removeNotification",As="setNotifications";c("okTurtles.events/on",Un,e=>{c("state/vuex/commit",pr,e)});c("okTurtles.events/on",$n,e=>{e.forEach(t=>c("state/vuex/commit",mr,t))});c("okTurtles.events/on",jn,e=>{c("state/vuex/commit","setNotificationStatus",e)});var Ns={items:[],status:{}},Oc={logout(e){Object.keys(e).forEach(t=>{I.delete(e,t)}),Object.assign(e,Y(Ns))},[pr](e,t){if(e.items.some(o=>o.hash===t.hash))return console.error("[ADD_NOTIFICATION] This notification is already in the store.",t.hash);e.items.push(t),e.items.sort(ur)},[mr](e,t){let o=e.items.findIndex(r=>r.hash===t);o>-1&&e.items.splice(o,1)},[Es](e){e.items.splice(0,e.items.length)},[As](e,t){e.items.splice(0,e.items.length,...t)},setNotificationStatus(e,t){e.status=t}},fr={state:()=>Y(Ns),getters:Cs,mutations:Oc};var Rs=()=>window.matchMedia?.("(prefers-color-scheme: dark)").matches?eo:ki,Lc=e=>{let t=document.querySelector('meta[name="theme-color"]');t&&(t.content=e===eo?"#2E3032":"#F5F5F5")},Pc="system",Mc=Rs(),Os={appLogsFilter:new URLSearchParams(location.search).get("debug")?["error","warn","info","debug","log"]:["error","warn","info"],fontSize:16,increasedContrast:!1,notificationEnabled:null,notificationVolume:1,reducedMotion:!1,theme:Pc,themeColor:Mc},Dc={colors(e){return Zt[e.themeColor]},fontSize(e){return e.fontSize},isDarkTheme(e){return e.themeColor===eo},isReducedMotionMode(e){return e.reducedMotion===!0},notificationVolume(e){return e.notificationVolume},theme(e){return e.theme}},Gc={resetSettings(e){Object.assign(e,Y(Os))},setAppLogsFilter(e,t){e.appLogsFilter=t,c("okTurtles.events/emit",De,t)},setFontSize(e,t){e.fontSize=t},setIncreasedContrast(e,t){e.increasedContrast=t},setNotificationEnabled(e,t){console.info("[setNotificationEnabled] set to:",t),e.notificationEnabled=t,c("sw/deviceSettings/set",qn.DISABLE_NOTIFICATIONS,!t).catch(o=>{console.error(`Couldn't set DISABLE_NOTIFICATIONS (${!t}): ${o.message}`)}),c("service-worker/setup-push-subscription").catch(o=>{console.error(`[setNotificationEnabled] Error calling setup-push-subscription (enabled=${t})`,o)})},setNotificationVolume(e,t){e.notificationVolume=t},setReducedMotion(e,t){e.reducedMotion=t},setTemporaryReducedMotion(e){let t=e.reducedMotion;e.reducedMotion=!0,setTimeout(()=>{e.reducedMotion=t},300)},setTheme(e,t){e.theme=t;let o=t==="system"?Rs():t;e.themeColor=o,c("okTurtles.events/emit",vt,o)}};c("okTurtles.events/on",Ze,()=>c("state/vuex/commit","resetSettings"));c("okTurtles.events/on",vt,Lc);var hr={state:()=>Y(Os),getters:Dc,mutations:Gc};var Fc={currentChatRoomId(e,t,o){return e.currentChatRoomIDs[o.currentGroupId]||null},currentChatRoomState(e,t,o){return o[t.currentChatRoomId]||{}},chatNotificationSettings(e){return Object.assign({publicDefault:{messageNotification:St.DIRECT_MESSAGES,messageSound:St.DIRECT_MESSAGES},privateDefault:{messageNotification:St.ALL_MESSAGES,messageSound:St.ALL_MESSAGES}},e.chatNotificationSettings||{})},ourUnreadMessages(e){return e.unreadMessages||{}},directMessagesByGroup(e,t,o){return r=>{let s={};if(!r)return s;for(let a of Object.keys(t.ourDirectMessages)){let n=o[a],l=t.ourDirectMessages[a],m=t.ourIdentityContractId;if(!t.isJoinedChatRoom(a,m))continue;let p=Object.keys(n.members),i=p.length===1&&p[0]===m,u=p.filter(h=>h!==m).sort((h,g)=>{let v=new Date(n.members[h].joinedDate).getTime(),E=new Date(n.members[g].joinedDate).getTime();return v-E}),d=u.some(h=>!!o[r]?.profiles[h]);if(l.visible&&(i||d)){let h=i?m:u[u.length-1],g=n.messages?.length>0?new Date(n.messages[n.messages.length-1].datetime).getTime():0;s[a]={...l,members:p,partners:u.map(v=>({contractID:v,username:t.usernameFromID(v),displayName:t.userDisplayNameFromID(v)})),lastJoinedPartner:h,title:i?t.userDisplayNameFromID(m):u.map(v=>t.userDisplayNameFromID(v)).join(", "),lastMsgTimeStamp:g,picture:t.ourContactProfilesById[h]?.picture,isDMToMyself:i}}}return s}},ourGroupDirectMessages(e,t,o){return t.directMessagesByGroup(o.currentGroupId)},ourGroupDirectMessageFromUserIds(e,t,o){return r=>{typeof r=="string"&&(r=[r]);let s=r.length===1&&r[0]===o.loggedIn.identityContractID,a=t.ourGroupDirectMessages;return Object.keys(a).find(n=>{let l=a[n];if(s)return l.isDMToMyself;{let m=l.partners.map(p=>p.contractID);return m.length===r.length&&Qn(m,r).length===r.length}})}},isGroupDirectMessage(e,t){return o=>!!t.ourGroupDirectMessages[o||t.currentChatRoomId]},isDirectMessage(e,t){return o=>!!t.ourDirectMessages[o||t.currentChatRoomId]},isGroupDirectMessageToMyself(e,t){return o=>{let r=t.ourGroupDirectMessages[o||t.currentChatRoomId];return!!r&&r?.isDMToMyself}},isJoinedChatRoom(e,t,o){return(r,s)=>t.isJoinedChatRoomForChatRoom(o[r],s)},chatRoomActiveMemberIds(e,t){return t.chatRoomActiveMemberIdsForChatRoom(t.currentChatRoomState)},currentChatVm(e,t,o){return o?.[t.currentChatRoomId]?._vm||null},currentChatRoomScrollPosition(e,t){return e.chatRoomScrollPosition?.[t.currentChatRoomId]},currentChatRoomReadUntil(e,t){return t.ourUnreadMessages[t.currentChatRoomId]?.readUntil},chatRoomUnreadMessages(e,t){return o=>t.ourUnreadMessages[o]?.unreadMessages||[]},isChatRoomManuallyMarkedUnread(e,t){return o=>!!t.ourUnreadMessages[o||t.currentChatRoomId]?.readUntil?.isManuallyMarked},groupUnreadMessages(e,t,o){return r=>{let s=n=>Object.keys(t.directMessagesByGroup(r)).includes(n),a=n=>Object.keys(o[r]?.chatRooms||{}).includes(n);return Object.keys(t.ourUnreadMessages).filter(n=>s(n)||a(n)).map(n=>t.ourUnreadMessages[n].unreadMessages.length).reduce((n,l)=>n+l,0)}},groupIdFromChatRoomId(e,t,o){return r=>Object.keys(o.contracts).find(s=>o.contracts[s]?.type==="gi.contracts/group"&&Object.keys(o[s].chatRooms).includes(r))},chatRoomsInDetail(e,t,o){let r=Xn({},t.groupChatRooms),s=o.loggedIn.identityContractID;for(let a in r){let n=o[a];if(n?.attributes&&t.isJoinedChatRoom(a,s))r[a]={...n.attributes,id:a,unreadMessagesCount:t.chatRoomUnreadMessages(a).length,joined:!0};else{let{name:l,privacyLevel:m}=r[a];r[a]={id:a,name:l,privacyLevel:m,joined:!1}}}return r},mentionableChatroomsInDetails(e,t){return Object.values(t.chatRoomsInDetail).filter(o=>[Kt.GROUP,Kt.PUBLIC].includes(o.privacyLevel)||o.privacyLevel===Kt.PRIVATE&&o.joined)},getChatroomNameById(e,t){return o=>{let r=Object.values(t.chatRoomsInDetail).find(s=>s.id===o);return r?r.name:null}},chatRoomMembersInSort(e,t){return t.groupMembersSorted.map(o=>({contractID:o.contractID,username:o.username,displayName:o.displayName})).filter(o=>!!t.chatRoomMembers[o.contractID])||[]}},Ls=Fc;Z();var Uc={currentChatRoomIDs:{},pendingChatRoomIDs:{},chatRoomScrollPosition:{},unreadMessages:null,chatNotificationSettings:{}},Ps={setCurrentChatRoomId(e,{groupID:t,chatRoomID:o}){let r=c("state/vuex/state");t&&r[t]?(o?I.set(e.currentChatRoomIDs,t,o):I.set(e.currentChatRoomIDs,t,r[t].generalChatRoomId||null),I.delete(e.pendingChatRoomIDs,t)):(o?I.set(e.currentChatRoomIDs,r.currentGroupId,o):I.set(e.currentChatRoomIDs,r.currentGroupId,null),I.delete(e.pendingChatRoomIDs,r.currentGroupId))},setPendingChatRoomId(e,{groupID:t,chatRoomID:o}){let r=c("state/vuex/state");if(c("state/vuex/getters").isJoinedChatRoom(o)){Ps.setCurrentChatRoomId(e,{groupID:t,chatRoomID:o});return}t&&r[t]&&(o?I.set(e.pendingChatRoomIDs,t,o):I.set(e.pendingChatRoomIDs,t,null))},setUnreadMessages(e,t){I.set(e,"unreadMessages",t)},setChatRoomScrollPosition(e,{chatRoomID:t,messageHash:o}){I.set(e.chatRoomScrollPosition,t,o)},deleteChatRoomScrollPosition(e,{chatRoomID:t}){I.delete(e.chatRoomScrollPosition,t)},setChatroomNotificationSettings(e,{chatRoomID:t,settings:o}){if(t){e.chatNotificationSettings[t]||I.set(e.chatNotificationSettings,t,{});for(let r in o)I.set(e.chatNotificationSettings[t],r,o[r])}}},gr={state:()=>Y(Uc),getters:Ls,mutations:Ps};I.use(Ko.default);var Ms={currentGroupId:null,contracts:{},loggedIn:!1,namespaceLookups:Object.create(null),reverseNamespaceLookups:Object.create(null),contractSigningKeys:Object.create(null),lastLoggedIn:{},preferences:{},periodicNotificationAlreadyFiredMap:{alreadyFired:Object.create(null),lastRun:Object.create(null)},kvStoreStatus:{identity:et.NON_INIT,group:et.NON_INIT}};window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{c("state/vuex/getters").theme==="system"&&V.commit("setTheme","system")});var At=I.observable({date:new Date});setInterval(function(){let e=V.getters.periodStampGivenDate?.(At.date),t=V.getters.periodStampGivenDate?.(new Date);e!==t&&(At.date=new Date)},60*1e3);c("sbp/selectors/register",{"state/vuex/state":()=>V.state,"state/vuex/reset":()=>{let e=Y(Ms);e.notifications=fr.state(),e.settings=hr.state(),e.chatroom=gr.state(),e.idleVue={isIdle:!1},V.replaceState(e)},"state/vuex/replace":e=>V.replaceState(e),"state/vuex/commit":(e,t)=>V.commit(e,t),"state/vuex/getters":()=>V.getters,"state/vuex/settings":()=>V.state.settings,"state/vuex/postUpgradeVerification":function(e){e.preferences||(e.preferences={}),e.kvStoreStatus||(e.kvStoreStatus={identity:et.NON_INIT,group:et.NON_INIT}),e.periodicNotificationAlreadyFiredMap&&(e.periodicNotificationAlreadyFiredMap.alreadyFired||(e.periodicNotificationAlreadyFiredMap.alreadyFired=Object.create(null)),e.periodicNotificationAlreadyFiredMap.lastRun||(e.periodicNotificationAlreadyFiredMap.lastRun=Object.create(null))),Promise.resolve(c("chelonia/rootState")).then(t=>{if(t.namespaceLookups)return;let o=Object.entries(t.contracts).filter(([,{type:r}])=>r==="gi.contracts/identity").map(([r])=>r);return console.info("Fixing missing lookup entries",o),Promise.all(o.map(r=>{let s=t[r].attributes?.username;if(s)return c("namespace/lookup",s,{skipCache:!0})})).catch(r=>{console.error("[state/vuex/postUpgradeVerification] Error during lookup",r)})}),Object.entries(e.namespaceLookups).filter(([,t])=>!e.reverseNamespaceLookups[t]).forEach(([t,o])=>{e.reverseNamespaceLookups[o]=t}),Object.entries(e.reverseNamespaceLookups).filter(([,t])=>!e.namespaceLookups[t]).forEach(([t,o])=>{e.namespaceLookups[o]=t})},"state/vuex/save":(e,t)=>c("okTurtles.eventQueue/queueEvent","state/vuex/save",async function(){if(t=t||V.state,!t.loggedIn)return;let{identityContractID:o,encryptionParams:r}=t.loggedIn;t.notifications.items=ys(t.notifications.items||[],t.notifications.status||{}),e?await c("gi.db/settings/saveEncrypted",o,t,r):await c("gi.db/settings/save",o,t)})});var $c={login(e,t){e.loggedIn=t},setCurrentGroupId(e,{contractID:t,forceRefresh:o,isNewlyCreated:r}){if(I.set(e,"currentGroupId",t),!t||o){if(c("controller/router").history.current.path==="/join")return;c("controller/router").push({path:"/"}).catch(()=>{})}else r&&c("controller/router").push({path:"/pending-approval"}).catch(()=>{})},setPreferences(e,t){I.set(e,"preferences",t)},setLastLoggedIn(e,[t,o]){I.set(e.lastLoggedIn,t,o)},setKvStoreStatus(e,{name:t,status:o}){if(t&&o){if(!Object.values(et).includes(o))return console.warn(`bad setKvStoreStatus for ${t}: ${o}`);e.kvStoreStatus[t]=o}},noop(){}},V=new Ko.default.Store({state:Y(Ms),mutations:$c,getters:{...Ts,currentPaymentPeriodForGroup(e,t){return o=>t.periodStampGivenDateForGroup(o,At.date)},currentPaymentPeriod(e,t){return t.currentPaymentPeriodForGroup(t.currentGroupState)}},modules:{notifications:fr,settings:hr,chatroom:gr},strict:!1});V.watch(function(e,t){return t.currentGroupState.settings?.distributionDate},function(){At.date=new Date});var vr=!1,br=tt(()=>!vr&&c("state/vuex/save"),500);V.subscribe(e=>{e.type!=="noop"&&br()});c("okTurtles.events/on",ke,br);c("sbp/filters/selector/add","gi.app/identity/logout",function(){vr=!0,br.clear()});c("okTurtles.events/on",Ze,()=>{vr=!1});c("okTurtles.events/on",oi,async e=>{let{contracts:{manifests:t}}=await c("chelonia/config");t[e.name]===e.manifest&&e.name==="gi.contracts/group"&&V.watch((o,r)=>r.currentPaymentPeriod,(o,r)=>{let s=V.getters.groupSettings.distributionDate,a=V.getters.groupDistributionStarted(At.date);r&&o&&a&&o!==s&&c("gi.actions/group/updateDistributionDate",{contractID:V.state.currentGroupId}).catch(n=>{console.error("okTurtles.events/on CONTRACT_REGISTERED Error calling updateDistributionDate",n)})})});var ae=V;var jc={name:"Home",components:{SvgJoinGroup:Li,SvgCreateGroup:no,BannerSimple:Ti,ButtonSubmit:Ci,RenderMessageWithMarkdown:Oi},computed:{...H(["currentIdentityState","seenWelcomeScreen"]),...re(["currentGroupId"]),isLoggedIn(){return!!this.$store.state.loggedIn}},data(){return{ephemeral:{serverMessages:[],seenWelcomeScreen:!1,listener:({contractID:e})=>{e===this.currentGroupId&&(this.ephemeral.seenWelcomeScreen=!1)},showPwaPromo:!1}}},beforeMount(){c("okTurtles.events/on",Wo,this.ephemeral.listener),this.checkPwaInstallability(),fetch(`${c("okTurtles.data/get","API_URL")}/serverMessages`).then(async e=>{let t=await e.json();this.ephemeral.serverMessages=t.filter(o=>o.type==="giHomeWarning").map(o=>o.message)}).catch(e=>{console.error("[Home.vue] Error fetching or processing server announcements",e)})},mounted(){this.ephemeral.seenWelcomeScreen=this.seenWelcomeScreen,this.isLoggedIn&&this.currentGroupId?this.navigateToGroupPage():this.$route.query.next&&this.openModal("LoginModal")},destroyed(){c("okTurtles.events/off",Wo,this.ephemeral.listener)},methods:{openModal(e){c("okTurtles.events/emit",z,e)},navigateToGroupPage(){let e=this.$route.query.next??(this.ephemeral.seenWelcomeScreen?"/dashboard":"/pending-approval");this.$router.push({path:e}).catch(t=>Ei(t,e))},checkPwaInstallability(){this.ephemeral.showPwaPromo=c("service-worker/check-pwa-installability"),c("okTurtles.events/once",Wt,()=>{this.ephemeral.showPwaPromo=!0})},async onInstallClick(){await c("service-worker/trigger-install-prompt")}},watch:{currentGroupId(e){this.ephemeral.seenWelcomeScreen=this.seenWelcomeScreen,e&&this.isLoggedIn&&this.navigateToGroupPage()},isLoggedIn(e){e&&this.currentGroupId&&this.navigateToGroupPage()}}},Bc=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.currentGroupId?e._e():o("main",{staticClass:"c-splash",attrs:{"data-test":"homeLogo"}},[e.isLoggedIn?o("header",{key:"title-not-login"},[o("img",{staticClass:"logo-2",attrs:{src:"/assets/images/logo-transparent.png"}}),o("i18n",{staticClass:"is-subtitle",attrs:{tag:"p"}},[e._v("Welcome to Group Income")]),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"welcomeHomeLoggedIn"}},[e._v("Let\u2019s get this party started")])],1):o("header",{key:"title-login"},[o("img",{staticClass:"logo",attrs:{src:"/assets/images/group-income-icon-transparent.png"}}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"welcomeHome"}},[e._v("Welcome to Group Income")])],1),e.isLoggedIn?o("div",{key:"body-create",staticClass:"create-or-join"},[o("div",{staticClass:"card"},[o("svg-create-group"),o("i18n",{staticClass:"is-title-3",attrs:{tag:"h3"}},[e._v("Create")]),o("i18n",{attrs:{tag:"p"}},[e._v("Create a new group and invite your friends.")]),o("i18n",{attrs:{tag:"button","data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[e._v("Create Group")])],1),o("div",{staticClass:"card"},[o("svg-join-group"),o("i18n",{staticClass:"is-title-3",attrs:{tag:"h3"}},[e._v("Join")]),o("i18n",{attrs:{tag:"p"}},[e._v("Enter an existing group using your username.")]),o("i18n",{attrs:{tag:"button","data-test":"joinGroup"},on:{click:function(r){return e.openModal("GroupJoinModal")}}},[e._v("Join a Group")])],1)]):o("div",{key:"body-loggin",staticClass:"buttons"},[o("i18n",{ref:"loginBtn",attrs:{tag:"button","data-test":"loginBtn"},on:{click:function(r){return e.openModal("LoginModal")}}},[e._v("Login")]),o("i18n",{directives:[{name:"focus",rawName:"v-focus"}],ref:"signupBtn",attrs:{tag:"button","data-test":"signupBtn"},on:{click:function(r){return e.openModal("SignupModal")},keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.openModal("SignupModal")}}},[e._v("Signup")])],1),!e.isLoggedIn&&e.ephemeral.showPwaPromo?o("banner-simple",{staticClass:"hide-hoverable-device hide-tablet c-pwa-promo",attrs:{severity:"general"},scopedSlots:e._u([{key:"header",fn:function(){return[o("i18n",[e._v("Install this web app on your device for better usability.")])]},proxy:!0}],null,!1,1382767684)},[o("button-submit",{staticClass:"is-success is-small c-install-btn",attrs:{type:"button"},on:{click:e.onInstallClick}},[e._v(e._s(e.L("Install")))])],1):e._e(),!e.isLoggedIn&&e.ephemeral.serverMessages.length>0?o("footer",{staticClass:"c-footer"},e._l(e.ephemeral.serverMessages,function(r){return o("banner-simple",{staticClass:"c-demo-warning",attrs:{severity:"warning"}},[o("render-message-with-markdown",{attrs:{text:r}})],1)}),1):e._e()],1)},zc=[],Hc=function(e){e&&e("data-v-2fc59f2f_0",{source:".c-splash[data-v-2fc59f2f]{display:flex;flex-direction:column;text-align:center;align-items:center;min-height:100%}@media screen and (min-width:769px),print{.c-splash[data-v-2fc59f2f]{justify-content:center}}.logo[data-v-2fc59f2f]{width:8rem;margin:2rem auto}.logo-2[data-v-2fc59f2f]{width:8rem;margin:0 auto 3rem auto}@media screen and (min-width:769px),print{.logo-2[data-v-2fc59f2f]{margin:0;position:absolute;left:1.5rem;top:1.5rem}}@media screen and (min-width:769px),print{.is-subtitle[data-v-2fc59f2f]{margin-top:3rem}}@media screen and (min-width:1200px){.is-subtitle[data-v-2fc59f2f]{margin-top:0}}.buttons[data-v-2fc59f2f]{min-width:230px}.create-or-join[data-v-2fc59f2f]{display:flex;width:100%;flex-wrap:wrap;margin-top:.5rem;justify-content:center;text-align:left}@media screen and (min-width:769px),print{.create-or-join[data-v-2fc59f2f]{text-align:center}}.card[data-v-2fc59f2f]{margin:1.5rem 1.5rem 0 1.5rem;width:100%}@media screen and (min-width:769px),print{.card[data-v-2fc59f2f]{width:24.375rem}}.card h3[data-v-2fc59f2f]{margin-bottom:.25rem}.card svg[data-v-2fc59f2f]{width:6rem;margin-left:1rem;float:right}@media screen and (min-width:769px),print{.card svg[data-v-2fc59f2f]{float:none;width:9.75rem;margin:2.5rem auto 1.5rem auto}}.card .button[data-v-2fc59f2f]{margin-top:2rem}@media screen and (min-width:769px),print{.card .button[data-v-2fc59f2f]{margin-bottom:1rem}}.c-footer[data-v-2fc59f2f]{margin-top:2.25rem;padding:0 1rem;max-width:31.25rem}.c-demo-warning[data-v-2fc59f2f]{text-align:start;margin-block-end:1rem}.c-pwa-promo[data-v-2fc59f2f]{position:fixed;bottom:1.875rem;left:50%;transform:translateX(-50%);z-index:10;text-align:left;width:calc(100vw - 3rem);max-width:31.25rem}.c-pwa-promo[data-v-2fc59f2f]  .c-body{margin-top:1rem;text-align:right}.c-install-btn[data-v-2fc59f2f]{padding-left:1.75rem;padding-right:1.75rem}",map:void 0,media:void 0})},Wc="data-v-2fc59f2f",Vc=void 0,qc=!1;function Kc(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function _r(){let e=_r.styles||(_r.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Jc=Kc({render:Bc,staticRenderFns:zc},Hc,jc,Wc,qc,Vc,!1,_r,void 0,void 0),Ds=Jc;var Xc={name:"Loading",props:{title:{default:b("Hang in there"),type:String},text:{default:b("Magic is happening..."),type:[String,Number]},theme:{validator(e){return["fullView",""].indexOf(e)!==-1}}}},Yc=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"c-loading has-text-centered",class:{"c-fullView":e.theme==="fullView"}},[o("h1",{staticClass:"is-title-1"},[e._v(e._s(e.title))]),o("p",[e._v(e._s(e.text))])])},Qc=[],Zc=function(e){e&&e("data-v-78cdfd82_0",{source:".c-loading[data-v-78cdfd82]{opacity:0;padding:2rem 0;animation:showLoading-data-v-78cdfd82 .2s .5s forwards}.c-loading.c-fullView[data-v-78cdfd82]{min-height:100%;display:flex;flex-direction:column;justify-content:center}@keyframes showLoading-data-v-78cdfd82{from{opacity:0}to{opacity:1}}",map:void 0,media:void 0})},el="data-v-78cdfd82",tl=void 0,ol=!1;function rl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function yr(){let e=yr.styles||(yr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var nl=rl({render:Yc,staticRenderFns:Qc},Zc,Xc,el,ol,tl,!1,yr,void 0,void 0),Gs=nl;var Fs=!1;c("okTurtles.events/once",Qe,()=>{Fs=!0});var il={name:"Join",components:{Loading:Gs,LoginForm:Di,SignupForm:Mi,Avatar:ro,SvgBrokenLink:Gi,SvgCreateGroup:no},data(){return{ephemeral:{pageStatus:"LOADING",invitation:{},groupInfo:{},hash:null}}},computed:{...H(["ourIdentityContractId"]),...re(["currentGroupId"]),pageStatus:{get(){return this.ephemeral.pageStatus},set(e){let t=["LOADING","SIGNING","LOGGING","INVALID","EXPIRED","JOINED"];if(!t.includes(e))throw new Error(`Bad status: ${e}. Use one of the following: ${t.join(", ")}`);this.ephemeral.pageStatus=e}}},mounted(){this.ephemeral.hash=new URLSearchParams(this.$route.hash.slice(1)),Fs||!this.ourIdentityContractId?this.initialize():c("okTurtles.events/once",Qe,()=>this.initialize())},methods:{async initialize(){try{let e=b("You should ask for a new one. Sorry about that!"),t=this.ephemeral.hash.get("groupId"),o=this.ephemeral.hash.get("secret");if(!t||!o){console.error("Invalid invite link: missing group ID or secret"),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}let r=await c("chelonia/latestContractState",t),s=wt(o),a=r._vm.invites[s];if(a?.expires<Date.now()){console.log("Join.vue error: Link is already expired."),this.ephemeral.errorMsg=e,this.pageStatus="EXPIRED";return}else if(a?.initialQuantity>0&&!a.quantity){console.log("Join.vue error: Link is already used."),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}if(a?.status!==rt.VALID){console.error("Join.vue error: Link is not valid."),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}if(this.ourIdentityContractId){let i=this.ephemeral.hash?.get("groupId")||"",u=this.$store.state[i]||{};if(this.currentGroupId&&[ee.ACTIVE,ee.PENDING].includes(u?.profiles?.[this.ourIdentityContractId]))this.goToDashboard();else if(this.checkAlreadyJoinedGroup(i)){this.ephemeral.groupInfo={name:u.settings?.groupName||"",id:i},this.pageStatus="JOINED";return}else await this.accept();return}let n=this.ephemeral.hash.get("creatorID"),l=this.ephemeral.hash.get("creatorUsername"),m=l||n,p=m?b("{who} invited you to join their group!",{who:m}):b("You were invited to join");this.ephemeral.invitation={groupName:this.ephemeral.hash.get("groupName")??b("(group name unavailable)"),creatorID:n,creatorUsername:l,message:p},this.pageStatus="SIGNING"}catch(e){console.error(e),this.ephemeral.errorMsg=`${b("Something went wrong. Please, try again.")} ${e.message}`,this.pageStatus="INVALID"}},isStatus(e){return this.pageStatus===e},goHome(){this.$router.push({path:"/"})},checkAlreadyJoinedGroup(e){if(this.ourIdentityContractId){let t=this.$store.state[this.ourIdentityContractId]?.groups||{};return t[e]&&!t[e]?.hasLeft}else return!1},goToDashboard(e){e&&this.currentGroupId!==e&&c("gi.app/group/switch",e),this.$router.push({path:"/dashboard"})},async accept(){this.ephemeral.errorMsg=null;let e=this.ephemeral.hash.get("groupId"),t=this.ephemeral.hash.get("secret"),o=this.$store.state.contracts[e]?.profiles?.[this.ourIdentityContractId]?.status;if([ee.ACTIVE,ee.PENDING].includes(o))return this.goToDashboard();try{await c("gi.app/group/joinWithInviteSecret",e,t)}catch(r){console.error("Join.vue accept() error:",r),this.ephemeral.errorMsg=r.message;let s=this.checkAlreadyJoinedGroup(e);if(this.pageStatus=s?"JOINED":"INVALID",s){let a=this.$store.state[e]||{};this.ephemeral.groupInfo={name:a.settings?.groupName||"",id:e}}else c("gi.ui/prompt",{heading:b("Failed to join the group"),question:b("Error details:{br_}{err}",{err:r.message,...Se()}),primaryButton:b("Close")})}}}},sl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("img",{staticClass:"c-logo",attrs:{src:"/assets/images/logo-transparent.png"}}),e.isStatus("LOADING")?o("loading",{attrs:{theme:"fullView"}}):o("div",{staticClass:"c-page"},[e.isStatus("SIGNING")||e.isStatus("LOGGING")?o("div",[o("div",{staticClass:"c-header"},[o("div",{staticClass:"c-avatars"},[e.ephemeral.invitation.groupPicture?o("avatar",{staticClass:"c-avatars-group",attrs:{src:e.ephemeral.invitation.groupPicture,size:"lg"}}):e._e(),e.ephemeral.invitation.creatorPicture?o("avatar",{staticClass:"c-avatars-creator",attrs:{src:e.ephemeral.invitation.creatorPicture}}):e._e()],1),o("h1",{staticClass:"is-title-1 c-title",attrs:{"data-test":"groupName"}},[e._v(e._s(e.ephemeral.invitation.groupName))]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"invitationMessage"}},[e._v(e._s(e.ephemeral.invitation.message))])]),o("div",{staticClass:"card"},[e.isStatus("SIGNING")?o("signup-form",{attrs:{postSubmit:e.accept}}):o("login-form",{attrs:{postSubmit:e.accept}})],1),e.isStatus("SIGNING")?o("p",{staticClass:"c-switchEnter"},[o("i18n",[e._v("Already have an account?")]),e._v("\xA0"),o("i18n",{staticClass:"link",attrs:{tag:"button"},on:{click:function(r){e.pageStatus="LOGGING"}}},[e._v("Log in")])],1):o("p",{staticClass:"c-switchEnter"},[o("i18n",[e._v("Not on Group Income yet?")]),e._v("\xA0"),o("i18n",{staticClass:"link",attrs:{tag:"button"},on:{click:function(r){e.pageStatus="SIGNING"}}},[e._v("Create an account")])],1)]):e.isStatus("JOINED")?o("div",{staticClass:"c-joined"},[o("svg-create-group",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:{groupName:e.ephemeral.groupInfo.name}}},[e._v("You are already a member of '{groupName}'")]),o("i18n",{staticClass:"has-text-1",attrs:{tag:"p","data-test":"helperText"}},[e._v("You cannot join already joined group.")]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:function(r){return e.goToDashboard(e.ephemeral.groupInfo.id)}}},[e._v("Go to dashboard")])],1):e.isStatus("INVALID")?o("div",{staticClass:"c-broken"},[o("svg-broken-link",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:e.LTags()}},[e._v("Oh no! {br_}This invite is not valid")]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"helperText"}},[e._v(e._s(e.ephemeral.errorMsg))]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:e.goHome}},[e._v("Take me home")])],1):e.isStatus("EXPIRED")?o("div",{staticClass:"c-broken"},[o("svg-broken-link",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:e.LTags()}},[e._v("Oh no! {br_}This invite is already expired")]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"helperText"}},[e._v(e._s(e.ephemeral.errorMsg))]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:e.goHome}},[e._v("Take me home")])],1):e._e()])],1)},al=[],cl=function(e){e&&e("data-v-66143ea6_0",{source:".c-logo[data-v-66143ea6]{min-width:8rem;width:8rem;margin:auto}@media screen and (min-width:769px),print{.c-logo[data-v-66143ea6]{position:absolute;top:1.5rem;left:1.5rem}}.c-page[data-v-66143ea6]{max-width:33rem;margin:auto;height:100%}.c-welcome[data-v-66143ea6]{margin-top:-1.5rem}.c-header[data-v-66143ea6]{margin-top:1rem;display:flex;flex-direction:column;align-items:center}.c-header .c-title[data-v-66143ea6]{order:2}@media screen and (min-width:769px),print{.c-header[data-v-66143ea6]{margin-top:2.5rem}}.c-avatars[data-v-66143ea6]{position:relative;margin-bottom:1.5rem}@media screen and (min-width:769px),print{.c-avatars .c-avatars-group.is-lg[data-v-66143ea6]{width:8rem;height:8rem}}.c-avatars .c-avatars-creator[data-v-66143ea6]{position:absolute;bottom:0;right:0;border:2px solid #fff}.card[data-v-66143ea6]{padding:1.5rem 1rem;margin-top:1.5rem}@media screen and (min-width:769px),print{.card[data-v-66143ea6]{padding:2.5rem}}.c-switchEnter[data-v-66143ea6]{margin-top:1.5rem;text-align:center}.c-broken[data-v-66143ea6],.c-joined[data-v-66143ea6]{margin-top:20vh;text-align:center}.c-broken .is-title-1[data-v-66143ea6],.c-joined .is-title-1[data-v-66143ea6]{margin-top:3rem;margin-bottom:.5rem}.c-broken .c-goHome[data-v-66143ea6],.c-joined .c-goHome[data-v-66143ea6]{margin-top:2rem}@media screen and (min-width:769px),print{.c-debug[data-v-66143ea6]{position:absolute;bottom:1rem;right:1rem}}",map:void 0,media:void 0})},ll="data-v-66143ea6",ul=void 0,dl=!1;function pl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function xr(){let e=xr.styles||(xr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var ml=pl({render:sl,staticRenderFns:al},cl,il,ll,dl,ul,!1,xr,void 0,void 0),Sr=ml;Z();var fl={name:"LoadingModal",components:{ModalTemplate:io},props:{type:{type:Number,default:500}}},hl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading")}},[o("template",{slot:"title"},[e.type===500?o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("500")]):o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("404")])],1),e.type===500?o("div",{staticClass:"c-wrapper"},[o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Server error")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We are having some trouble. Please try again later.")])],1):o("div",{staticClass:"c-wrapper"},[o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Page not found")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We couldn\u2019t find what you are looking for.")]),o("router-link",{staticClass:"button",attrs:{to:"/"}},[o("i18n",[e._v("Take me home")])],1)],1)],2)},gl=[],vl=function(e){e&&e("data-v-6a5ffef8_0",{source:".c-title[data-v-6a5ffef8]{padding:1.5rem 0}.c-wrapper[data-v-6a5ffef8]{text-align:center}",map:void 0,media:void 0})},bl="data-v-6a5ffef8",_l=void 0,yl=!1;function xl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function wr(){let e=wr.styles||(wr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Sl=xl({render:hl,staticRenderFns:gl},vl,fl,bl,yl,_l,!1,wr,void 0,void 0),Ir=Sl;var wl={name:"ErrorPage",props:{type:{type:Number,default:500}},data(){return{ephemeral:{isOnline:null}}},methods:{onlineHandler(){this.ephemeral.isOnline=!0},offlineHandler(){this.ephemeral.isOnline=!1},onRetryClick(){window.location.reload()}},mounted(){navigator.onLine===!0&&this.onlineHandler(),window.addEventListener("online",this.onlineHandler),window.addEventListener("offline",this.offlineHandler)},beforeDestroy(){window.removeEventListener("online",this.onlineHandler),window.removeEventListener("offline",this.offlineHandler)}},Il=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.type===500?o("div",{staticClass:"p-wrapper"},[o("h1",{staticClass:"is-title-1 p-title"},[e._v("500")]),o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Server error")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We are having some trouble. Please try again later.")]),e.ephemeral.isOnline?o("i18n",{staticClass:"is-outlined is-small c-retry-btn",attrs:{tag:"button"},on:{click:e.onRetryClick}},[e._v("Retry")]):e._e()],1):o("div",{staticClass:"p-wrapper"},[o("h1",{staticClass:"is-title-1 p-title"},[e._v("404")]),o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Page not found")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We couldn\u2019t find what you are looking for.")]),o("router-link",{staticClass:"button",attrs:{to:"/"}},[o("i18n",[e._v("Take me home")])],1)],1)},kl=[],Tl=function(e){e&&e("data-v-09c500b0_0",{source:".p-wrapper[data-v-09c500b0]{display:flex;flex-direction:column;text-align:center;justify-content:center;align-items:center}.c-title[data-v-09c500b0]{margin-bottom:.5rem}.c-text[data-v-09c500b0]{color:var(--text_1)}.c-text+.button[data-v-09c500b0]{align-self:center;margin-top:2rem}.c-retry-btn[data-v-09c500b0]{width:max-content}",map:void 0,media:void 0})},Cl="data-v-09c500b0",El=void 0,Al=!1;function Nl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function kr(){let e=kr.styles||(kr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Rl=Nl({render:Il,staticRenderFns:kl},Tl,wl,Cl,Al,El,!1,kr,void 0,void 0),Us=Rl;var Ol={name:"LoadingModal",components:{ModalTemplate:io}},Ll=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading"),loading:!0,"data-test":"loadingModal"}},[o("template",{slot:"title"},[o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("Loading...")])],1),o("div",{staticClass:"loading-box"})],2)},Pl=[],Ml=function(e){e&&e("data-v-1809ff32_0",{source:".c-title[data-v-1809ff32]{padding:1.5rem 0}",map:void 0,media:void 0})},Dl="data-v-1809ff32",Gl=void 0,Fl=!1;function Ul(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Tr(){let e=Tr.styles||(Tr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var $l=Ul({render:Ll,staticRenderFns:Pl},Ml,Ol,Dl,Fl,Gl,!1,Tr,void 0,void 0),$s=$l;var jl={name:"LoadingModal",components:{ModalBaseTemplate:Fi}},Bl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-base-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading"),loading:!0}},[o("div",{staticClass:"wrapper-container"},[o("div",{staticClass:"container"},[o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("Loading...")]),o("div",{staticClass:"loading-box"})],1)])])},zl=[],Hl=function(e){e&&e("data-v-4f5fa5b8_0",{source:".wrapper-container[data-v-4f5fa5b8]{height:100%;width:100%;opacity:1;background-color:var(--general_2)}.container[data-v-4f5fa5b8]{max-width:66vw;margin:0 auto}.c-title[data-v-4f5fa5b8]{padding:2.5rem 0 1rem 0}",map:void 0,media:void 0})},Wl="data-v-4f5fa5b8",Vl=void 0,ql=!1;function Kl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Cr(){let e=Cr.styles||(Cr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Jl=Kl({render:Bl,staticRenderFns:zl},Hl,jl,Wl,ql,Vl,!1,Cr,void 0,void 0),js=Jl;var Xl={name:"LoadingPage"},Yl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-wrapper"},[o("header",{staticClass:"p-header"},[o("h1",{staticClass:"is-title-2 p-title"},[o("img",{staticClass:"c-logo",attrs:{src:"/assets/images/group-income-icon-transparent.png",alt:""}}),e._v(e._s(e.$route.meta.title))])]),e._m(0)])},Ql=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("main",{staticClass:"p-main"},[o("div",{staticClass:"loading-box"}),o("div",{staticClass:"loading-box"}),o("div",{staticClass:"loading-box"})])}],Zl=function(e){e&&e("data-v-0f1d4d2c_0",{source:'.p-wrapper[data-v-0f1d4d2c]{display:grid;grid-template-areas:"p-header" "p-main";grid-template-columns:1fr;grid-template-rows:auto minmax(0,1fr);height:100%;width:100vw}@media screen and (min-width:1200px){.p-wrapper[data-v-0f1d4d2c]{width:auto;grid-template-columns:minmax(0,1fr) 16.5rem;grid-template-areas:"p-header p-sidebar" "p-main p-sidebar"}}.p-main[data-v-0f1d4d2c]{grid-area:p-main;width:calc(100% - 2rem);margin:0 auto;padding-top:1.5rem;max-width:50rem;display:flex;flex-direction:column;-webkit-overflow-scrolling:touch}@media screen and (min-width:769px),print{.p-main[data-v-0f1d4d2c]{width:calc(100% - 4rem)}}@media screen and (min-width:1200px){.p-main[data-v-0f1d4d2c]{width:auto;padding-top:0;margin-right:2rem;margin-left:5.5rem}}.p-header[data-v-0f1d4d2c]{grid-area:p-header;transition:padding ease-out .3s;text-align:center;min-height:4rem}@media screen and (max-width:1199px){.p-header[data-v-0f1d4d2c]{display:flex;justify-content:center;align-items:center;position:sticky;top:0;background:var(--general_2);z-index:3}}@media screen and (min-width:1200px){.p-header[data-v-0f1d4d2c]{display:block;padding-top:1.125rem;text-align:left;min-height:4.75rem;padding-left:5.5rem}}.p-title[data-v-0f1d4d2c]{display:flex;align-items:center}.c-logo[data-v-0f1d4d2c]{width:1.5rem;height:1.5rem;margin-right:1rem}@media screen and (min-width:1200px){.c-logo[data-v-0f1d4d2c]{display:none}}',map:void 0,media:void 0})},eu="data-v-0f1d4d2c",tu=void 0,ou=!1;function ru(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Er(){let e=Er.styles||(Er.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var nu=ru({render:Yl,staticRenderFns:Ql},Zl,Xl,eu,ou,tu,!1,Er,void 0,void 0),Bs=nu;function zs(e,{loading:t,error:o}={}){return()=>({component:e().then(r=>r.default??r),loading:t,error:o})}function D(e,t,{loading:o,error:r}={}){I.component(e,zs(t,{loading:o,error:r}))}function F(e,t){D(e,t,{loading:$s,error:Ir})}function st(e,t){D(e,t,{loading:js,error:Ir})}function be(e,{loading:t=Bs,error:o=Us}={}){let r=zs(e,{loading:t,error:o});return()=>Promise.resolve({functional:!0,render(s,{data:a,children:n}){return s(r,a,n)}})}F("AccountRemovalModal",()=>import("./AccountRemovalModal-UG7LVO6C-cached.js"));F("ChatMembersAllModal",()=>import("./ChatMembersAllModal-3A5YCI7P-cached.js"));F("CreateNewChannelModal",()=>import("./CreateNewChannelModal-5G266KDW-cached.js"));F("DeleteChannelModal",()=>import("./DeleteChannelModal-6OXRQEWO-cached.js"));F("EditChannelDescriptionModal",()=>import("./EditChannelDescriptionModal-KXWIRNSI-cached.js"));F("EditChannelNameModal",()=>import("./EditChannelNameModal-J2H4JMXH-cached.js"));F("ChatNotificationSettingsModal",()=>import("./ChatNotificationSettingsModal-XA63VL34-cached.js"));F("GroupLeaveModal",()=>import("./GroupLeaveModal-QT7TVRVG-cached.js"));F("GroupDeletionModal",()=>import("./GroupDeletionModal-HK5NSPE2-cached.js"));F("InvitationLinkModal",()=>import("./InvitationLinkModal-D6CQBFIB-cached.js"));F("LeaveChannelModal",()=>import("./LeaveChannelModal-D47COB3I-cached.js"));F("LoginModal",()=>import("./LoginModal-JEMXYJIN-cached.js"));F("NotificationModal",()=>import("./NotificationModal-LK427Q2T-cached.js"));F("PasswordModal",()=>import("./PasswordModal-3OLC7QHH-cached.js"));F("SignupModal",()=>import("./SignupModal-RBGPOCCH-cached.js"));F("Prompt",()=>import("./Prompt-X665Y7E7-cached.js"));F("SendThankYouModal",()=>import("./SendThankYouModal-SKP36QVP-cached.js"));F("ThankYouNoteModal",()=>import("./ThankYouNoteModal-OFHV6DFM-cached.js"));F("AvatarEditorModal",()=>import("./AvatarEditorModal-HMUJCFRM-cached.js"));F("ChatFileAttachmentWarningModal",()=>import("./ChatFileAttachmentWarningModal-ELKJMPYB-cached.js"));F("ImageViewerModal",()=>import("./ImageViewerModal-CIXF24UU-cached.js"));st("GroupCreationModal",()=>import("./GroupCreationModal-JAT5NL7F-cached.js"));st("GroupJoinModal",()=>import("./GroupJoinModal-2U4K3I4D-cached.js"));st("GroupMembersAllModal",()=>import("./GroupMembersAllModal-BYNK3UDS-cached.js"));st("IncomeDetails",()=>import("./IncomeDetails-5Z4UIZGO-cached.js"));st("UserSettingsModal",()=>import("./UserSettingsModal-XKPA7NDL-cached.js"));D("AddMembers",()=>import("./AddMembers-KUKQCU2G-cached.js"));D("ChangeVotingRules",()=>import("./ChangeVotingRules-Q75B7DF4-cached.js"));D("MincomeProposal",()=>import("./Mincome-I5BPNMB2-cached.js"));D("DistributionDateProposal",()=>import("./DistributionDate-YHPV2ZON-cached.js"));D("PaymentsHistoryModal",()=>import("./PaymentsHistoryModal-NCXQ766X-cached.js"));D("RemoveMember",()=>import("./RemoveMember-RGVYQN6C-cached.js"));D("GenericProposal",()=>import("./GenericProposal-RIKM4CF6-cached.js"));st("PropositionsAllModal",()=>import("./PropositionsAllModal-CQLGUIRH-cached.js"));D("PaymentDetail",()=>import("./PaymentDetail-W77X3QVC-cached.js"));D("RecordPayment",()=>import("./RecordPayment-BHMIH5J5-cached.js"));D("SendPaymentsViaLightning",()=>import("./SendPaymentsViaLightning-THZPLNHL-cached.js"));D("ExportPaymentsModal",()=>import("./ExportPaymentsModal-RO2KTBXD-cached.js"));D("Appearence",()=>import("./Appearence-7QVYDCOT-cached.js"));D("NotificationSettings",()=>import("./NotificationSettings-LQTJCJLJ-cached.js"));D("AppLogs",()=>import("./AppLogs-E3DZTFPO-cached.js"));D("NewDirectMessageModal",()=>import("./NewDirectMessageModal-AY5NRT5Z-cached.js"));D("Placeholder",()=>import("./Placeholder-AAI57BQ7-cached.js"));D("Troubleshooting",()=>import("./Troubleshooting-WQHSJK7G-cached.js"));D("UserProfile",()=>import("./UserProfile-HPUIZVFN-cached.js"));D("Acknowledgements",()=>import("./Acknowledgements-SGMKQBS5-cached.js"));D("DSModalFullscreen",()=>import("./DSModalFullscreen-EAAXD5QD-cached.js"));D("DSModalNested",()=>import("./DSModalNested-VPHOPAF2-cached.js"));D("DSModalQuery",()=>import("./DSModalQuery-N2QPRQYE-cached.js"));Z();var iu=be(()=>import("./Contributions-PPTCEOEO-cached.js")),su=be(()=>import("./DesignSystem-UNJLW5JR-cached.js")),Hs=be(()=>import("./GroupChat-C6634V6R-cached.js")),au=be(()=>import("./GroupDashboard-IHCPAO4B-cached.js")),cu=be(()=>import("./GlobalDashboard-Q544LMEH-cached.js")),lu=be(()=>import("./GroupSettings-EHCDYKFA-cached.js")),uu=be(()=>import("./Payments-7BL25KC3-cached.js")),du=be(()=>import("./PendingApproval-2YWXZ7R5-cached.js"));I.use(er);var pu={guard:(e,t)=>!!ae.state.currentGroupId,redirect:(e,t)=>({path:ae.getters.seenWelcomeScreen?"/dashboard":"/pending-approval"})},Oe={guard:(e,t)=>!ae.state.loggedIn,redirect:(e,t)=>({path:"/",query:{next:e.fullPath}})},mu={guard:(e,t)=>!(e.hash.includes("groupId=")&&e.hash.includes("secret=")),redirect:(e,t)=>({path:"/"})},je={guard:(e,t)=>!ae.state.currentGroupId,redirect:(e,t)=>({path:"/"})},at={guard:(e,t)=>ae.state.currentGroupId&&!ae.getters.ourProfileActive,redirect:(e,t)=>({path:"/pending-approval"})};function me(...e){return function(t,o,r){for(let s of e)if(s.guard(t,o))return r(s.redirect(t,o));r()}}var Ar=new er({mode:"history",base:"/app",scrollBehavior(e,t,o){return{x:0,y:0}},routes:[{path:"/",component:Ds,name:"home",meta:{title:b("Group Income")},beforeEnter:me(pu)},{path:"/design-system",component:su,name:"DesignSystem",meta:{title:b("Design System")}},{path:"/dashboard",component:au,name:"GroupDashboard",meta:{title:b("Group Dashboard")},beforeEnter:me(Oe,je,at)},{path:"/global-dashboard/:id",component:cu,name:"GlobalDashboard",meta:{title:b("Global Dashboard")},beforeEnter:me(Oe,je)},{path:"/global-dashboard",redirect:"/global-dashboard/news-and-updates"},{path:"/contributions",component:iu,name:"Contributions",meta:{title:b("Contributions")},beforeEnter:me(Oe,je,at)},{path:"/payments",component:uu,name:"Payments",meta:{title:b("Payments")},beforeEnter:me(Oe,je,at)},{path:"/group-chat",component:Hs,name:"GroupChat",meta:{title:b("Group Chat")},beforeEnter:me(Oe,je,at)},{path:"/group-chat/:chatRoomID",component:Hs,name:"GroupChatConversation",meta:{title:b("Loading")},beforeEnter:me(Oe,je,at)},{path:"/group-settings",component:lu,name:"GroupSettings",meta:{title:b("Group Settings")},beforeEnter:me(Oe,je,at)},{path:"/join",name:Sr.name,component:Sr,meta:{title:b("Join a Group")},beforeEnter:me(mu)},{path:"/pending-approval",component:du,name:"PendingApproval",meta:{title:b("Pending Approval")},beforeEnter:me(Oe)},{path:"*",redirect:"/"}]});Ar.beforeEach((e,t,o)=>{if(e.query.modal&&!["Prompt","SignupModal","LoginModal"].includes(e.query.modal)&&!ae.state.loggedIn)return o({path:"/",query:{next:e.fullPath}});document.title=e.meta.title,o()});c("sbp/selectors/register",{"controller/router":()=>Ar});var _o=Ar;var yo=(()=>{let e;return()=>(e==null&&(e=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)").matches||navigator.standalone),e)})();var xo={deferredInstallPrompt:null,installed:!1};Ge.register(ji);Ge.register(oe);window.addEventListener("beforeinstallprompt",e=>{xo.deferredInstallPrompt=e,c("okTurtles.events/emit",Wt)});var Nr=new WeakMap,Rr=()=>{let e=new Promise((t,o)=>{let r=new MessageChannel;r.port1.onmessage=a=>{a.data.type==="ready"?(a.data.currentSyncs&&c("okTurtles.events/emit",Vt,a.data.currentSyncs),t()):o(a.data.error),r.port1.close()},r.port1.onmessageerror=()=>{o(new Error("Message error")),r.port1.close()};let s=()=>{navigator.serviceWorker.removeEventListener("controllerchange",s,!1),t(Rr())};navigator.serviceWorker.addEventListener("controllerchange",s,!1),navigator.serviceWorker.ready.then(a=>{if(Nr.has(a.active)){t(Nr.get(a.active));return}Nr.set(a.active,e),a.active.postMessage({type:"ready",port:r.port2,GI_VERSION:"2.0.4"},[r.port2])}).catch(a=>{o(a),r.port1.close()})});return e};c("sbp/selectors/register",{"service-worker/setup":async function(){if(!("serviceWorker"in navigator))throw new Error("Service worker APIs missing");try{let e=new URLSearchParams([["routerBase",c("controller/router").options.base??""],["standalone",yo()?"1":"0"]]),t=await navigator.serviceWorker.register(`/assets/js/sw-primary.js?${e}`,{scope:"/"});if(t.active==null&&t.installing==null&&t.waiting==null)throw new Error("No valid service worker found");await t.update(),setInterval(()=>c("service-worker/update"),Fe),navigator.serviceWorker.addEventListener("message",o=>{let r=o.data,s=c("sbp/selectors/fn","okTurtles.events/emit");if(typeof r=="object"&&r.type)switch(r.type){case"pong":break;case"event":{c("okTurtles.events/emit",o.data.subtype,...Ge(o.data.data));break}case"navigate":{r.groupID&&c("state/vuex/commit","setCurrentGroupId",{contractID:r.groupID}),c("controller/router").push({path:r.path}).catch(console.warn);break}case"sbp":{c(...Ge(o.data.data));break}case Me:{s(Me,...Ge(o.data.data));break}default:console.error("[sw] Received unknown message type from the service worker:",r);break}}),await Rr(),typeof PeriodicSyncManager=="function"&&navigator.permissions.query({name:"periodic-background-sync"}).then(o=>{if(o.state!=="granted"){console.error("[service-workers/setup] Periodic sync event permission denied");return}return navigator.serviceWorker.ready.then(r=>r.periodicSync.register("periodic-notifications",{minInterval:12*Fe}))}).catch(o=>{console.error("[service-workers/setup] Error setting up periodic background sync events",o)}),t.addEventListener("updatefound",o=>{let r=s=>{if(["activated","redundant"].includes(s.target.state)){s.target.removeEventListener("statechange",r);return}s.target.state==="installed"&&s.target.postMessage({type:"skip-waiting"})};o.target.installing.addEventListener("statechange",r,!1)}),setInterval(()=>navigator.serviceWorker.controller?.postMessage({type:"ping"}),5e3)}catch(e){throw console.error("error setting up service worker:",e),e}},"service-worker/setup-push-subscription":async function(e=1){let t=null;await c("okTurtles.eventQueue/queueEvent","service-worker/setup-push-subscription",async()=>{let{notificationEnabled:o}=c("state/vuex/state").settings,r=await navigator.serviceWorker.ready;if(!r)throw new Error("No service-worker registration found!");let a=await r.pushManager.permissionState({userVisibleOnly:!0})==="granted"||Notification.permission==="granted";console.info(`[service-worker/setup-push-subscription] setup: notifications (${o}) perms (${a})`);try{let n=null,l=null;if(o&&a){n=await r.pushManager.getSubscription();let m=!1,p=null;if(!n||n.expirationTime!=null&&n.expirationTime<=Date.now()){let i=await c("push/getSubscriptionOptions");n=await r.pushManager.subscribe(i),m=!0}n?.endpoint&&(p=new URL(n.endpoint).host,l=await gi(n.toJSON())),console.info(`[service-worker/setup-push-subscription] got ${m?"new":"existing"} subscription '${l}':`,p)}console.info("[service-worker/setup-push-subscription] calling push/reportExistingSubscription on:",l),await c("push/reportExistingSubscription",n?.toJSON(),n?.options.applicationServerKey)}catch(n){if(console.error("[service-worker/setup-push-subscription] error getting a subscription:",n),e>=12)throw console.error("[service-worker/setup-push-subscription] maxAttempts reached, giving up"),c("gi.ui/prompt",{heading:b("Error setting up push notifications"),question:b("Error setting up push notifications: {errMsg}{br_}{br_}Please make sure {a_}push services are enabled{_a} in your Browser settings, and then try reloading the app and toggling the push notifications toggle in the Notifications user settings.",{errMsg:n?.message,a_:'<a class="link" target="_blank" href="https://stackoverflow.com/a/69624651">',_a:"</a>",br_:"<br/>"}),primaryButton:b("Close")}),n;t=new Promise((l,m)=>{setTimeout(()=>{c("service-worker/setup-push-subscription",e+1).then(l).catch(m)},5e3)})}}),t&&await t},"service-worker/update":async function(){if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.ready;if(e)return await e.update();console.debug("[sw] No active service-worker was found while checking for the updates.");return}catch(e){console.error(`[sw] Failed to update the service-worker! - ${e.message}`)}},"service-worker/check-pwa-installability":function(){return!!xo.deferredInstallPrompt},"service-worker/trigger-install-prompt":async function(){return xo.deferredInstallPrompt?(await xo.deferredInstallPrompt.prompt()).outcome:!1}});[Ie,De].forEach(e=>c("okTurtles.events/on",e,(...t)=>{navigator.serviceWorker.controller?.postMessage({type:"event",subtype:e,data:t})}));c("okTurtles.events/on",bt,e=>{e.from!=="sw"&&navigator.serviceWorker.controller?.postMessage({type:"event",subtype:bt,data:[e]})});c("okTurtles.events/on",_t,e=>{e.from!=="sw"&&navigator.serviceWorker.controller?.postMessage({type:"event",subtype:_t,data:[e]})});var Be=(()=>{if(!navigator.serviceWorker)throw new Error("Missing service worker object");let e=navigator.serviceWorker.controller;navigator.serviceWorker.addEventListener("controllerchange",o=>{e=navigator.serviceWorker.controller},!1);let t=async(o,...r)=>{if(!e)throw new Error("Service worker not ready");return await Rr(),new Promise((s,a)=>{let n=new MessageChannel,l=h=>{if(h.data&&Array.isArray(h.data)){let g=Ge(h.data[1]);h.data[0]===!0?s(g):a(g),i()}},m=h=>{a(h.data),i()},p=h=>{o>0?s(t(o-1,...r)):a(new Error("SW controller changed")),i()},i=()=>{n.port1.removeEventListener("message",l,!1),n.port1.removeEventListener("messageerror",m,!1),navigator.serviceWorker.removeEventListener("controllerchange",p,!1),n.port1.close()};n.port1.addEventListener("message",l,!1),n.port1.addEventListener("messageerror",m,!1),navigator.serviceWorker.addEventListener("controllerchange",p,!1),n.port1.start();let{data:u,transferables:d}=ci(r);e.postMessage({type:"sbp",port:n.port2,data:u},[n.port2,...d])})};return(...o)=>t(3,...o)})();c("sbp/selectors/register",{"gi.actions/*":Be,"chelonia/*":Be,"sw-namespace/*":(...e)=>Be(e[0].slice(3),...e.slice(1)),"gi.notifications/*":Be,"sw/*":Be,"swLogs/*":Be,"push/*":Be});var fu={name:"AppStyles",mixins:[Bi],computed:{...H(["fontSize","colors"]),softTone(){return this.colors.theme==="dark"?.1:-.1}}},hu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-style",[e._v(`:root {
  --primary_0: `+e._s(e.colors.primary_0)+`;
  --primary_0_1: `+e._s(e.lightenDarkenColor(e.colors.primary_0,e.softTone))+`;
  --primary_1: `+e._s(e.colors.primary_1)+`;
  --primary_2: `+e._s(e.colors.primary_2)+`;
  --success_0: `+e._s(e.colors.success_0)+`;
  --success_0_1: `+e._s(e.lightenDarkenColor(e.colors.success_0,e.softTone))+`;
  --success_1: `+e._s(e.colors.success_1)+`;
  --success_2: `+e._s(e.colors.success_2)+`;
  --warning_0: `+e._s(e.colors.warning_0)+`;
  --warning_0_1: `+e._s(e.lightenDarkenColor(e.colors.warning_0,e.softTone))+`;
  --warning_0_text: `+e._s(e.colors.warning_0_text)+`;
  --warning_0_2: `+e._s(e.colors.warning_0_2)+`;
  --warning_1: `+e._s(e.colors.warning_1)+`;
  --warning_2: `+e._s(e.colors.warning_2)+`;
  --danger_0: `+e._s(e.colors.danger_0)+`;
  --danger_0_1: `+e._s(e.lightenDarkenColor(e.colors.danger_0,e.softTone))+`;
  --danger_1: `+e._s(e.colors.danger_1)+`;
  --danger_2: `+e._s(e.colors.danger_2)+`;
  --danger_3: `+e._s(e.colors.danger_3)+`;
  --text_0: `+e._s(e.colors.text_0)+`;
  --text_1: `+e._s(e.colors.text_1)+`;
  --general_0: `+e._s(e.colors.general_0)+`;
  --general_1: `+e._s(e.colors.general_1)+`;
  --general_1_opacity_6: `+e._s(e.hexToRgbA(e.colors.general_1,.6))+`;
  --general_2: `+e._s(e.colors.general_2)+`;
  --background_0: `+e._s(e.colors.background_0)+`;
  --background_0_opacity_0: `+e._s(e.hexToRgbA(e.colors.background_0,0))+`;
  --text-size: `+e._s(e.fontSize)+`px;
}`)])},gu=[],vu=void 0,bu=void 0,_u=void 0,yu=!1;function xu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`script>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var Su=xu({render:hu,staticRenderFns:gu},vu,fu,bu,yu,_u,!1,void 0,void 0,void 0),Ws=Su;var wu={name:"BannerGeneral",components:{TransitionExpand:Pi},data:()=>({ephemeral:{message:null,icon:null,severity:null}}),methods:{clean(){this.ephemeral.message="",this.ephemeral.icon="",this.ephemeral.severity=""},show(e,t){this.ephemeral.message=e,this.ephemeral.icon=t,this.ephemeral.severity="neutral"},danger(e,t){this.ephemeral.message=e,this.ephemeral.icon=t,this.ephemeral.severity="danger"},severity(){return this.ephemeral.severity},debouncedShow({message:e,icon:t,seconds:o,clearWhen:r}){let s;return tt((...a)=>{let n=()=>{r()?(this.severity()!=="danger"&&this.clean(),s=void 0):setTimeout(n,500)};!s&&!r()&&(this.show(e(...a),t),s=setTimeout(n,1e3*o))},1e3*o)}}},Iu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition-expand",[e.ephemeral.message?o("div",{staticClass:"l-banner",class:"is-"+e.ephemeral.severity,attrs:{"data-test":"bannerGeneral","aria-live":"polite"}},[o("i",{class:"icon-"+e.ephemeral.icon+" is-prefix"}),o("div",{directives:[{name:"safe-html",rawName:"v-safe-html:a",value:e.ephemeral.message,expression:"ephemeral.message",arg:"a"}],staticClass:"c-banner-content"})]):e._e()])},ku=[],Tu=function(e){e&&e("data-v-42dd8395_0",{source:".l-banner[data-v-42dd8395]{display:flex;justify-content:center;align-items:flex-start}.l-banner .c-banner-content[data-v-42dd8395]{text-align:left;word-break:break-word}.l-banner[data-v-42dd8395]  .link{color:inherit;border-bottom-color:inherit;font-weight:inherit}.is-neutral[data-v-42dd8395]{background-color:var(--text_0);color:var(--background_0)}.is-danger[data-v-42dd8395]{background-color:var(--danger_0);color:var(--background_0)}",map:void 0,media:void 0})},Cu="data-v-42dd8395",Eu=void 0,Au=!1;function Nu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Or(){let e=Or.styles||(Or.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Ru=Nu({render:Iu,staticRenderFns:ku},Tu,wu,Cu,Au,Eu,!1,Or,void 0,void 0),Vs=Ru;var Ou={name:"Modal",data(){return{content:null,subcontent:[],queries:{},replacementQueries:{},childData:{},replacement:null,lastFocus:null}},computed:{activeSubContent(){return this.subcontent.length?this.subcontent[this.subcontent.length-1]:null}},created(){c("okTurtles.events/on",z,this.openModal),c("okTurtles.events/on",Vo,this.unloadModal),c("okTurtles.events/on",gt,this.replaceModal),c("okTurtles.events/on",qo,this.setModalQueries),window.addEventListener("keyup",this.handleKeyUp)},mounted(){let{modal:e,subcontent:t}=this.$route.query;e&&this.openModal(e),t&&this.openModal(t)},beforeDestroy(){c("okTurtles.events/off",z),c("okTurtles.events/off",Vo),c("okTurtles.events/off",gt),c("okTurtles.events/off",qo),window.removeEventListener("keyup",this.handleKeyUp)},watch:{$route(e,t){let o=e.query.modal;if(o){if(o!==this.content&&(this.content?this.replaceModal(o,Jn(e.query,"modal")):this.content=o),e.query.subcontent){let r=e.query.subcontent.split("+").pop();if(r!==this.activeSubContent){let s=this.subcontent.indexOf(r);s!==-1?this.subcontent=this.subcontent.slice(0,s):this.subcontent=[r]}}}else this.content&&this.unloadModal()}},methods:{handleKeyUp(e){this.content&&e.key==="Escape"&&(e.preventDefault(),this.unloadModal())},updateUrl(){let e=this.subcontent.length;if(this.content||e>0){let t=this.queries[this.content]||{},o=this.queries[this.subcontent[e-1]]||{};this.$router.push({query:{...this.$route.query,...t,...o,modal:this.content,subcontent:e?this.subcontent.join("+"):void 0}}).catch(console.error)}else if(this.$route.query.modal||this.$route.query.subcontent){let t={...this.$route.query},o={modal:!0,subcontent:!0,...this.queries[t.modal]};for(let r in o)delete t[r];this.$router.push({rQueries:t}).catch(console.error)}},openModal(e,t={},o={}){this.content!==e&&(this.lastFocus=document.activeElement,this.content?this.subcontent.push(e):this.content=e,this.queries[e]=t,this.updateUrl(),this.childData[e]=o)},unloadModal(e=""){let t=a=>{delete this.childData[a]},o=this.subcontent.length>0,r=!1,s=a=>{t(a),this.content=null,r=!0,this.lastFocus&&this.lastFocus.focus()};e?o&&this.subcontent.indexOf(e)>=0?(t(e),this.subcontent=this.subcontent.filter(a=>a!==e),r=!0):this.content===e&&s(e):o?(t(this.activeSubContent),this.subcontent.pop(),r=!0):s(this.content),r&&(this.replacement?(this.openModal(this.replacement,this.replacementQueries[this.replacement]),delete this.replacementQueries[this.replacement],this.replacement=null):this.updateUrl())},replaceModal(e,t=null){this.replacement=e,t&&(this.replacementQueries[e]=t),this.$refs[this.activeSubContent?"subcontent":"content"].$children[0].close()},setModalQueries(e,t){this.queries[e]=t}}},Lu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o(e.content,e._b({ref:"content",tag:"component"},"component",e.childData[e.content],!1)),e.activeSubContent?o(e.activeSubContent,e._b({ref:"subcontent",tag:"component"},"component",e.childData[e.activeSubContent],!1)):e._e()],1)},Pu=[],Mu=void 0,Du=void 0,Gu=void 0,Fu=!1;function Uu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`script>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var $u=Uu({render:Lu,staticRenderFns:Pu},Mu,Ou,Du,Fu,Gu,!1,void 0,void 0,void 0),qs=$u;var ju={name:"BackgroundSounds",created(){c("okTurtles.events/on",si,this.playMessageReceive),c("okTurtles.events/on",ai,this.playMessageSend)},computed:{volumeFromStore(){return this.$store.getters.notificationVolume??1},isAppIdle(){return this.$store.state.idleVue?.isIdle}},methods:{shouldPlay(e){return!yo()&&!(this.$route.name==="GroupChatConversation"&&this.$route.params.chatRoomID===e&&!this.isAppIdle)},playMessageReceive({contractID:e}){this.shouldPlay(e)&&this.$refs.msgReceive.play()},playMessageSend(){this.shouldPlay()&&this.$refs.msgSend.play()},updateAudioVolumes(){this.$refs.msgReceive.volume=this.volumeFromStore,this.$refs.msgSend.volume=this.volumeFromStore}},mounted(){this.updateAudioVolumes()},watch:{volumeFromStore(){this.updateAudioVolumes()}}},Bu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"c-bgsound-wrapper"},[o("audio",{ref:"msgReceive",attrs:{src:"/assets/audio/msg-received.mp3",type:"audio/mpeg"}}),o("audio",{ref:"msgSend",attrs:{src:"/assets/audio/msg-sent.mp3",type:"audio/mpeg"}})])},zu=[],Hu=void 0,Wu="data-v-445785f9",Vu=void 0,qu=!1;function Ku(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var Ju=Ku({render:Bu,staticRenderFns:zu},Hu,ju,Wu,qu,Vu,!1,void 0,void 0,void 0),Ks=Ju;var Xu={name:"NotificationCard",components:{ModalClose:Ni,NotificationList:Ui,Tooltip:oo},methods:{toggleTooltip(){this.$refs.tooltip.toggle()},handleSettingsClick(){c("okTurtles.events/emit",z,"UserSettingsModal",{tab:"notifications"}),this.toggleTooltip()},markAllNotificationsAsRead(){c("gi.notifications/markAllAsRead",this.currentGroupId)}},computed:{...re(["currentGroupId"]),...H(["currentNotificationCount"])}},Yu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("tooltip",{ref:"tooltip",attrs:{direction:"right",manual:!0,opacity:1,"aria-label":e.L("Show notifications")}},[e._t("default"),o("template",{slot:"tooltip"},[o("div",{staticClass:"card c-card",attrs:{role:"dialog","aria-label":e.L("Notifications"),"data-test":"notificationCard"}},[o("div",{staticClass:"c-header"},[o("i18n",{staticClass:"is-title-4",attrs:{tag:"h2"}},[e._v("Notifications")]),o("button",{staticClass:"is-icon-small c-settings-btn",on:{click:e.handleSettingsClick}},[o("i",{staticClass:"icon-cog"})])],1),o("div",{staticClass:"c-body"},[o("notification-list",{attrs:{variant:"compact"},on:{select:e.toggleTooltip}})],1),e.currentNotificationCount?o("div",{staticClass:"c-footer"},[o("i18n",{staticClass:"link",attrs:{tag:"button","data-test":"markAllAsRead_In_Tooltip"},on:{click:e.markAllNotificationsAsRead}},[e._v("Mark all as read")]),o("router-link",{staticClass:"link",attrs:{to:{query:{modal:"NotificationModal"}}},nativeOn:{click:function(r){return e.toggleTooltip(r)}}},[o("i18n",[e._v("See all")])],1)],1):e._e(),o("modal-close",{staticClass:"c-close",attrs:{"aria-label":e.L("Close profile")},on:{close:e.toggleTooltip}})],1)])],2)},Qu=[],Zu=function(e){e&&e("data-v-32fe52eb_0",{source:'.c-card[data-v-32fe52eb]{position:relative;padding:0 0 4rem;color:var(--text_0);max-width:100vw;border-radius:3px;width:100vw;box-shadow:none}.c-card[data-v-32fe52eb]:last-child{margin-bottom:0}.is-active .c-card[data-v-32fe52eb]{animation:zoom .1s both cubic-bezier(.165,.84,.44,1)}@media screen and (max-width:768px){.is-active .c-card[data-v-32fe52eb]{animation-name:enterFromBottom}}@media screen and (min-width:769px),print{.c-card[data-v-32fe52eb]{margin-top:-.5rem;box-shadow:0 .5rem 1.25rem rgba(54,54,54,.3);width:25rem;padding:0}.c-card[data-v-32fe52eb]::before{content:"";position:absolute;top:1rem;left:-.5rem;display:block;width:0;z-index:0;border-top:.5rem solid transparent;border-right:.5rem solid var(--background_0);border-bottom:.5rem solid transparent}}.c-close[data-v-32fe52eb]{left:calc(100vw - 4rem);top:1.5rem}@media screen and (min-width:769px),print{.c-close[data-v-32fe52eb]{left:auto;right:1rem;opacity:0;pointer-events:none}.c-close[data-v-32fe52eb]:focus{opacity:1}}.c-footer[data-v-32fe52eb],.c-header[data-v-32fe52eb]{display:flex;justify-content:space-between;align-items:center}.c-header[data-v-32fe52eb]{padding:1rem 1rem .5rem}.c-footer[data-v-32fe52eb]{border-top:1px solid var(--general_1);padding:.75rem 1rem}.c-body[data-v-32fe52eb]{height:18rem;overflow:auto;overscroll-behavior-y:contain}.c-settings-btn .icon-cog[data-v-32fe52eb]{transform-origin:49% 48%}.c-settings-btn:focus .icon-cog[data-v-32fe52eb],.c-settings-btn:hover .icon-cog[data-v-32fe52eb]{animation:cog-data-v-32fe52eb .4s forwards}@keyframes cog-data-v-32fe52eb{to{transform:rotate(180deg)}}',map:void 0,media:void 0})},ed="data-v-32fe52eb",td=void 0,od=!1;function rd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Lr(){let e=Lr.styles||(Lr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var nd=rd({render:Yu,staticRenderFns:Qu},Zu,Xu,ed,od,td,!1,Lr,void 0,void 0),Js=nd;var id={name:"NotificationBell",components:{Badge:nt,NotificationCard:Js},computed:{...H(["currentUnreadNotificationCount"])}},sd=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("router-link",{staticClass:"button is-icon-small c-btn hide-tablet",attrs:{to:{query:{modal:"NotificationModal"}}}},[o("i",{staticClass:"icon-bell",class:{"is-active":e.currentUnreadNotificationCount}}),e.currentUnreadNotificationCount?o("badge",{attrs:{"data-test":"alertNotification"}},[e._v(e._s(e.currentUnreadNotificationCount))]):e._e()],1),o("notification-card",[o("button",{staticClass:"is-icon-small c-btn hide-phone"},[o("i",{staticClass:"icon-bell",class:{"is-active":e.currentUnreadNotificationCount}}),e.currentUnreadNotificationCount?o("badge",{attrs:{"data-test":"alertNotification"}},[e._v(e._s(e.currentUnreadNotificationCount))]):e._e()],1)])],1)},ad=[],cd=function(e){e&&e("data-v-67f648b3_0",{source:".c-badge[data-v-67f648b3]{top:-.25rem;right:-.25rem}.icon-bell[data-v-67f648b3]{font-size:.9rem;transform-origin:center 2px;margin-top:2px}.icon-bell.is-active[data-v-67f648b3]{font-weight:900}.c-btn:focus .icon-bell[data-v-67f648b3],.c-btn:hover .icon-bell[data-v-67f648b3]{animation:bell-data-v-67f648b3 750ms forwards}@keyframes bell-data-v-67f648b3{10%{transform:rotate(15deg)}20%{transform:rotate(-15deg)}35%{transform:rotate(15deg)}60%{transform:rotate(-10deg)}80%{transform:rotate(5deg)}}",map:void 0,media:void 0})},ld="data-v-67f648b3",ud=void 0,dd=!1;function pd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Pr(){let e=Pr.styles||(Pr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var md=pd({render:sd,staticRenderFns:ad},cd,id,ld,dd,ud,!1,Pr,void 0,void 0),Xs=md;var fd={name:"GroupsList",components:{Avatar:ro,Badge:nt,Tooltip:oo},computed:{...re(["currentGroupId"]),...H(["groupsByName","groupUnreadMessages","unreadGroupNotificationCountFor"]),badgeVisiblePerGroup(){return Object.fromEntries(this.groupsByName.map(e=>[e.contractID,this.groupUnreadMessages(e.contractID)+this.unreadGroupNotificationCountFor(e.contractID)>0]))},isInGlobalDashboard(){return this.$route.path.startsWith("/global-dashboard")}},methods:{openModal(e){c("okTurtles.events/emit",z,e)},handleMenuSelect(e){e&&this.changeGroup(e),this.isInGlobalDashboard&&this.$router.push("/dashboard")},onGlobalDashboardClick(){this.$router.push({path:"/global-dashboard"})},changeGroup(e){let t=this.$route.path,o=this.groupPictureForContract(e)==="";e!==this.currentGroupId&&c("gi.app/group/switch",e),o&&t!=="/pending-approval"?this.$router.push({path:"/pending-approval"}):!o&&t==="/pending-approval"&&this.$router.push({path:"/dashboard"})},groupPictureForContract(e){return this.$store.state[e]?.settings?.groupPicture||""}}},hd=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.groupsByName.length?o("ul",{staticClass:"c-group-list",attrs:{"data-test":"groupsList"}},[o("li",{staticClass:"c-group-list-item group-badge",class:{"is-active":e.isInGlobalDashboard}},[o("tooltip",{attrs:{direction:"right",text:e.L("Global dashboard")}},[o("button",{staticClass:"c-group-picture is-unstyled c-global-dashboard-logo",on:{click:e.onGlobalDashboardClick}},[o("avatar",{staticClass:"c-avatar",attrs:{src:"/assets/images/group-income-icon-transparent-circle.png",alt:"Global dashboard logo"}})],1)])],1),e._l(e.groupsByName,function(r,s){return o("li",{key:"group-"+s,staticClass:"c-group-list-item group-badge",class:{"is-active":!e.isInGlobalDashboard&&e.currentGroupId===r.contractID}},[o("tooltip",{attrs:{direction:"right",text:r.groupName}},[o("button",{staticClass:"c-group-picture is-unstyled",on:{click:function(a){return e.handleMenuSelect(r.contractID)}}},[o("avatar",{staticClass:"c-avatar",attrs:{src:e.groupPictureForContract(r.contractID)}})],1),e.badgeVisiblePerGroup[r.contractID]?o("badge",{attrs:{type:"compact","data-test":"groupBadge-"+r.groupName}}):e._e()],1)],1)}),o("li",{staticClass:"c-group-list-item"},[o("tooltip",{attrs:{direction:"right",text:e.L("Create a new group")}},[o("button",{staticClass:"is-icon has-background",attrs:{"data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[o("i",{staticClass:"icon-plus"})])])],1)],2):e._e()},gd=[],vd=function(e){e&&e("data-v-1c75e934_0",{source:'.c-badge[data-v-1c75e934]{top:0;right:1px;z-index:2}.c-group-list[data-v-1c75e934]{width:3.5rem;padding-top:.7rem;background-color:var(--general_1)}.c-group-list-item[data-v-1c75e934]{position:relative;display:flex;justify-content:center;align-items:center;height:3.2rem;margin-bottom:.25rem}.group-badge[data-v-1c75e934]::before{content:"";position:absolute;width:3rem;height:3rem;border:1px solid transparent;border-radius:50%;transform:scale(.7);transition:all .25s cubic-bezier(.18,.89,.32,1.38)}.group-badge.is-active[data-v-1c75e934]::before{transform:scale(1);border-color:var(--text_0);animation:spin-data-v-1c75e934 .5s ease-out}.group-badge[data-v-1c75e934]:not(.is-active){cursor:pointer}.group-badge[data-v-1c75e934]:not(.is-active):focus::before,.group-badge[data-v-1c75e934]:not(.is-active):hover::before{border-color:#fff;border-width:3px;transform:scale(1.1)}@keyframes spin-data-v-1c75e934{0%{transform:rotate(45deg);filter:hue-rotate(0);border-color:var(--primary_0) transparent transparent}50%{transform:rotate(315deg);filter:hue-rotate(360deg);border-color:var(--primary_0) transparent transparent}100%{transform:rotate(585deg);border-color:#fff}}.c-avatar[data-v-1c75e934]{position:relative;z-index:1}.c-group-picture[data-v-1c75e934]{display:flex}.c-group-picture.c-global-dashboard-logo[data-v-1c75e934]{background-color:var(--background_0);border-radius:50%;width:2.5rem;height:2.5rem}.c-group-picture.c-global-dashboard-logo[data-v-1c75e934]  img.c-avatar{width:1.75rem;height:1.75rem}',map:void 0,media:void 0})},bd="data-v-1c75e934",_d=void 0,yd=!1;function xd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Mr(){let e=Mr.styles||(Mr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Sd=xd({render:hd,staticRenderFns:gd},vd,fd,bd,yd,_d,!1,Mr,void 0,void 0),Ys=Sd;var wd={name:"Profile",components:{AvatarUser:Ai,ProfileCard:Ri},computed:{...H(["ourUsername","ourIdentityContractId"]),ourDisplayName(){let e=this.$store.getters.currentIdentityState;return e&&e.attributes&&e.attributes.displayName}},methods:{openModalUserSettings(){c("okTurtles.events/emit",z,"UserSettingsModal")}}},Id=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.$store.state.loggedIn?o("div",{staticClass:"c-profile",attrs:{"data-test":"userProfile"}},[o("profile-card",{attrs:{contractID:e.ourIdentityContractId,direction:"top-left"}},[o("button",{staticClass:"is-unstyled c-avatar-user",attrs:{"data-test":"openProfileCard"}},[o("avatar-user",{attrs:{contractID:e.ourIdentityContractId,size:"sm"}}),o("div",{staticClass:"c-user"},[o("strong",{staticClass:"has-ellipsis",attrs:{"data-test":e.ourDisplayName?"profileDisplayName":"profileName"}},[e._v(e._s(e.ourDisplayName||e.ourUsername||e.ourIdentityContractId))]),e.ourDisplayName?o("span",{staticClass:"has-ellipsis",attrs:{"data-test":"profileName"}},[e._v("@"+e._s(e.ourUsername))]):e._e()])],1)]),o("button",{staticClass:"is-icon-small",attrs:{"data-test":"settingsBtn"},on:{click:e.openModalUserSettings}},[o("i",{staticClass:"icon-cog"})])],1):e._e()},kd=[],Td=function(e){e&&e("data-v-469c796a_0",{source:".c-profile[data-v-469c796a]{display:flex;justify-content:space-between;align-items:center;height:4rem;padding:0 1rem}.c-avatar-user[data-v-469c796a]{display:flex;align-items:center}.c-avatar-user:focus .c-user strong[data-v-469c796a],.c-avatar-user:hover .c-user strong[data-v-469c796a]{border-bottom-color:var(--text_0)}.c-user[data-v-469c796a]{display:flex;flex-direction:column;align-items:flex-start;margin-left:.5rem;max-width:7rem;white-space:nowrap;line-height:1.3;margin-top:1px}.c-user strong[data-v-469c796a]{border-bottom:1px solid transparent;width:100%}.c-user span[data-v-469c796a]{font-family:Lato;color:var(--text_1);width:100%}button .icon-cog[data-v-469c796a]{font-size:.875rem;transform-origin:49% 48%}button:focus .icon-cog[data-v-469c796a],button:hover .icon-cog[data-v-469c796a]{animation:cog-data-v-469c796a .4s forwards}@keyframes cog-data-v-469c796a{to{transform:rotate(180deg)}}",map:void 0,media:void 0})},Cd="data-v-469c796a",Ed=void 0,Ad=!1;function Nd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Dr(){let e=Dr.styles||(Dr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Rd=Nd({render:Id,staticRenderFns:kd},Td,wd,Cd,Ad,Ed,!1,Dr,void 0,void 0),Qs=Rd;var Ld={name:"Navigation",mixins:[to],components:{Badge:nt,Toggle:zi,NotificationBell:Xs,GroupsList:Ys,Profile:Qs,ListItem:Hi},data(){return{config:{debounceResize:tt(this.checkIsTouch,250),globalDashboard:Object.entries(Wi).map(([e,t])=>({...t,id:e}))},ephemeral:{isActive:!1,isTouch:null}}},created(){this.checkIsTouch()},mounted(){window.addEventListener("resize",this.config.debounceResize)},beforeDestroy(){window.removeEventListener("resize",this.config.debounceResize)},watch:{$route(e,t){let o=t.path!==e.path;this.ephemeral.isActive&&o&&(this.ephemeral.isActive=!1)}},computed:{...re(["currentGroupId","loggedIn"]),...H(["groupsByName","colors","totalUnreadNotificationCount","groupUnreadMessages"]),currentGroupUnreadMessagesCount(){return this.currentGroupId?this.groupUnreadMessages(this.currentGroupId):0},logo(){return`/assets/images/logo-transparent${this.colors.theme==="dark"?"-white":""}.png`},isInert(){return!this.ephemeral.isActive&&this.ephemeral.isTouch},notApprovedToGroupYet(){return this.$route.path==="/pending-approval"},isInGlobalDashboard(){return this.$route.path.startsWith("/global-dashboard")}},methods:{toggleMenu(){this.ephemeral.isActive=!this.ephemeral.isActive},openModal(e){c("okTurtles.events/emit",z,e)},checkIsTouch(){this.ephemeral.isTouch=window.innerWidth<1200},onMenuItemsClick(){this.ephemeral.isActive=!1}}},Pd=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("nav",{staticClass:"c-navigation",class:{"is-active":e.ephemeral.isActive},attrs:{"aria-label":e.L("Main"),"data-test":"navMenu"}},[o("toggle",{attrs:{element:"navigation","aria-expanded":e.ephemeral.isActive,"data-test":"NavigationToggleBtn"},on:{toggle:e.toggleMenu}},[e.totalUnreadNotificationCount?o("badge",{staticClass:"c-toggle-badge",attrs:{"data-test":"dashboardBadge"}},[e._v(e._s(e.totalUnreadNotificationCount))]):e.currentGroupUnreadMessagesCount?o("badge",{staticClass:"c-toggle-badge",attrs:{"data-test":"dashboardBadge"}},[e._v(e._s(e.currentGroupUnreadMessagesCount))]):e._e()],1),e.groupsByName.length>=1?o("groups-list",{attrs:{inert:e.isInert}}):e._e(),o("div",{staticClass:"c-navigation-wrapper",attrs:{inert:e.isInert}},[e.isInGlobalDashboard?[o("div",{staticClass:"c-navigation-header"},[o("i18n",{staticClass:"sr-only",attrs:{tag:"h1"}},[e._v("Global Dashboard Menu")]),o("img",{staticClass:"c-logo",attrs:{src:e.logo,alt:"GroupIncome's logo"}})],1),o("div",{staticClass:"c-navigation-body"},[o("div",{staticClass:"c-navigation-body-top"},[o("ul",{staticClass:"c-menu-list"},e._l(e.config.globalDashboard,function(r){return o("list-item",{key:r.id,attrs:{tag:"router-link",icon:r.icon,to:r.routeTo,"data-test":"global-dashboard_"+r.id}},[e._v(e._s(r.title))])}),1)])])]:[o("div",{staticClass:"c-navigation-header"},[o("i18n",{staticClass:"sr-only",attrs:{tag:"h1"}},[e._v("Main Menu")]),o("router-link",{attrs:{to:"/home"}},[o("img",{staticClass:"c-logo",attrs:{src:e.logo,alt:"GroupIncome's logo"}})]),e.notApprovedToGroupYet?e._e():o("notification-bell",{attrs:{"data-test":"notificationBell"}})],1),!e.notApprovedToGroupYet&&e.groupsByName.length?o("div",{staticClass:"c-navigation-body",on:{click:function(r){return r.stopPropagation(),e.onMenuItemsClick(r)}}},[o("div",{staticClass:"c-navigation-body-top"},[o("ul",{staticClass:"c-menu-list"},[o("list-item",{attrs:{tag:"router-link",icon:"columns",to:"/dashboard","data-test":"dashboard"}},[o("i18n",[e._v("Dashboard")])],1),o("list-item",{attrs:{tag:"router-link",icon:"chart-pie",to:"/contributions","data-test":"contributionsLink"}},[o("i18n",[e._v("Contributions")])],1),o("list-item",{attrs:{tag:"router-link",icon:"tag",to:"/payments","data-test":"paymentsLink"}},[o("i18n",[e._v("Payments")])],1),o("list-item",{attrs:{tag:"router-link",icon:"comments",to:"/group-chat",badgeCount:e.currentGroupUnreadMessagesCount,"data-test":"groupChatLink"}},[o("i18n",[e._v("Chat")])],1),o("list-item",{attrs:{tag:"router-link",icon:"cog",to:"/group-settings","data-test":"groupSettingsLink"}},[o("i18n",[e._v("Group Settings")])],1)],1),e.groupsByName.length<2?o("div",{staticClass:"c-navigation-separator"},[o("button",{staticClass:"is-small is-outlined",attrs:{"data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[o("i",{staticClass:"icon-plus is-prefix"}),o("i18n",[e._v("Add a group")])],1)]):e._e()]),o("div",{staticClass:"c-navigation-bottom"},[o("ul",{staticClass:"c-menu-list-bottom"},[o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.BLOG_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Blog")]),o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.COMMUNITY_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Help & Feedback")]),o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.DONATE_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Donate")])],1)])]):e._e()],e.showNav?o("div",{staticClass:"c-navigation-footer"},[o("profile")],1):e._e()],2)],1)},Md=[],Dd=function(e){e&&e("data-v-813981b2_0",{source:".c-navigation[data-v-813981b2]{display:flex;flex-direction:row;font-weight:400;background:var(--general_2)}.c-navigation-wrapper[data-v-813981b2]{display:flex;flex-direction:column;min-width:14.375rem;justify-content:space-between;height:100%}.c-navigation-header[data-v-813981b2]{display:flex;justify-content:space-between;align-items:center;flex-shrink:0;padding:0 1rem;height:4.6rem;margin-bottom:-.1rem}.c-navigation-body[data-v-813981b2]{display:flex;overflow:auto;-webkit-overflow-scrolling:touch;flex-direction:column;justify-content:space-between;flex-grow:1}.c-navigation-separator[data-v-813981b2]{text-align:center;margin:1.5rem 1.5rem 0 1.5rem;border-top:1px solid var(--general_0);padding-top:1.5rem}.c-navigation-bottom[data-v-813981b2]{padding-top:2rem;padding-bottom:.5rem}.c-navigation-footer[data-v-813981b2]{flex-shrink:0}.c-menu-list-bottom[data-v-813981b2]{display:flex;flex-direction:column;margin-left:1rem;font-size:.75rem}.c-menu-list-bottom a[data-v-813981b2]{line-height:1.65rem;color:var(--text_1)}.c-menu-list-bottom a[data-v-813981b2]:focus,.c-menu-list-bottom a[data-v-813981b2]:hover{color:var(--text_0);outline:0}.c-logo[data-v-813981b2]{min-width:8rem;width:8rem}.c-toggle[data-v-813981b2]{left:100%}",map:void 0,media:void 0})},Gd="data-v-813981b2",Fd=void 0,Ud=!1;function $d(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Gr(){let e=Gr.styles||(Gr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var jd=$d({render:Pd,staticRenderFns:Md},Dd,Ld,Gd,Ud,Fd,!1,Gr,void 0,void 0),Zs=jd;var ta=he(ea());var Bd=["primary","warning","danger","success"],Ur=Zt.light;c("sbp/selectors/register",{"gi.utils/avatar/create":function(){let e,t;try{let o=Yn(Bd);e=ta.default.create({bgcolor:Ur[`${o}_0`],color:Ur[`${o}_1`],spotcolor:Ur[`${o}_2`],size:6,scale:12}).toDataURL("image/png"),t=$i(e)}catch(o){return console.warn("utils/avatar.js Avatar generation process didn't go well.",o),null}return t}});var ia=he(Br());Z();var ra=he(Br());Z();var zr={ALLOWED_ATTR:["class"],ALLOWED_TAGS:["b","br","em","i","p","small","span","strong","sub","sup","u","s","code","ul","li","pre","blockquote","del"],RETURN_DOM_FRAGMENT:!0},oa=(e,t)=>{if(t.oldValue!==t.value){let o=zr,r={a:["href","target"],button:["type"]};Object.keys(r).includes(t.arg)&&(o=Y(o),o.ALLOWED_TAGS.push(t.arg),o.ALLOWED_ATTR.push(...r[t.arg]||[])),e.textContent="",e.appendChild(ra.default.sanitize(t.value,o))}};I.directive("safe-html",{bind:oa,update:oa});I.prototype.L=b;I.prototype.LTags=Se;var zd={...zr,ALLOWED_ATTR:["class","href","rel","target"],ALLOWED_TAGS:["a","b","br","button","em","i","p","small","span","strong","sub","sup","u"],RETURN_DOM_FRAGMENT:!1};function na(e){return ia.default.sanitize(e,zd)}I.component("i18n",{functional:!0,props:{args:[Object,Array],tag:{type:String,default:"span"},compile:Boolean},render:function(e,t){let o=t.children[0].text,r=b(o,t.props.args||{});return r?(t.props.tag==="a"&&t.data.attrs.target==="_blank"&&(t.data.attrs.rel="noopener noreferrer"),t.props.compile?I.compile("<wrap>"+na(r)+"</wrap>").render.call({_c:(a,...n)=>a==="wrap"?e(t.props.tag,t.data,...n):e(a,...n),_v:a=>a}):(t.data.domProps||(t.data.domProps={}),t.data.domProps.innerHTML=na(r),e(t.props.tag,t.data))):(console.warn("The following i18n text was not translated correctly:",o),e(t.props.tag,t.data,o))}});Z();I.directive("error",{inserted(e,t,o){if(!t.arg)throw new Error(`v-error: missing argument on ${e.outerHTML}`);if(!o.context.$v.form[t.arg])throw new Error(`v-error: vuelidate doesn't have validation for ${t.arg}`);let r=t.value||{},s=document.createElement(r.tag||"span");for(let a in r.attrs)s.setAttribute(a,r.attrs[a]);s.classList.add("error","is-hidden"),e.insertAdjacentElement("afterend",s)},update(e,t,o){if(o.context.$v.form[t.arg].$error){for(let r in o.context.$v.form[t.arg].$params)if(!o.context.$v.form[t.arg][r]){e.nextElementSibling.innerText=r;break}e.nextElementSibling.classList.remove("is-hidden")}else e.nextElementSibling.classList.add("is-hidden")},unbind(e){e.nextElementSibling.remove()}});Z();I.directive("focus",{inserted:(e,t)=>{(!t||t.value!==!1)&&e.focus()}});var sa={fetch:typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",streams:typeof ReadableStream=="function",webSocket:typeof WebSocket=="function",reflect:typeof Reflect=="object",serviceWorker:typeof Navigator=="function"&&typeof navigator=="object"&&navigator instanceof Navigator&&typeof navigator=="object"&&typeof ServiceWorkerContainer=="function"&&navigator.serviceWorker instanceof ServiceWorkerContainer,indexedDB:typeof IDBFactory=="function"&&typeof indexedDB=="object"&&indexedDB instanceof IDBFactory,sessionStorage:typeof Storage=="function"&&typeof sessionStorage=="object"&&sessionStorage instanceof Storage};console.info("Feature check",sa);var Hd=Object.values(sa).every(Boolean),Hr=Hd;Z();var Wr,ct={MIN1:"1MIN",MIN5:"5MIN",MIN15:"15MIN",MIN30:"30MIN"},te={notifications:[],partition:Object.create(null)},Wd={[ct.MIN1]:1*It,[ct.MIN5]:5*It,[ct.MIN15]:15*It,[ct.MIN30]:30*It},Vd=_i({stateKey:e=>{if(e=yi(e),e.length===0)throw new TypeError("Empty notification data state key");return e},emitCondition:Qt,emit:Qt,shouldClearStateKey:Qt});async function aa(){let e=c("state/vuex/state"),t=c("state/vuex/getters"),o=e.periodicNotificationAlreadyFiredMap.alreadyFired,r=e.periodicNotificationAlreadyFiredMap.lastRun,s=(l,m)=>l.call(te.partition[m],{rootState:e,rootGetters:t});if(te.clearTimeout)return;let a=!1,n=()=>{a=!0};te.clearTimeout=n,await Promise.all(Object.entries(c("okTurtles.eventQueue/queuedInvocations")).map(([l,m])=>!!m.length&&c("okTurtles.eventQueue/queueEvent",l,()=>{}).catch(()=>{})));for(let l of te.notifications){if(a)break;let m=l.stateKey,p=r[m]||0,i=l.delay;if(Date.now()-p>=i){try{!o[m]&&s(l.emitCondition,m)&&(await s(l.emit,m),o[m]=!0),o[m]&&s(l.shouldClearStateKey,m)&&delete o[m]}catch(u){console.error("runNotificationListRecursive: Error calling notification",m,u)}r[m]=Date.now()}}te.clearTimeout===n&&(te.clearTimeout=(()=>{let l=setTimeout(()=>{delete te.clearTimeout,aa()},Wr);return()=>clearTimeout(l)})())}function qd(){te.clearTimeout&&(te.clearTimeout(),delete te.clearTimeout),te.notifications.forEach(({stateKey:e})=>{te.partition[e]=Object.create(null)})}c("sbp/selectors/register",{"gi.periodicNotifications/init":function(){return aa().catch(e=>{console.error("[gi.periodicNotifications/init] Error",e)})},"gi.periodicNotifications/clearStatesAndStopTimers":function(){let e=c("state/vuex/state");e.periodicNotificationAlreadyFiredMap={alreadyFired:Object.create(null),lastRun:Object.create(null)},qd()},"gi.periodicNotifications/importNotifications":function(e){let t=new Set;for(let{type:o,notificationData:r}of e){if(!o||!r)throw new Error("A required field in a periodic notification entry is missing.");let s=Wd[o];if(!s)throw new RangeError("Invalid delay");if(Wr<=s||(Wr=s),Vd(r),t.has(r.stateKey))throw new Error("Duplicate periodic notification state key: "+r.stateKey);t.add(r.stateKey),te.partition[r.stateKey]=Object.create(null),te.notifications.push({...r,delay:s})}}});var Kd=(e,t="")=>(t?c("state/vuex/getters").notificationsByGroup(t):c("state/vuex/getters").currentNotifications).some(r=>e(r)),Jd=[{name:"INCOME_DETAILS_OLD",emitCondition({rootGetters:e}){let{incomeDetailsLastUpdatedDate:t}=e.ourGroupProfile||{},o=Yt(new Date);return t&&hi(o,t)>6*di&&!Kd(r=>r.type==="INCOME_DETAILS_OLD"&&r.data.lastUpdatedDate===t)},emit({rootGetters:e}){c("gi.notifications/emit","INCOME_DETAILS_OLD",{months:6,lastUpdatedDate:e.ourGroupProfile.incomeDetailsLastUpdatedDate})}}],Xd=[{type:ct.MIN30,notificationData:{stateKey:"username-fetch",emitCondition:()=>!0,emit({rootState:e,rootGetters:t}){Object.values(t.ourContactProfilesById).filter(({username:o,contractID:r})=>!o&&!!e[r]?.attributes?.username).forEach(({contractID:o})=>{let r=e[o].attributes.username;c("namespace/lookup",r,{skipCache:!0}).then(s=>{s!==o&&console.error(`[periodic notification] Mismatched username. The lookup result was ${s} instead of ${o}`)}).catch(s=>{console.error("[periodic notification] Error looking up username",r,"for",o,s)})})},shouldClearStateKey:()=>!0}}],Yd={methods:{initOrResetPeriodicNotifications(){c("gi.periodicNotifications/clearStatesAndStopTimers"),c("gi.periodicNotifications/init")},async checkAndEmitOneTimeNotifications(){let e={rootState:c("state/vuex/state"),rootGetters:c("state/vuex/getters")};for(let t of Jd)t.emitCondition(e)&&await t.emit(e)}},mounted(){c("gi.periodicNotifications/importNotifications",Xd)}},ca=Yd;var lt=null,Rt=null,ze,Nt=null,Le={},He=Math.ceil(window.devicePixelRatio)||1,ut=16*He,Vr={width:8,height:8,background:"#ff0000",crossOrigin:!0},Qd=()=>{let e=document.getElementsByTagName("link");for(let t=0,o=e.length;t<o;t++)if((e[t].getAttribute("rel")||"").match(/\bicon\b/i))return e[t];return null},Zd=()=>{let e=document.getElementsByTagName("link");for(let t=0,o=e.length;t<o;t++)typeof e[t]<"u"&&(e[t].getAttribute("rel")||"").match(/\bicon\b/i)&&e[t].parentNode?.removeChild(e[t])},ep=()=>((!Rt||!lt)&&(lt=Qd()?.getAttribute("href")||"/assets/images/group-income-icon-transparent.png",Rt||(Rt=lt)),lt),qr=()=>(Nt||(Nt=document.createElement("canvas"),Nt.width=ut,Nt.height=ut),Nt),la=e=>{if(e){Zd();let t=document.createElement("link");t.type="image/x-icon",t.rel="icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},tp=e=>{let t=qr().getContext("2d"),o=ep();ze=document.createElement("img"),ze.onload=function(){t.clearRect(0,0,ut,ut),t.drawImage(ze,0,0,ze?.width,ze?.height,0,0,ut,ut),e&&op(t),ua()},!o?.match(/^data/)&&Le.crossOrigin&&(ze.crossOrigin="anonymous"),ze.src=o},op=e=>{let t=Le.width*He+6*He,o=Le.height*He,r=16*He,s=16*He,a=Math.min(t,o)/2;e.fillStyle=Le.background,e.strokeStyle=Le.background,e.lineWidth=He,e.arc(s-a,r-a,a,0,2*Math.PI),e.fill()},ua=()=>{qr()instanceof HTMLCanvasElement&&la(qr().toDataURL())},da={setOptions:function(e){Le={};for(let t in Vr)Le[t]=e[t]||Vr[t]},setImage:function(e){lt=e,ua()},setBubble:function(e){tp(e)},reset:function(){lt=Rt,la(Rt)}};Object.keys(Le).length||da.setOptions(Vr);var pa=da;Z();var va=he(ga());"ontouchstart"in window||"msMaxTouchPoints"in navigator?import("./vue2-touch-events-JB3IBENJ-cached.js").then(e=>I.use(e.default)):I.directive("touch",{});I.use(va.default);Z();I.component("v-style",{render:function(e){return e("style",this.$slots.default)}});console.info("GI_VERSION:","2.0.4");console.info("GI_GIT_VERSION:","v2.0.4");console.info("CONTRACTS_VERSION:","2.0.3");console.info("LIGHTWEIGHT_CLIENT:","true");console.info("NODE_ENV:","production");c("okTurtles.data/set","API_URL",self.location.origin);I.config.errorHandler=function(e,t,o){console.error(`uncaught Vue error in ${o}:`,e)};async function yp(){let e=new URLSearchParams(window.location.search).get("debug");if(e==="true"){let s=(l,m)=>(l[m]=!0,l),a=["sbp","okTurtles.data"].reduce(s,{}),n=["chelonia.db/get","chelonia.db/set","chelonia/rootState","chelonia/haveSecretKey","chelonia/private/enqueuePostSyncOps","chelonia/private/invoke","state/vuex/state","state/vuex/getters","state/vuex/settings","gi.db/settings/save"].reduce(s,{});c("sbp/filters/global/add",(l,m,p)=>{a[l]||n[m]||console.debug(`[sbp] ${m}`,p)}),c("sbp/filters/selector/add","gi.db/settings/save",(l,m,p)=>{console.debug("[sbp] 'gi.db/settings/save'",p[0])})}c("chelonia/externalStateSetup",{stateSelector:"state/vuex/state",reactiveSet:I.set,reactiveDel:I.delete}),c("okTurtles.events/on",Fn,({name:s,value:a,deletedValue:n})=>{let l=c("state/vuex/state").namespaceLookups,m=c("state/vuex/state").reverseNamespaceLookups;n?(I.delete(l,s),m[n]===s&&I.delete(m,n)):(I.set(l,s,a),I.set(m,a,s))}),c("okTurtles.events/on",Wn,(s,{contractID:a})=>{if(console.error("Serious error",a,s),c("gi.ui/seriousErrorBanner",s),s?.name==="ChelErrorForkedChain"){let n=c("state/vuex/state");if(!n.contracts[a]){console.error("Forked chain detected. However, there is no contract entry.",{contractID:a},s);return}let l=n.contracts[a].type||"(unknown)";console.error("Forked chain detected",{contractID:a,type:l},s),confirm(b(`The server's history for '{type}' has diverged from ours. This can happen in extremely rare circumstances due to either malicious activity or a bug.

To fix this, the contract needs to be resynced, and some recent events may be missing. Would you like to do so now?

(If problems persist, please open the Troubleshooting page under the User Settings and resync all contracts.)`,{type:l}))&&(c("gi.ui/clearBanner"),(n.loggedIn?.identityContractID===a?c("gi.actions/identity/logout",null,!0):c("chelonia/contract/sync",a,{resync:!0})).catch(p=>{console.error("Error during re-sync",a,p),alert(b(`There was a problem resyncing the contract: {errMsg}

Please see the Application Logs under User Settings for more details. The Troubleshooting page in User Settings may be another way to fix the problem.`,{errMsg:p?.message||p}))}))}}),(window.Cypress||e)&&(window.sbp=c);let t={ephemeral:{debouncedSyncBanner(){},syncs:[]}},o=function(s,a){a?(this.ephemeral.syncs.push(s),this.ephemeral.debouncedSyncBanner()):this.ephemeral.syncs.includes(s)&&(this.ephemeral.syncs=this.ephemeral.syncs.filter(n=>n!==s))},r=o.bind(t);try{await c("translations/init",navigator.language)}catch(s){let a=`Fatal error while initializing Group Income: ${s.name} - ${s.message}

Please report this bug here: ${qt.ISSUE_PAGE}`;console.error(a,s),alert(a);return}Hr&&await Promise.race([c("service-worker/setup"),new Promise((s,a)=>{setTimeout(()=>{a(new Error("Timed out setting up service worker"))},8e3)})]).catch(s=>{throw console.error("[main] Error setting up service worker",s),alert(b("Error while setting up service worker: {err}",{err:s.message})),window.location.reload(),s}),new I({router:_o,mixins:[ca,to],components:{AppStyles:Ws,BackgroundSounds:Ks,BannerGeneral:Vs,Navigation:Zs,Modal:qs},data(){return{ephemeral:{syncs:[],finishedLogin:"no",debouncedSyncBanner:null,isCorrupted:!1,ready:!1}}},created(){c("okTurtles.events/on",Vt,s=>{this.ephemeral.syncs=s})},mounted(){let s=null;((window.matchMedia("(prefers-reduced-motion: reduce)")||{}).matches||this.isInCypress)&&this.setReducedMotion(!0);let{bannerGeneral:n}=this.$refs;if(c("okTurtles.data/set","BANNER",n),!Hr){this.removeLoadingAnimation(),c("gi.ui/prompt",{heading:b("Unsupported browser"),question:b("This browser doesn't support all features required to use Group Income. Please try a different browser.")});return}this.ephemeral.debouncedSyncBanner=n.debouncedShow({message:()=>b("Loading events from server..."),icon:"wifi",seconds:2,clearWhen:()=>!this.ephemeral.syncs.length}),this.ephemeral.syncs=t.ephemeral.syncs,this.ephemeral.syncs.length&&this.ephemeral.debouncedSyncBanner(),c("okTurtles.events/off",Jo,r),c("okTurtles.events/on",Jo,o.bind(this)),c("okTurtles.events/on",Ie,()=>{if(Zn(),!c("state/vuex/state").loggedIn){console.warn("Received LOGIN_COMPLETE event but there state.loggedIn is not an object");return}this.ephemeral.finishedLogin="yes",this.$store.state.currentGroupId&&(this.initOrResetPeriodicNotifications(),this.checkAndEmitOneTimeNotifications()),I.use(ba.default,{store:ae,idleTime:2*60*1e3})}),c("okTurtles.events/on",Ze,()=>{let l=c("state/vuex/state");l.loggedIn&&(this.ephemeral.finishedLogin="no",c("gi.periodicNotifications/clearStatesAndStopTimers"),c("gi.db/settings/delete",l.loggedIn.identityContractID).catch(m=>{console.error("Logout event: error deleting settings")}),c("state/vuex/reset"),_o.currentRoute.path!=="/"&&_o.push({path:"/"}).catch(console.error))}),c("okTurtles.events/once",Pe,()=>{this.removeLoadingAnimation()}),c("okTurtles.events/on",Ht,({contractID:l,isNewlyCreated:m})=>{this.initOrResetPeriodicNotifications(),this.checkAndEmitOneTimeNotifications()}),c("okTurtles.events/on",Tn,()=>{c("state/vuex/state").loggedIn&&c("service-worker/setup-push-subscription").catch(m=>{console.error("came back online, tried to report push subscription, but got:",m)}),c("gi.ui/clearBanner")}),c("okTurtles.events/on",Ho,()=>{c("gi.ui/showBanner",b("Your device appears to be offline."),"wifi")}),c("okTurtles.events/on",Cn,()=>{c("gi.ui/showBanner",b("Trying to reconnect..."),"wifi")}),c("okTurtles.events/on",En,()=>{c("gi.ui/showBanner",b("We could not connect to the server. Please refresh the page."),"wifi")}),c("okTurtles.events/on",An,({contractID:l,key:m,data:p})=>{switch(m){case yt.LAST_LOGGED_IN:{c("state/vuex/commit","setLastLoggedIn",[l,p]);break}case yt.UNREAD_MESSAGES:c("state/vuex/commit","setUnreadMessages",p);break;case yt.PREFERENCES:c("state/vuex/commit","setPreferences",p);break;case yt.NOTIFICATIONS:c("state/vuex/commit","setNotificationStatus",p);break}}),navigator.onLine===!1&&c("okTurtles.events/emit",Ho),this.ephemeral.isCorrupted&&c("gi.ui/dangerBanner",b("Your app seems to be corrupted. Please {a_}re-sync your app data.{_a}",{a_:`<a class="link" href="${window.location.pathname}?modal=UserSettingsModal&tab=troubleshooting">`,_a:"</a>"}),"times-circle"),c("okTurtles.events/emit",vt,this.$store.state.settings.themeColor),this.setBadgeOnTab(),(async()=>{try{let l=await c("gi.db/settings/load",ps);if(s=l,l&&this.ephemeral.finishedLogin!=="yes"){let m=c("okTurtles.events/once",z,()=>{this.removeLoadingAnimation()});await c("gi.app/identity/login",{identityContractID:l}),m(),await c("chelonia/contract/wait",l)}this.ephemeral.ready=!0,this.removeLoadingAnimation()}catch(l){this.removeLoadingAnimation(),s&&c("appLogs/clearLogs",s).catch(m=>{console.error("[main] Error clearing logs for old session",s,m)}),console.error(`[main] caught ${l?.name} while fetching settings or handling a login error: ${l?.message||l}`,l),await c("gi.app/identity/logout"),await c("gi.ui/prompt",{heading:b("Failed to login"),question:b("Error details: {reportError}",Ye(l)),primaryButton:b("Close")})}})()},computed:{...H(["groupsByName","ourUnreadMessages","totalUnreadNotificationCount"]),...re(["contracts"]),ourUnreadMessagesCount(){return Object.keys(this.ourUnreadMessages).map(s=>this.ourUnreadMessages[s].unreadMessages.length).reduce((s,a)=>s+a,0)},shouldSetBadge(){return this.ourUnreadMessagesCount+this.totalUnreadNotificationCount>0},appClasses(){return{"l-with-navigation":this.showNav,"l-no-navigation":!this.showNav,"js-reducedMotion":this.$store.state.settings.reducedMotion,"is-dark-theme":this.$store.getters.isDarkTheme}},isInCypress(){return!!window.Cypress}},methods:{...ei(["setReducedMotion"]),setBadgeOnTab(){pa.setBubble(this.shouldSetBadge)},removeLoadingAnimation(){let s=document.querySelector("#main-loading-screen");s&&s.remove()}},watch:{shouldSetBadge(s,a){this.setBadgeOnTab()}},store:ae}).$mount("#app")}yp();
/*!
 * FaviconBadge - A small library for manipulating the Favicon
 * Modified from Tinycon.js by Tom Moor
 * Original project: https://github.com/tommoor/tinycon
 * Copyright (c) 2023 Alex Jin
 * @license MIT Licensed
 */
/*! Bundled license information:

dompurify/dist/purify.js:
  (*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.2.2/LICENSE *)

portal-vue/dist/portal-vue.common.js:
  (*! 
   * portal-vue  Thorsten Lnborg, 2019 
   * 
   * Version: 2.1.7
   * 
   * LICENCE: MIT 
   * 
   * https://github.com/linusborg/portal-vue
   * 
  *)
*/
//# sourceMappingURL=main.js.map
