import{a as A}from"./chunk-LIW6QCF4-cached.js";import{a as I}from"./chunk-WMVHT3GJ-cached.js";import{a as S}from"./chunk-XHZPFS4B-cached.js";import{c as N}from"./chunk-6P74MMKF-cached.js";import"./chunk-VUYUNB2W-cached.js";import{H as R,I as L,Q as P,R as c}from"./chunk-SZPI64OI-cached.js";import{b as D}from"./chunk-R4DRX7L2-cached.js";import{a as E}from"./chunk-FTWBMR5D-cached.js";import{a as $}from"./chunk-GA3LN23N-cached.js";import"./chunk-3VFZYJBQ-cached.js";import"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import"./chunk-TEH4GFTX-cached.js";import{b as o,c as g}from"./chunk-QVCKPSEU-cached.js";import{a as C}from"./chunk-OMOH7TRL-cached.js";import{b as y,d as x}from"./chunk-WBBXU2FL-cached.js";import{e as b}from"./chunk-XMZXE55N-cached.js";var T=b(E());var w=b(D());var h={[c.GROUP]:{label:o("Group channel"),description:o("All group members will be able to see or join this channel."),icon:"hashtag"},[c.PRIVATE]:{label:o("Private channel"),description:o("Only added members will have access."),icon:"lock"},[c.PUBLIC]:{label:o("Public channel"),description:o("People from outside the group can see the channel's content"),icon:"unlock-alt"}},M={name:"CreateNewChannelModal",mixins:[T.validationMixin,S],components:{ModalTemplate:$,BannerScoped:N,ButtonSubmit:I,CharLengthIndicator:A},computed:{...y(["currentGroupId"]),...x(["groupSettings","groupChatRooms"]),maxNameCharacters(){return R},maxDescriptionCharacters(){return L},isPublicChannelCreateAllowed(){return this.groupSettings.allowPublicChannels},privacyLevels(){return Object.values(c).map(e=>({value:e,label:h[e].label}))},privacyLevel(){return this.isPublicChannelCreateAllowed?this.form.privacy:this.form.private?c.PRIVATE:c.GROUP},privacyLevelDescription(){return h[this.privacyLevel].description},privacyLevelIcon(){return h[this.privacyLevel].icon}},data(){return{form:{name:"",description:"",private:!1,privacy:"",existingNames:[]}}},created(){this.form.existingNames=Object.keys(this.groupChatRooms).map(e=>this.groupChatRooms[e].name)},mounted(){this.$refs.name.focus()},methods:{close(){this.$refs.modal.close()},async submit(){let{name:e,description:i}=this.form;try{await C("gi.app/group/addAndJoinChatRoom",{contractID:this.currentGroupId,data:{attributes:{name:e,description:i,privacyLevel:this.privacyLevel,type:P.GROUP}}}),this.close()}catch(t){this.$refs.formMsg.danger(o("Failed to create chat channel. {reportError}",g(t)))}},toggleChannelPrivate(e){this.form.private=e.target.checked},handlePrivacyLevel(e){this.form.privacy=e.target.value}},validations:{form:{name:{[o("This field is required")]:w.default,[o("Reached character limit.")]:function(e){return e?Number(e.length)<=this.maxNameCharacters:!1},[o("Duplicate channel name")]:(e,i)=>{for(let t of i.existingNames)if(e.toUpperCase()===t.toUpperCase())return!1;return!0}},description:{[o("Reached character limit.")]:function(e){return!e||Number(e.length)<=this.maxDescriptionCharacters}},privacy:{[o("This field is required")]:function(e){return!this.isPublicChannelCreateAllowed||!!e}}}},watch:{"form.name"(e,i){e.length&&(this.form.name=e.replaceAll(/\s/g,"-").toLowerCase())}}},k=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("modal-template",{ref:"modal",attrs:{a11yTitle:e.L("Create a channel")}},[t("template",{slot:"title"},[t("i18n",[e._v("Create a channel")])],1),t("form",{attrs:{novalidate:"novalidate","data-test":"createChannel"},on:{submit:function(n){n.preventDefault()}}},[t("label",{staticClass:"field"},[t("div",{staticClass:"c-name-label-container"},[t("i18n",{staticClass:"label c-label-name"},[e._v("Name")]),e.form.name?t("char-length-indicator",{attrs:{"current-length":e.form.name.length||0,max:e.maxNameCharacters}}):e._e()],1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"},{name:"error",rawName:"v-error:name",arg:"name"}],ref:"name",staticClass:"input",class:{error:e.$v.form.name.$error},attrs:{type:"text",name:"name",maxlength:"50","data-test":"createChannelName"},domProps:{value:e.form.name},on:{input:[function(n){n.target.composing||e.$set(e.form,"name",n.target.value)},function(n){return e.debounceField("name")}],blur:function(n){return e.updateField("name")}}})]),t("label",{staticClass:"field"},[t("div",{staticClass:"c-desc-label-container"},[t("i18n",{staticClass:"label"},[e._v("Description")]),e.form.description?t("char-length-indicator",{attrs:{"current-length":e.form.description.length||0,max:e.maxDescriptionCharacters,error:e.$v.form.description.$error}}):e._e()],1),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.description,expression:"form.description"},{name:"error",rawName:"v-error:description",arg:"description"}],staticClass:"textarea",class:{error:e.$v.form.description.$error},attrs:{name:"description",placeholder:e.L("Description of the channel"),maxlength:e.maxDescriptionCharacters,"data-test":"createChannelDescription"},domProps:{value:e.form.description},on:{input:[function(n){n.target.composing||e.$set(e.form,"description",n.target.value)},function(n){return e.debounceField("description")}],blur:function(n){return e.updateField("description")}}}),t("i18n",{staticClass:"helper"},[e._v("This is optional.")])],1),e.isPublicChannelCreateAllowed?t("label",{staticClass:"field"},[t("i18n",{staticClass:"label"},[e._v("Channel Privacy")]),t("div",{staticClass:"selectbox",class:{error:e.$v.form.privacy.$error}},[t("select",{staticClass:"select",attrs:{"aria-label":e.L("Please select"),name:"privacy","data-test":"createChannelPrivacyLevel"},domProps:{value:e.form.privacy},on:{change:e.handlePrivacyLevel,blur:function(n){return e.updateField("privacy")}}},[t("option",{staticClass:"placeholder",attrs:{value:"",disabled:"disabled"}},[e._v(e._s(e.L("Please select")))]),e._l(e.privacyLevels,function(n,s){return t("option",{key:s,domProps:{value:n.value}},[e._v(e._s(n.label))])})],2)])],1):t("label",{staticClass:"c-inline-input"},[t("i18n",{staticClass:"label"},[e._v("Private channel")]),t("input",{staticClass:"switch",attrs:{type:"checkbox","data-test":"createChannelPrivate"},domProps:{checked:e.form.private},on:{change:e.toggleChannelPrivate}})],1),e.privacyLevel?t("hr"):e._e(),e.privacyLevel?t("div",{staticClass:"c-helper"},[t("i",{class:"icon-"+e.privacyLevelIcon+" c-group-i"}),t("div",{staticClass:"helper",attrs:{tag:"p"}},[e._v(e._s(e.privacyLevelDescription))])]):e._e(),t("banner-scoped",{ref:"formMsg",attrs:{allowA:!0}}),t("div",{staticClass:"buttons"},[t("i18n",{staticClass:"button is-outlined",on:{click:e.close}},[e._v("Cancel")]),t("button-submit",{staticClass:"is-success",attrs:{"data-test":"createChannelSubmit",disabled:e.$v.form.$invalid},on:{click:e.submit}},[t("i18n",[e._v("Create channel")])],1)],1)],1)],2)},j=[],U=function(e){e&&e("data-v-8fb4e2c2_0",{source:".c-desc-label-container[data-v-8fb4e2c2],.c-name-label-container[data-v-8fb4e2c2]{display:flex;justify-content:space-between;align-items:center}.c-label-name[data-v-8fb4e2c2]{float:left}.c-max-count[data-v-8fb4e2c2]{float:right;color:var(--text_1)}.c-inline-input[data-v-8fb4e2c2]{display:flex;justify-content:space-between}hr[data-v-8fb4e2c2]{background-color:var(--general_0);margin:1rem 0;height:1px}.helper[data-v-8fb4e2c2]{color:var(--text_1)}.c-helper[data-v-8fb4e2c2]{display:flex}.c-group-i[data-v-8fb4e2c2]{margin-right:.5rem}.select option.placeholder[data-v-8fb4e2c2]{display:none}",map:void 0,media:void 0})},F="data-v-8fb4e2c2",G=void 0,B=!1;function H(e,i,t,n,s,p,r,d,m,u){let a=(typeof t=="function"?t.options:t)||{};a.__file=`style>
`,a.render||(a.render=e.render,a.staticRenderFns=e.staticRenderFns,a._compiled=!0,s&&(a.functional=!0)),a._scopeId=n;{let f;if(i&&(f=r?function(l){i.call(this,u(l,this.$root.$options.shadowRoot))}:function(l){i.call(this,d(l))}),f!==void 0)if(a.functional){let l=a.render;a.render=function(O,_){return f.call(_),l(O,_)}}else{let l=a.beforeCreate;a.beforeCreate=l?[].concat(l,f):[f]}}return a}function v(){let e=v.styles||(v.styles={}),i=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(n,s){if(document.querySelector('style[data-vue-ssr-id~="'+n+'"]'))return;let p=i?s.media||"default":n,r=e[p]||(e[p]={ids:[],parts:[],element:void 0});if(!r.ids.includes(n)){let d=s.source,m=r.ids.length;if(r.ids.push(n),s.map&&(d+=`
/*# sourceURL=`+s.map.sources[0]+" */",d+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),i&&(r.element=r.element||document.querySelector("style[data-group="+p+"]")),!r.element){let u=document.head||document.getElementsByTagName("head")[0],a=r.element=document.createElement("style");a.type="text/css",s.media&&a.setAttribute("media",s.media),i&&(a.setAttribute("data-group",p),a.setAttribute("data-next-index","0")),u.appendChild(a)}if(i&&(m=parseInt(r.element.getAttribute("data-next-index")),r.element.setAttribute("data-next-index",m+1)),r.element.styleSheet)r.parts.push(d),r.element.styleSheet.cssText=r.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(d),a=r.element.childNodes;a[m]&&r.element.removeChild(a[m]),a.length?r.element.insertBefore(u,a[m]):r.element.appendChild(u)}}}}var V=H({render:k,staticRenderFns:j},U,M,F,B,G,!1,v,void 0,void 0),te=V;export{te as default};
//# sourceMappingURL=CreateNewChannelModal-5G266KDW-cached.js.map
