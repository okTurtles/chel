import{a as M}from"./chunk-LUHQ5IUR-cached.js";import{a as S}from"./chunk-EDZL4VNV-cached.js";import"./chunk-GEXW5JDJ-cached.js";import{d as I}from"./chunk-OYX4NVDU-cached.js";import"./chunk-MMWHE4QG-cached.js";import"./chunk-FRTBM6HW-cached.js";import{k as C,m as D}from"./chunk-3V7YD6RE-cached.js";import"./chunk-KRTYB7RO-cached.js";import{b as g}from"./chunk-VUYUNB2W-cached.js";import"./chunk-SZPI64OI-cached.js";import{a as P}from"./chunk-BZWIYGWR-cached.js";import"./chunk-SVSS5DEP-cached.js";import"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import{v as h,w as f,x as v}from"./chunk-M3EDVPDK-cached.js";import{b as _}from"./chunk-33M5GGRR-cached.js";import{a as p}from"./chunk-OMOH7TRL-cached.js";import{d as x}from"./chunk-WBBXU2FL-cached.js";import"./chunk-XMZXE55N-cached.js";var w={name:"PaymentDetail",components:{ModalTemplate:P,LinkToCopy:S},mixins:[M],created(){this.initializeDetails()},data:()=>({payment:null}),props:{lightningPayment:{type:Object,required:!1}},computed:{...x(["ourIdentityContractId","userDisplayNameFromID"]),withCurrency(){return I[this.payment.data.currencyFromTo[1]].displayWithCurrency},fromMemberID(){return this.payment?.data.fromMemberID||""},isPaidByMyself(){return this.fromMemberID===this.ourIdentityContractId},buttonCount(){return+!this.isPaidByMyself+Number(this.isPaidByMyself&&!this.payment.isOldPayment)},subtitleCopy(){let t=this.payment.data.toMemberID,i=e=>({name:this.userDisplayNameFromID(e)});return t===this.ourIdentityContractId?_("Sent by {name}",i(this.fromMemberID)):_("Sent to {name}",i(t))}},methods:{humanDate:D,async initializeDetails(){let{id:t,period:i}=this.$route.query,e=this.lightningPayment||this.currentGroupState.payments[t]||(await this.getHistoricalPaymentDetailsByPeriod(i))[t];if(t&&p("okTurtles.events/emit",v,"PaymentDetail",{id:t}),e){let s=await this.historicalPeriodStampGivenDate(e.meta.createdDate);this.payment={...g(e),isOldPayment:C(s,this.currentPaymentPeriod)<0,periodstamp:s}}else console.warn('PaymentDetail: Missing valid query "id"'),p("okTurtles.events/emit",h)},closeModal(){this.$refs.modal.close()},cancelPayment(){alert("TODO: Implement cancel payment")},sendThankYou(){p("okTurtles.events/emit",f,"SendThankYouModal",{toMemberID:this.payment.data.fromMemberID})}},validations:{form:{}}},R=function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.payment?e("modal-template",{ref:"modal",attrs:{a11yTitle:t.L("Payment details")}},[e("template",{slot:"title"},[e("i18n",[t._v("Payment details")])],1),e("div",{staticClass:"is-title-2 c-title",attrs:{"data-test":"amount"}},[t._v(t._s(t.withCurrency(t.payment.data.amount)))]),e("div",{staticClass:"c-subtitle has-text-1",attrs:{"data-test":"subtitle"}},[t._v(t._s(t.subtitleCopy))]),e("ul",{staticClass:"c-payment-list",attrs:{"data-test":"details"}},[e("li",{staticClass:"c-payment-list-item"},[e("i18n",{staticClass:"has-text-1",attrs:{tag:"label"}},[t._v("Date & Time")]),e("strong",[t._v(t._s(t.humanDate(t.payment.meta.createdDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})))])],1),e("li",{staticClass:"c-payment-list-item"},[e("i18n",{staticClass:"has-text-1"},[t._v("Relative to")]),e("strong",[t._v(t._s(t.humanDate(t.payment.periodstamp,{month:"long",year:"numeric",day:"numeric"})))])],1),e("li",{staticClass:"c-payment-list-item"},[e("i18n",{staticClass:"has-text-1"},[t._v("Mincome at the time")]),e("strong",[t._v(t._s(t.withCurrency(t.payment.data.groupMincome)))])],1),t.lightningPayment?e("li",{staticClass:"c-payment-list-item"},[e("i18n",{staticClass:"has-text-1"},[t._v("Transaction ID")]),e("link-to-copy",{staticClass:"c-lightning-trxn-id",attrs:{link:t.payment.data.transactionId}})],1):t._e(),t.payment.data.memo?e("li",{staticClass:"c-payment-list-item c-column"},[e("i18n",{staticClass:"has-text-1"},[t._v("Notes")]),e("p",{staticClass:"has-text-bold"},[t._v(t._s(t.payment.data.memo))])],1):t._e()]),!t.lightningPayment&&t.buttonCount>0?e("div",{staticClass:"buttons c-buttons-container",class:{"is-centered":t.buttonCount===1}},[t.isPaidByMyself&&!t.payment.isOldPayment?e("i18n",{staticClass:"button is-outlined",attrs:{tag:"button"},on:{click:t.cancelPayment}},[t._v("Cancel payment")]):t._e(),t.isPaidByMyself?t._e():e("i18n",{staticClass:"button",attrs:{tag:"button"},on:{click:t.sendThankYou}},[t._v("Send Thanks!")])],1):t._e()],2):t._e()},k=[],E=function(t){t&&t("data-v-8bbab42a_0",{source:".c-payment-list[data-v-8bbab42a]{margin:1rem auto .5rem auto;width:100%;max-width:25rem}.c-subtitle[data-v-8bbab42a],.c-title[data-v-8bbab42a]{text-align:center;width:100%}.c-subtitle[data-v-8bbab42a]{margin-top:.25rem}@media screen and (min-width:769px),print{.c-subtitle[data-v-8bbab42a]{margin-bottom:.25rem}}.c-payment-list-item[data-v-8bbab42a]{height:3.3125rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid var(--general_0)}.c-payment-list-item.c-column[data-v-8bbab42a]{flex-direction:column;height:auto;align-items:flex-start}.c-payment-list-item.c-column .has-text-1[data-v-8bbab42a]{padding-top:1rem;padding-bottom:.3125rem}.c-payment-list-item .c-lightning-trxn-id[data-v-8bbab42a]{max-width:60%}.c-buttons-container[data-v-8bbab42a]{flex-direction:column-reverse;align-items:stretch;gap:1rem;max-width:25rem;margin:1.625rem auto 0;width:100%}.c-buttons-container.is-centered[data-v-8bbab42a]{justify-content:center}.c-buttons-container .button[data-v-8bbab42a]:not(:last-child){margin-right:0}@media screen and (min-width:769px),print{.c-buttons-container[data-v-8bbab42a]{flex-direction:row;justify-content:space-between;margin-top:2rem;align-items:center}}@media screen and (min-width:1200px){.c-buttons-container[data-v-8bbab42a]{max-width:unset}}",map:void 0,media:void 0})},O="data-v-8bbab42a",N=void 0,L=!1;function j(t,i,e,s,o,d,a,m,l,c){let n=(typeof e=="function"?e.options:e)||{};n.__file=`style>
`,n.render||(n.render=t.render,n.staticRenderFns=t.staticRenderFns,n._compiled=!0,o&&(n.functional=!0)),n._scopeId=s;{let u;if(i&&(u=a?function(r){i.call(this,c(r,this.$root.$options.shadowRoot))}:function(r){i.call(this,m(r))}),u!==void 0)if(n.functional){let r=n.render;n.render=function(T,b){return u.call(b),r(T,b)}}else{let r=n.beforeCreate;n.beforeCreate=r?[].concat(r,u):[u]}}return n}function y(){let t=y.styles||(y.styles={}),i=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let d=i?o.media||"default":s,a=t[d]||(t[d]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let m=o.source,l=a.ids.length;if(a.ids.push(s),o.map&&(m+=`
/*# sourceURL=`+o.map.sources[0]+" */",m+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),i&&(a.element=a.element||document.querySelector("style[data-group="+d+"]")),!a.element){let c=document.head||document.getElementsByTagName("head")[0],n=a.element=document.createElement("style");n.type="text/css",o.media&&n.setAttribute("media",o.media),i&&(n.setAttribute("data-group",d),n.setAttribute("data-next-index","0")),c.appendChild(n)}if(i&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(m),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let c=document.createTextNode(m),n=a.element.childNodes;n[l]&&a.element.removeChild(n[l]),n.length?a.element.insertBefore(c,n[l]):a.element.appendChild(c)}}}}var A=j({render:R,staticRenderFns:k},E,w,O,L,N,!1,y,void 0,void 0),H=A;export{H as default};
//# sourceMappingURL=PaymentDetail-JUGETP5W-cached.js.map
