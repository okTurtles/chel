import{b as B,c as q}from"./chunk-4SBJY7CH-cached.js";import"./chunk-J7GSI7JG-cached.js";import{a as U}from"./chunk-URDQIHOO-cached.js";import{b as y,d as $}from"./chunk-OYX4NVDU-cached.js";import{a as C,c as K}from"./chunk-AZT5ZK4I-cached.js";import{a as T}from"./chunk-KRTYB7RO-cached.js";import{a as j}from"./chunk-CJC5SPHT-cached.js";import{a as G}from"./chunk-WMVHT3GJ-cached.js";import{b as O,c as F}from"./chunk-6P74MMKF-cached.js";import{e as x}from"./chunk-VUYUNB2W-cached.js";import{b as w}from"./chunk-B4L7IMS4-cached.js";import{e as M,f as b,g as S}from"./chunk-SZPI64OI-cached.js";import"./chunk-R4DRX7L2-cached.js";import{a as R}from"./chunk-FTWBMR5D-cached.js";import"./chunk-SVSS5DEP-cached.js";import"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import{F as L}from"./chunk-M3EDVPDK-cached.js";import{b as u}from"./chunk-33M5GGRR-cached.js";import{a as P}from"./chunk-OMOH7TRL-cached.js";import{d as g}from"./chunk-WBBXU2FL-cached.js";import{e as v}from"./chunk-XMZXE55N-cached.js";var J=v(R()),E=v(w());var V=v(R());var I=v(w());K();var Q={name:"PaymentMethods",components:{},mixins:[V.validationMixin],data:()=>({config:{options:{bitcoin:u("Bitcoin"),lightning:u("Lightning"),paypal:u("Paypal"),venmo:u("Venmo"),other:u("Other")},placeholders:{bitcoin:u("BTC address"),paypal:u("Email, name or URL"),venmo:u("Username"),lightning:u("Lightning address")}},form:{methods:[]},savedMethods:[]}),validations(){return{form:{methods:{$each:{value:{[u("Payment info is required.")]:I.required,[u("Payment info cannot exceed {maxChars} characters.",{maxChars:M})]:(0,I.maxLength)(M)}}}}}},created(){this.savedMethods=this.ourGroupProfile.paymentMethods||[];let e=this.savedMethods.length;if(e===0){C.set(this.form.methods,0,{name:"choose",value:""});return}for(let r=0;r<e;r++){let t=this.savedMethods[r];C.set(this.form.methods,r,{name:t.name,value:t.value})}},computed:{...g(["ourGroupProfile"]),methodsCount(){return Object.keys(this.form.methods).length}},methods:{handleSelectChange(e,r){this.$refs.fields.childNodes[r].getElementsByTagName("input")[0].focus()},getFirstErrorMessage(e){let r=this.$v.form.methods.$each[e].value;if(r.$error){for(let t in r.$params)if(!r[t])return t}return""},handleAddMethod(){C.set(this.form.methods,this.methodsCount,{name:"choose",value:""})},removeMethod(e){this.form.methods.length>1?this.form.methods.splice(e,1):C.set(this.form.methods,0,{name:"choose",value:""})},checkHasUpdates(){let e=this.form.methods.filter(r=>r.name!=="choose");return e.length!==this.savedMethods.length?!0:e.some(r=>this.savedMethods.findIndex(t=>t.name===r.name&&t.value===r.value)===-1)},getPaymentInfoPlaceholder(e){return this.config.placeholders[e]||""}}},Z=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("fieldset",{attrs:{"data-test":"paymentMethods"}},[t("legend",{staticClass:"has-text-bold c-legend"},[t("i18n",{staticClass:"is-title-4"},[e._v("Payment info")])],1),t("i18n",{staticClass:"has-text-1"},[e._v("Other group members will be able to use this information to send you monthly contributions.")]),t("ul",{ref:"fields",staticClass:"c-fields",attrs:{"data-test":"fields"}},e._l(e.form.methods,function(a,i){return t("li",{key:"method-"+i,staticClass:"c-fields-item",attrs:{"data-test":"method"}},[t("fieldset",[t("div",{staticClass:"selectgroup is-reversed c-select",class:{"is-shifted":e.methodsCount>1||a.name!=="choose"||a.value}},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.name,expression:"method.name"}],staticClass:"select",class:{"is-empty":a.name==="choose"},attrs:{"aria-label":e.L("Payment method")},on:{change:[function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var c="_value"in l?l._value:l.value;return c});e.$set(a,"name",s.target.multiple?o:o[0])},function(s){return e.handleSelectChange(s.target.value,i)}]}},[t("i18n",{attrs:{tag:"option",value:"choose",disabled:"true"}},[e._v("Choose...")]),e._l(e.config.options,function(s,o){return t("option",{domProps:{value:o}},[e._v(e._s(s))])})],2),t("input",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"method.value"}],staticClass:"input",class:{error:e.$v.form.methods.$each[i].value.$error},attrs:{type:"text","aria-label":e.L("Payment value"),placeholder:e.getPaymentInfoPlaceholder(a.name)},domProps:{value:a.value},on:{input:function(s){s.target.composing||e.$set(a,"value",s.target.value)}}}),t("button",{staticClass:"is-icon-small is-btn-shifted",attrs:{type:"button","aria-label":e.L("Remove method"),"data-test":"remove"},on:{click:function(s){return e.removeMethod(i)}}},[t("i",{staticClass:"icon-times"})])]),e.$v.form.methods.$each[i].value.$error?t("span",{staticClass:"error"},[e._v(e._s(e.getFirstErrorMessage(i)))]):e._e()])])}),0),t("button",{staticClass:"link has-icon",attrs:{type:"button","data-test":"addMethod"},on:{click:e.handleAddMethod}},[t("i",{staticClass:"icon-plus"}),t("i18n",[e._v("Add more")])],1)],1)},ee=[],te=function(e){e&&e("data-v-28e235d8_0",{source:".c-optional[data-v-28e235d8]{font-weight:400}.c-legend[data-v-28e235d8]{margin-bottom:.25rem}.c-fields[data-v-28e235d8]{margin-top:1rem}.c-fields-item[data-v-28e235d8]{display:block;margin-bottom:1rem}.c-select .select[data-v-28e235d8]{min-width:7rem}.c-select[data-v-28e235d8]::after{left:5.5rem}.c-select .is-btn-shifted[data-v-28e235d8]{display:none}.c-select.is-shifted .is-btn-shifted[data-v-28e235d8]{display:block}",map:void 0,media:void 0})},ne="data-v-28e235d8",oe=void 0,re=!1;function ie(e,r,t,a,i,s,o,l,c,m){let n=(typeof t=="function"?t.options:t)||{};n.__file=`style>
`,n.render||(n.render=e.render,n.staticRenderFns=e.staticRenderFns,n._compiled=!0,i&&(n.functional=!0)),n._scopeId=a;{let p;if(r&&(p=o?function(d){r.call(this,m(d,this.$root.$options.shadowRoot))}:function(d){r.call(this,l(d))}),p!==void 0)if(n.functional){let d=n.render;n.render=function(h,_){return p.call(_),d(h,_)}}else{let d=n.beforeCreate;n.beforeCreate=d?[].concat(d,p):[p]}}return n}function N(){let e=N.styles||(N.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(a,i){if(document.querySelector('style[data-vue-ssr-id~="'+a+'"]'))return;let s=r?i.media||"default":a,o=e[s]||(e[s]={ids:[],parts:[],element:void 0});if(!o.ids.includes(a)){let l=i.source,c=o.ids.length;if(o.ids.push(a),i.map&&(l+=`
/*# sourceURL=`+i.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),r&&(o.element=o.element||document.querySelector("style[data-group="+s+"]")),!o.element){let m=document.head||document.getElementsByTagName("head")[0],n=o.element=document.createElement("style");n.type="text/css",i.media&&n.setAttribute("media",i.media),r&&(n.setAttribute("data-group",s),n.setAttribute("data-next-index","0")),m.appendChild(n)}if(r&&(c=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",c+1)),o.element.styleSheet)o.parts.push(l),o.element.styleSheet.cssText=o.parts.filter(Boolean).join(`
`);else{let m=document.createTextNode(l),n=o.element.childNodes;n[c]&&o.element.removeChild(n[c]),n.length?o.element.insertBefore(m,n[c]):o.element.appendChild(m)}}}}var ae=ie({render:Z,staticRenderFns:ee},te,Q,ne,re,oe,!1,N,void 0,void 0),X=ae;var z=v(R()),W=v(w());var se={name:"NonMonetaryPledges",mixins:[z.validationMixin],props:{optional:{type:Boolean,default:!1}},data(){return{form:{pledges:[{id:x(10),value:""}]},config:{maxChar:b}}},computed:{...g(["ourGroupProfile"])},created(){this.ourGroupProfile.nonMonetaryContributions.length&&(this.form.pledges=this.ourGroupProfile.nonMonetaryContributions.map(e=>({id:x(10),value:e})))},methods:{removeEntry(e){this.form.pledges.length>1?this.form.pledges.splice(e,1):this.form.pledges=[{id:x(10),value:""}]},addPledgeEntry(){this.form.pledges.push({id:x(10),value:""})},getFieldErrorMsg(e){let r=this.$v.form.pledges.$each[e].value;if(r.$error){for(let t in r.$params)if(!r[t])return t}return""},checkHasUpdates(){let e=this.ourGroupProfile.nonMonetaryContributions;return this.form.pledges.length!==e.length?!0:this.form.pledges.some(r=>!e.includes(r.value))},getValues(){return this.form.pledges.map(e=>e.value).filter(Boolean)},validate(){return this.$v.form.$touch(),!this.$v.form.$invalid}},validations(){return{form:{pledges:{[u("At least one non-monetary pledge is required")]:e=>this.optional||e?.length&&e.some(r=>r.value),$each:{value:{[u("Non-monetary pledge cannot exceed {maxChars} characters",{maxChars:b})]:(0,W.maxLength)(b)}}}}}}},de=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("fieldset",{directives:[{name:"error",rawName:"v-error:pledges",value:{attrs:{"data-test":"badPledges"}},expression:'{ attrs: { "data-test": "badPledges" } }',arg:"pledges"}],attrs:{"data-test":"nonMonetaryPledges"}},[t("legend",{staticClass:"has-text-bold c-legend"},[t("i18n",{staticClass:"is-title-4"},[e._v("Non-monetary pledge")]),e.optional?t("i18n",{staticClass:"c-optional"},[e._v("(optional)")]):e._e()],1),t("i18n",{staticClass:"has-text-1"},[e._v("All members can support each other with non-monetary contributions. There's value in time, skills, and willingness to help the group.")]),t("ul",{staticClass:"c-fields",attrs:{"data-test":"nonMonetaryFields"}},e._l(e.form.pledges,function(a,i){return t("li",{key:"pledge-"+a.id,staticClass:"c-fields-item",attrs:{"data-test":"pledgeEntry"}},[t("fieldset",[t("div",{staticClass:"inputgroup"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:a.value,expression:"pledge.value",modifiers:{trim:!0}}],staticClass:"input",class:{error:e.$v.form.pledges.$each[i].value.$error},attrs:{type:"text","data-test":"inputNonMonetaryPledge",maxlength:e.config.maxChar,"aria-label":e.L("Pledge value")},domProps:{value:a.value},on:{input:function(s){s.target.composing||e.$set(a,"value",s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),t("button",{staticClass:"is-icon-small is-btn-shifted",attrs:{type:"button","aria-label":e.L("Remove pledge entry"),"data-test":"removePledgeEntry"},on:{click:function(s){return e.removeEntry(i)}}},[t("i",{staticClass:"icon-times"})])]),e.$v.form.pledges.$each[i].value.$error?t("span",{staticClass:"error"},[e._v(e._s(e.getFieldErrorMsg(i)))]):e._e()])])}),0),t("button",{staticClass:"link has-icon",attrs:{type:"button","data-test":"addPledgeEntry"},on:{click:e.addPledgeEntry}},[t("i",{staticClass:"icon-plus"}),t("i18n",[e._v("Add more")])],1)],1)},le=[],ce=function(e){e&&e("data-v-17a0c4df_0",{source:".c-optional[data-v-17a0c4df]{display:inline-block;color:var(--text_1);user-select:none;font-size:.75rem;margin-left:.5rem}.c-legend[data-v-17a0c4df]{margin-bottom:.25rem}.c-fields[data-v-17a0c4df]{margin-top:1rem}.c-fields-item[data-v-17a0c4df]{display:block;margin-bottom:1rem}",map:void 0,media:void 0})},me="data-v-17a0c4df",ue=void 0,pe=!1;function fe(e,r,t,a,i,s,o,l,c,m){let n=(typeof t=="function"?t.options:t)||{};n.__file=`style>
`,n.render||(n.render=e.render,n.staticRenderFns=e.staticRenderFns,n._compiled=!0,i&&(n.functional=!0)),n._scopeId=a;{let p;if(r&&(p=o?function(d){r.call(this,m(d,this.$root.$options.shadowRoot))}:function(d){r.call(this,l(d))}),p!==void 0)if(n.functional){let d=n.render;n.render=function(h,_){return p.call(_),d(h,_)}}else{let d=n.beforeCreate;n.beforeCreate=d?[].concat(d,p):[p]}}return n}function A(){let e=A.styles||(A.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(a,i){if(document.querySelector('style[data-vue-ssr-id~="'+a+'"]'))return;let s=r?i.media||"default":a,o=e[s]||(e[s]={ids:[],parts:[],element:void 0});if(!o.ids.includes(a)){let l=i.source,c=o.ids.length;if(o.ids.push(a),i.map&&(l+=`
/*# sourceURL=`+i.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),r&&(o.element=o.element||document.querySelector("style[data-group="+s+"]")),!o.element){let m=document.head||document.getElementsByTagName("head")[0],n=o.element=document.createElement("style");n.type="text/css",i.media&&n.setAttribute("media",i.media),r&&(n.setAttribute("data-group",s),n.setAttribute("data-next-index","0")),m.appendChild(n)}if(r&&(c=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",c+1)),o.element.styleSheet)o.parts.push(l),o.element.styleSheet.cssText=o.parts.filter(Boolean).join(`
`);else{let m=document.createTextNode(l),n=o.element.childNodes;n[c]&&o.element.removeChild(n[c]),n.length?o.element.insertBefore(m,n[c]):o.element.appendChild(m)}}}}var he=fe({render:de,staticRenderFns:le},ce,se,me,pe,ue,!1,A,void 0,void 0),H=he;var _e={name:"GroupPledgesGraph",components:{PieChart:q,GraphLegendItem:B,Tooltip:T},props:{type:{type:String,default:null},amount:{type:Number,default:null}},computed:{...g(["groupSettings","groupProfiles","currentPaymentPeriod","haveNeedsForThisPeriod","ourIdentityContractId"]),graphData(){let e=this.type==="pledgeAmount",r=this.type==="incomeAmount",t=this.groupSettings.mincomeAmount,a=e&&this.amount>=0&&this.amount,i=r&&this.amount<t&&this.amount,s=this.haveNeedsForThisPeriod(this.currentPaymentPeriod).filter(f=>f.memberID!==this.ourIdentityContractId),o=s.reduce((f,h)=>h.haveNeed<0?f+-1*h.haveNeed:f,0),l=s.reduce((f,h)=>h.haveNeed>0?f+h.haveNeed:f,0),c=r&&i!==null?t-i:null,m=l+a,n=o+c,p=Math.max(0,n-m),d=c;return!e&&p>0&&(s.push({memberID:this.ourIdentityContractId,haveNeed:i-t}),d=U({haveNeeds:s,minimize:!1}).filter(f=>f.toMemberID===this.ourIdentityContractId).reduce((f,h)=>h.amount+f,0)),{othersPledgesAmount:l,ourPledgeAmount:a,ourIncomeNeeded:c,ourIncomeToReceive:d,pledgeTotal:m,groupGoal:n,neededPledges:p,surplus:Math.max(0,m-o-c)}},mainSlices(){let{groupGoal:e,othersPledgesAmount:r,ourPledgeAmount:t,pledgeTotal:a,surplus:i}=this.graphData;if(e===0)return a>0?[{id:"goal_zero",percent:1,color:"primary"}]:[];let s=[];if(r>0){let o=(r/a).toFixed(2),l=i*o;s.push({id:"othersPledgesAmount",percent:this.decimalSlice(r-l),color:"primary"})}if(t>0){let o=(t/a).toFixed(2),l=i*o;s.push({id:"ourPledgeAmount",percent:this.decimalSlice(t-l),color:"primary"})}return s},innerSlices(){let{ourIncomeToReceive:e,surplus:r}=this.graphData;return e>0?[{id:"ourIncomeToReceive",percent:this.decimalSlice(e),color:"warning"}]:r>0?[{id:"surplus",percent:this.decimalSlice(r),color:"success"}]:[]}},methods:{withCurrency(e){return $[this.groupSettings.mincomeCurrency].displayWithCurrency(e)},decimalSlice(e){let r=e/this.graphData.groupGoal;return Math.min(Math.max(0,r),1)}}},ge=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"c-wrapper"},[t("i18n",{staticClass:"sr-only",attrs:{tag:"h3"}},[e._v("Group Pledging Status")]),t("pie-chart",{staticClass:"c-chart",attrs:{slices:e.mainSlices,"inner-slices":e.innerSlices}},[t("i18n",{staticClass:"has-text-1 c-title",attrs:{tag:"p",args:e.LTags("span")}},[e._v("{span_}Group{_span} goal")]),t("span",{staticClass:"is-title-4"},[e._v(e._s(e.withCurrency(e.graphData.groupGoal)))])],1),t("ul",{staticClass:"c-legendList",attrs:{"aria-label":e.L("Group pledging summary"),"data-test":"groupPledgeSummary"}},[t("graph-legend-item",{attrs:{amount:e.withCurrency(e.graphData.pledgeTotal),color:"primary-solid",variant:"side"}},[e._v(e._s(e.L("Total Pledged")))]),t("graph-legend-item",{attrs:{amount:e.withCurrency(e.graphData.neededPledges),color:"blank",variant:"side"}},[e._v(e._s(e.L("Needed Pledges")))]),e.graphData.surplus?t("graph-legend-item",{attrs:{amount:e.withCurrency(e.graphData.surplus),color:"success-solid",variant:"side"}},[e._v(e._s(e.L("Surplus"))),t("template",{slot:"description"},[t("i18n",[e._v("This amount will not be used until someone needs it.")])],1)],2):e._e(),e.graphData.ourIncomeToReceive>0?t("graph-legend-item",{attrs:{amount:e.withCurrency(e.graphData.ourIncomeToReceive),color:"warning-solid",variant:"side"}},[e._v(e._s(e.L("You'll receive"))),e.graphData.ourIncomeNeeded!==e.graphData.ourIncomeToReceive?t("tooltip",{attrs:{isTextCenter:!0,text:e.L("Based on other members pledges, the group is not able to provide a full mincome yet.")}},[t("i",{staticClass:"icon-info-circle is-suffix has-text-primary"})]):e._e()],1):e._e()],1)],1)},ve=[],ye=function(e){e&&e("data-v-58f61eaa_0",{source:".c-wrapper[data-v-58f61eaa]{position:relative;display:flex;align-items:center;align-content:flex-start}@media screen and (min-width:769px),print{.c-wrapper[data-v-58f61eaa]{flex-direction:column}}.c-chart[data-v-58f61eaa]  .c-piechart{width:7.5rem}@media screen and (min-width:769px),print{.c-chart[data-v-58f61eaa]  .c-piechart{width:10rem}}@media screen and (min-width:1200px){.c-chart[data-v-58f61eaa]  .c-piechart{width:12rem}}.c-title[data-v-58f61eaa]{margin-bottom:.25rem}@media screen and (max-width:768px){.c-title[data-v-58f61eaa]{text-transform:capitalize}.c-title[data-v-58f61eaa]  span{display:none}}.c-legendList[data-v-58f61eaa]{flex-grow:1;margin:0 .5rem 0 1rem;max-width:20rem}@media screen and (min-width:769px),print{.c-legendList[data-v-58f61eaa]{margin:1.5rem 0 0 0;width:100%}}",map:void 0,media:void 0})},xe="data-v-58f61eaa",Ce=void 0,be=!1;function $e(e,r,t,a,i,s,o,l,c,m){let n=(typeof t=="function"?t.options:t)||{};n.__file=`style>
`,n.render||(n.render=e.render,n.staticRenderFns=e.staticRenderFns,n._compiled=!0,i&&(n.functional=!0)),n._scopeId=a;{let p;if(r&&(p=o?function(d){r.call(this,m(d,this.$root.$options.shadowRoot))}:function(d){r.call(this,l(d))}),p!==void 0)if(n.functional){let d=n.render;n.render=function(h,_){return p.call(_),d(h,_)}}else{let d=n.beforeCreate;n.beforeCreate=d?[].concat(d,p):[p]}}return n}function D(){let e=D.styles||(D.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(a,i){if(document.querySelector('style[data-vue-ssr-id~="'+a+'"]'))return;let s=r?i.media||"default":a,o=e[s]||(e[s]={ids:[],parts:[],element:void 0});if(!o.ids.includes(a)){let l=i.source,c=o.ids.length;if(o.ids.push(a),i.map&&(l+=`
/*# sourceURL=`+i.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),r&&(o.element=o.element||document.querySelector("style[data-group="+s+"]")),!o.element){let m=document.head||document.getElementsByTagName("head")[0],n=o.element=document.createElement("style");n.type="text/css",i.media&&n.setAttribute("media",i.media),r&&(n.setAttribute("data-group",s),n.setAttribute("data-next-index","0")),m.appendChild(n)}if(r&&(c=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",c+1)),o.element.styleSheet)o.parts.push(l),o.element.styleSheet.cssText=o.parts.filter(Boolean).join(`
`);else{let m=document.createTextNode(l),n=o.element.childNodes;n[c]&&o.element.removeChild(n[c]),n.length?o.element.insertBefore(m,n[c]):o.element.appendChild(m)}}}}var Te=$e({render:ge,staticRenderFns:ve},ye,_e,xe,be,Ce,!1,D,void 0,void 0),Y=Te;var Ie={name:"IncomeDetails",mixins:[J.validationMixin],components:{ModalBaseTemplate:j,TransitionExpand:O,BannerScoped:F,ButtonSubmit:G,Tooltip:T,PaymentMethods:X,NonMonetaryPledges:H,GroupPledgesGraph:Y},data(){return{form:{incomeDetailsType:null,amount:null}}},computed:{...g(["groupSettings","groupProfile","groupProfiles","groupMincomeFormatted","groupMincomeSymbolWithCode","ourIdentityContractId","withGroupCurrency","ourGroupProfile","usernameFromID"]),needsIncome(){return this.form.incomeDetailsType==="incomeAmount"},isPledging(){return this.form.incomeDetailsType==="pledgeAmount"},whoIsPledging(){let e=this.groupProfiles;return Object.keys(e).filter(r=>e[r].incomeDetailsType==="pledgeAmount"&&r!==this.ourIdentityContractId)},contributionMemberText(){let e=this.whoIsPledging.map(r=>this.usernameFromID(r));switch(e.length){case 1:return u("{firstMember} will ensure you meet the mincome",{firstMember:e[0]});case 2:return u("{firstMember} and {othersMember} will ensure you meet the mincome",{firstMember:e[0],othersMember:e[1]});default:return u("{firstMember} and {othersMembersCount} others will ensure you meet the mincome",{firstMember:e[0],othersMembersCount:e.length-1})}}},created(){let e=this.ourGroupProfile.incomeDetailsType;this.form.amount="",e&&(this.form.incomeDetailsType=e,this.form.amount=this.ourGroupProfile[e])},methods:{normalizeCurrency:y,resetAmount(){this.form.amount=this.form.incomeDetailsType===this.ourGroupProfile.incomeDetailsType?this.ourGroupProfile[this.ourGroupProfile.incomeDetailsType]:"",this.$v.form.$reset()},closeModal(){this.$refs.modal.close()},async submit(){if(this.$v.form.$invalid){this.$refs.formMsg.danger(u("Your income details are missing. Please review them and try again."));return}let e=null,r=null;if(this.needsIncome){this.$refs.paymentMethods.$v.form.$touch();let t=this.$refs.paymentMethods.form.methods.filter(i=>i.name!=="choose"||i.value);if(!t.length){this.$refs.formMsg.danger(u("Payment details required. Please let people know how they can pay you."));return}let a=t.find(i=>i.name==="choose"||!i.value);if(a){a.value?this.$refs.formMsg.danger(u('The method name for "{methodValue}" is missing.',{methodValue:a.value})):this.$refs.formMsg.danger(u('The method "{methodName}" is incomplete.',{methodName:a.name}));return}if(this.$refs.paymentMethods.$v.form.$invalid){this.$refs.formMsg.danger(u("Your payment methods are invalid. Please review them and try again."));return}this.$refs.paymentMethods.checkHasUpdates()&&(e=t)}if(this.$refs.nonMonetaryPledges.validate()){this.$refs.nonMonetaryPledges.checkHasUpdates()&&(r=this.$refs.nonMonetaryPledges.getValues());try{let t=this.form.incomeDetailsType;await P("gi.actions/group/groupProfileUpdate",{contractID:this.$store.state.currentGroupId,data:{incomeDetailsType:t,[t]:y(this.form.amount),...Object.assign({},!!e?.length&&{paymentMethods:e},!!r&&{nonMonetaryReplace:r})}}),this.closeModal(),P("okTurtles.events/emit",L)}catch(t){console.error("IncomeDetails submit() error:",t),this.$refs.formMsg.danger(t.message)}}}},validations(){return{form:{incomeDetailsType:{[u("This field is required")]:E.required},amount:{[u("This field is required")]:E.required,[u("The amount must be a number (e.g. 100.75)")]:function(e){return $[this.groupSettings.mincomeCurrency].validate(e)},[u("Oops, you entered a negative number")]:function(e){return y(e)>=0},[u("Your income must be lower than the group mincome")]:function(e){return!this.needsIncome||y(e)<this.groupSettings.mincomeAmount},[u("Pledge amount cannot exceed {max}",{max:this.withGroupCurrency(S)})]:function(e){return!this.isPledging||y(e)<S}}}}}},Pe=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("modal-base-template",{ref:"modal",attrs:{fullscreen:!0,a11yTitle:e.L("Income Details")}},[t("div",{staticClass:"c-content"},[t("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("Income Details")]),t("form",{staticClass:"card c-card",attrs:{novalidate:"true"},on:{submit:function(a){a.preventDefault()}}},[t("fieldset",{staticClass:"field"},[t("legend",{staticClass:"label"},[e._v(e._s(e.L("Do you make at least {groupMincomeFormatted} per month?",{groupMincomeFormatted:e.groupMincomeFormatted}))),t("tooltip",{attrs:{text:e.L("This is the minimum income in your group"),direction:"top"}},[t("div",{staticClass:"button is-icon-smaller is-primary c-tip"},[t("i",{staticClass:"icon-info"})])])],1),t("label",{staticClass:"radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.form.incomeDetailsType.$model,expression:"$v.form.incomeDetailsType.$model"}],staticClass:"input",attrs:{type:"radio",name:"incomeDetailsType",value:"pledgeAmount"},domProps:{checked:e._q(e.$v.form.incomeDetailsType.$model,"pledgeAmount")},on:{change:[function(a){return e.$set(e.$v.form.incomeDetailsType,"$model","pledgeAmount")},e.resetAmount]}}),t("i18n",{attrs:{"data-test":"doesntNeedIncomeRadio"}},[e._v("Yes, I do")])],1),t("label",{directives:[{name:"error",rawName:"v-error:incomeDetailsType",arg:"incomeDetailsType"}],staticClass:"radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.form.incomeDetailsType.$model,expression:"$v.form.incomeDetailsType.$model"}],staticClass:"input",attrs:{type:"radio",name:"incomeDetailsType",value:"incomeAmount"},domProps:{checked:e._q(e.$v.form.incomeDetailsType.$model,"incomeAmount")},on:{change:[function(a){return e.$set(e.$v.form.incomeDetailsType,"$model","incomeAmount")},e.resetAmount]}}),t("i18n",{attrs:{"data-test":"needsIncomeRadio"}},[e._v("No, I don't")])],1)]),t("transition-expand",[e.form.incomeDetailsType?t("fieldset",[t("label",{staticClass:"field"},[t("div",{staticClass:"label",attrs:{"data-test":"introIncomeOrPledge"}},[e._v(e._s(e.needsIncome?e.L("What's your monthly income?"):e.L("How much do you want to pledge?")))]),t("div",{directives:[{name:"error",rawName:"v-error:amount",value:{attrs:{"data-test":"badIncome"}},expression:'{ attrs: { "data-test": "badIncome" } }',arg:"amount"}],staticClass:"inputgroup",class:{error:e.$v.form.amount.$error}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.form.amount.$model,expression:"$v.form.amount.$model"}],staticClass:"input",attrs:{inputmode:"decimal",pattern:"[0-9]*","data-test":"inputIncomeOrPledge"},domProps:{value:e.$v.form.amount.$model},on:{input:function(a){a.target.composing||e.$set(e.$v.form.amount,"$model",a.target.value)}}}),t("div",{staticClass:"suffix"},[e._v(e._s(e.groupMincomeSymbolWithCode))])]),e.needsIncome&&e.whoIsPledging.length?t("div",{staticClass:"helper"},[t("p",[e._v(e._s(e.contributionMemberText))])]):e.needsIncome?e._e():t("i18n",{staticClass:"helper"},[e._v("Define up to how much you pledge to contribute to the group every 30 days. Only the minimum amount needed will be distributed.")])],1),e.needsIncome?t("payment-methods",{ref:"paymentMethods",staticClass:"c-methods"}):e._e(),t("non-monetary-pledges",{ref:"nonMonetaryPledges",staticClass:"c-non-monetary-pledges",attrs:{optional:e.isPledging}})],1):e._e()]),t("banner-scoped",{ref:"formMsg",attrs:{allowA:!0}}),t("div",{staticClass:"buttons"},[t("i18n",{staticClass:"is-outlined",attrs:{tag:"button",type:"button"},on:{click:e.closeModal}},[e._v("Cancel")]),t("button-submit",{staticClass:"is-success",attrs:{"data-test":"submitIncome",disabled:e.$v.form.$invalid},on:{click:e.submit}},[t("i18n",[e._v("Save")])],1)],1)],1),t("group-pledges-graph",{staticClass:"c-graph",attrs:{type:e.form.incomeDetailsType,amount:e.form.amount===""?void 0:e.normalizeCurrency(e.form.amount)}})],1)])},Me=[],Se=function(e){e&&e("data-v-1c5c02cc_0",{source:'.c-content[data-v-1c5c02cc]{display:grid;grid-template-areas:"title title" "graph graph" "card card";width:100%;max-width:55rem;margin-top:1.5rem}@media screen and (min-width:769px),print{.c-content[data-v-1c5c02cc]{grid-template-columns:auto 12rem;grid-column-gap:1.5rem;grid-template-areas:"title title" "card graph";margin-top:2.5rem}}@media screen and (min-width:1200px){.c-content[data-v-1c5c02cc]{grid-column-gap:4rem}}.c-title[data-v-1c5c02cc]{grid-area:title;margin-bottom:2.5rem}@media screen and (min-width:769px),print{.c-title[data-v-1c5c02cc]{margin-bottom:1.5rem}}.c-card[data-v-1c5c02cc]{grid-area:card;align-self:flex-start}@media screen and (min-width:1200px){.c-card[data-v-1c5c02cc]{padding:2.5rem}}.c-methods[data-v-1c5c02cc],.c-non-monetary-pledges[data-v-1c5c02cc]{margin-top:1.5rem}.c-tip[data-v-1c5c02cc]{display:inline-block;margin-left:.25rem}.c-graph[data-v-1c5c02cc]{grid-area:graph;flex-shrink:0;margin-bottom:1.5rem}',map:void 0,media:void 0})},Re="data-v-1c5c02cc",we=void 0,Ne=!1;function Ae(e,r,t,a,i,s,o,l,c,m){let n=(typeof t=="function"?t.options:t)||{};n.__file=`style>
`,n.render||(n.render=e.render,n.staticRenderFns=e.staticRenderFns,n._compiled=!0,i&&(n.functional=!0)),n._scopeId=a;{let p;if(r&&(p=o?function(d){r.call(this,m(d,this.$root.$options.shadowRoot))}:function(d){r.call(this,l(d))}),p!==void 0)if(n.functional){let d=n.render;n.render=function(h,_){return p.call(_),d(h,_)}}else{let d=n.beforeCreate;n.beforeCreate=d?[].concat(d,p):[p]}}return n}function k(){let e=k.styles||(k.styles={}),r=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(a,i){if(document.querySelector('style[data-vue-ssr-id~="'+a+'"]'))return;let s=r?i.media||"default":a,o=e[s]||(e[s]={ids:[],parts:[],element:void 0});if(!o.ids.includes(a)){let l=i.source,c=o.ids.length;if(o.ids.push(a),i.map&&(l+=`
/*# sourceURL=`+i.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(i.map))))+" */"),r&&(o.element=o.element||document.querySelector("style[data-group="+s+"]")),!o.element){let m=document.head||document.getElementsByTagName("head")[0],n=o.element=document.createElement("style");n.type="text/css",i.media&&n.setAttribute("media",i.media),r&&(n.setAttribute("data-group",s),n.setAttribute("data-next-index","0")),m.appendChild(n)}if(r&&(c=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",c+1)),o.element.styleSheet)o.parts.push(l),o.element.styleSheet.cssText=o.parts.filter(Boolean).join(`
`);else{let m=document.createTextNode(l),n=o.element.childNodes;n[c]&&o.element.removeChild(n[c]),n.length?o.element.insertBefore(m,n[c]):o.element.appendChild(m)}}}}var De=Ae({render:Pe,staticRenderFns:Me},Se,Ie,Re,Ne,we,!1,k,void 0,void 0),ct=De;export{ct as default};
//# sourceMappingURL=IncomeDetails-GXPY4ECV-cached.js.map
