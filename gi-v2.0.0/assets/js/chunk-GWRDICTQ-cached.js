import{f as v}from"./chunk-QD6O46IB-cached.js";import{a as m}from"./chunk-OMOH7TRL-cached.js";var p={name:"Avatar",props:{src:[String,Object],alt:{type:String,default:""},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)}},mounted(){console.log(`Avatar under ${this.$parent.$vnode.tag} blobURL:`,this.blobURL,"src:",this.src),this.src&&typeof this.src=="object"&&this.downloadFile(this.src).catch(e=>{console.error("[Avatar.vue] Error in downloadFile",e)})},beforeDestroy(){this.revokeObjectURL()},data(){return{revokableObjectURL:null,blobURL:null}},methods:{revokeObjectURL(){this.revokableObjectURL&&URL.revokeObjectURL(this.revokableObjectURL),this.revokableObjectURL=null},setFromBlob(e){this.revokableObjectURL=this.blobURL=URL.createObjectURL(e)},async downloadFile(e){let n=await m("gi.db/filesCache/load",e.manifestCid).catch(a=>{console.error("[Avatar.vue] Error loading file from cache",a)}),i=n?new Blob([n]):null;if(e===this.src){if(i){this.setFromBlob(i);return}try{let a=await m("chelonia/fileDownload",new v(e)),o=await a.arrayBuffer();if(m("gi.db/filesCache/save",e.manifestCid,o).catch(d=>{console.error("[Avatar.vue] Error caching avatar blob",d)}),e!==this.src)return;this.setFromBlob(a)}catch(a){console.error("[Avatar.vue] Error setting avatar blob",a)}}}},watch:{src(e){e&&typeof e=="object"&&this.downloadFile(e).catch(n=>{console.error("[Avatar.vue] Error in downloadFile",n)})}},computed:{imageURL(){return this.blobURL||typeof this.src=="string"&&this.src}}},g=function(){var e=this,n=e.$createElement,i=e._self._c||n;return e.imageURL?i("img",e._g({ref:"img",staticClass:"c-avatar",class:"is-"+e.size,attrs:{src:e.imageURL,alt:e.alt,draggable:"false"},on:{load:e.revokeObjectURL,error:e.revokeObjectURL}},e.$listeners)):i("div",{staticClass:"c-avatar is-empty",class:"is-"+e.size})},y=[],R=function(e){e&&e("data-v-277d712b_0",{source:'.c-avatar[data-v-277d712b]{border-radius:50%;object-fit:cover;flex-shrink:0}.c-avatar[data-v-277d712b]::after{content:"";display:block;padding-bottom:100%}.c-avatar.is-empty[data-v-277d712b]{background-color:var(--general_0)}.c-avatar.is-xs[data-v-277d712b]{width:1.5rem;height:1.5rem}.c-avatar.is-sm[data-v-277d712b]{width:2rem;height:2rem}.c-avatar.is-md[data-v-277d712b]{width:2.5rem;height:2.5rem}.c-avatar.is-lg[data-v-277d712b]{width:4.5rem;height:4.5rem}.c-avatar.is-xl[data-v-277d712b]{width:8rem;height:8rem}',map:void 0,media:void 0})},x="data-v-277d712b",U=void 0,L=!1;function j(e,n,i,a,o,d,r,c,l,u){let t=(typeof i=="function"?i.options:i)||{};t.__file=`style>
`,t.render||(t.render=e.render,t.staticRenderFns=e.staticRenderFns,t._compiled=!0,o&&(t.functional=!0)),t._scopeId=a;{let f;if(n&&(f=r?function(s){n.call(this,u(s,this.$root.$options.shadowRoot))}:function(s){n.call(this,c(s))}),f!==void 0)if(t.functional){let s=t.render;t.render=function(b,h){return f.call(h),s(b,h)}}else{let s=t.beforeCreate;t.beforeCreate=s?[].concat(s,f):[f]}}return t}function _(){let e=_.styles||(_.styles={}),n=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(a,o){if(document.querySelector('style[data-vue-ssr-id~="'+a+'"]'))return;let d=n?o.media||"default":a,r=e[d]||(e[d]={ids:[],parts:[],element:void 0});if(!r.ids.includes(a)){let c=o.source,l=r.ids.length;if(r.ids.push(a),o.map&&(c+=`
/*# sourceURL=`+o.map.sources[0]+" */",c+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),n&&(r.element=r.element||document.querySelector("style[data-group="+d+"]")),!r.element){let u=document.head||document.getElementsByTagName("head")[0],t=r.element=document.createElement("style");t.type="text/css",o.media&&t.setAttribute("media",o.media),n&&(t.setAttribute("data-group",d),t.setAttribute("data-next-index","0")),u.appendChild(t)}if(n&&(l=parseInt(r.element.getAttribute("data-next-index")),r.element.setAttribute("data-next-index",l+1)),r.element.styleSheet)r.parts.push(c),r.element.styleSheet.cssText=r.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(c),t=r.element.childNodes;t[l]&&r.element.removeChild(t[l]),t.length?r.element.insertBefore(u,t[l]):r.element.appendChild(u)}}}}var w=j({render:g,staticRenderFns:y},R,p,x,L,U,!1,_,void 0,void 0),O=w;export{O as a};
//# sourceMappingURL=chunk-GWRDICTQ-cached.js.map
