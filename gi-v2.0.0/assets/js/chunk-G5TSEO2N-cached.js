import{b as C}from"./chunk-XK3SURHI-cached.js";import{a as y}from"./chunk-GWRDICTQ-cached.js";import{c as b}from"./chunk-6P74MMKF-cached.js";import{H as v,u as x}from"./chunk-M3EDVPDK-cached.js";import{b as p,c as _}from"./chunk-33M5GGRR-cached.js";import{a as u}from"./chunk-OMOH7TRL-cached.js";var S={name:"AvatarUpload",props:{avatar:[String,Object],sbpParams:{type:Object,required:!0},avatarType:{type:String,validator:t=>["user","group"].includes(t)}},components:{Avatar:y,BannerScoped:b},methods:{fileChange(t){if(!t.length)return;let i=URL.createObjectURL(t[0]);u("okTurtles.events/emit",x,"AvatarEditorModal",{imageUrl:i,avatarType:this.avatarType})},async uploadEditedImage({blob:t,avatarType:i}){if(i!==this.avatarType)return;let n;try{n=await C(t,{billableContractID:this.sbpParams.contractID})}catch(r){return console.error("AvatarUpload imageUpload() error:",r),this.$refs.formMsg.danger(p("Failed to upload avatar. {reportError}",_(r))),!1}try{let{selector:r,contractID:o,key:d}=this.sbpParams;await u(r,{contractID:o,data:{[d]:n}}),this.$refs.formMsg.success(p("Avatar updated!"))}catch(r){console.error("AvatarUpload fileChange() error:",r),this.$refs.formMsg.danger(p("Failed to save avatar. {reportError}",_(r)))}}},beforeMount(){u("okTurtles.events/on",v,this.uploadEditedImage)},beforeDestroy(){u("okTurtles.events/off",v,this.uploadEditedImage)}},R=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("form",{staticClass:"c-avatar-form",on:{submit:function(r){r.preventDefault()}}},[n("div",{staticClass:"c-avatar-wrapper"},[n("label",{staticClass:"c-avatar-label"},[n("avatar",{ref:"picture",staticClass:"c-avatar-img",attrs:{src:t.avatar,size:"xl"}}),n("i18n",{staticClass:"link c-avatar-text"},[t._v("Change avatar")]),n("input",{staticClass:"sr-only",attrs:{type:"file",name:"picture",accept:"image/*",placeholder:"http://","data-test":"avatar"},on:{change:function(r){return t.fileChange(r.target.files)}}})],1),n("banner-scoped",{ref:"formMsg",staticClass:"c-formMsg",attrs:{"data-test":"avatarMsg"}})],1)])},A=[],I=function(t){t&&t("data-v-d12467f4_0",{source:".c-avatar-form[data-v-d12467f4]{position:relative}.c-avatar-wrapper[data-v-d12467f4]{margin:0 auto;display:flex;flex-direction:column;text-align:center;align-items:center}@media screen and (min-width:1200px){.c-avatar-wrapper[data-v-d12467f4]{align-items:flex-end}}@media screen and (max-width:1199px){.c-avatar-label[data-v-d12467f4]{margin-bottom:1.5rem}}@media screen and (min-width:1200px){.c-avatar-label[data-v-d12467f4]{position:absolute;top:-6.5rem;right:0;align-items:flex-end;margin-bottom:-.5rem;z-index:3}}.c-avatar-img.is-xl.is-xl[data-v-d12467f4]{margin:0 auto}@media screen and (min-width:1200px){.c-avatar-img.is-xl.is-xl[data-v-d12467f4]{width:4.5rem;height:4.5rem}}.c-avatar-text[data-v-d12467f4]{display:inline-block}.c-formMsg[data-v-d12467f4]{width:100%}.c-formMsg[data-v-d12467f4]  .c-banner{margin:0 0 1.5rem}@media screen and (min-width:1200px){.c-formMsg[data-v-d12467f4]  .c-banner{margin:.5rem 0 1.5rem}}",map:void 0,media:void 0})},T="data-v-d12467f4",w=void 0,M=!1;function U(t,i,n,r,o,d,a,c,l,m){let e=(typeof n=="function"?n.options:n)||{};e.__file=`style>
`,e.render||(e.render=t.render,e.staticRenderFns=t.staticRenderFns,e._compiled=!0,o&&(e.functional=!0)),e._scopeId=r;{let f;if(i&&(f=a?function(s){i.call(this,m(s,this.$root.$options.shadowRoot))}:function(s){i.call(this,c(s))}),f!==void 0)if(e.functional){let s=e.render;e.render=function(E,h){return f.call(h),s(E,h)}}else{let s=e.beforeCreate;e.beforeCreate=s?[].concat(s,f):[f]}}return e}function g(){let t=g.styles||(g.styles={}),i=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,o){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let d=i?o.media||"default":r,a=t[d]||(t[d]={ids:[],parts:[],element:void 0});if(!a.ids.includes(r)){let c=o.source,l=a.ids.length;if(a.ids.push(r),o.map&&(c+=`
/*# sourceURL=`+o.map.sources[0]+" */",c+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),i&&(a.element=a.element||document.querySelector("style[data-group="+d+"]")),!a.element){let m=document.head||document.getElementsByTagName("head")[0],e=a.element=document.createElement("style");e.type="text/css",o.media&&e.setAttribute("media",o.media),i&&(e.setAttribute("data-group",d),e.setAttribute("data-next-index","0")),m.appendChild(e)}if(i&&(l=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",l+1)),a.element.styleSheet)a.parts.push(c),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let m=document.createTextNode(c),e=a.element.childNodes;e[l]&&a.element.removeChild(e[l]),e.length?a.element.insertBefore(m,e[l]):a.element.appendChild(m)}}}}var $=U({render:R,staticRenderFns:A},I,S,T,M,w,!1,g,void 0,void 0),B=$;export{B as a};
//# sourceMappingURL=chunk-G5TSEO2N-cached.js.map
