import{o as M}from"./chunk-VUYUNB2W-cached.js";var D=2.5,v={OUT:"pinch-out",IN:"pinch-in"},g={pointerMoveOnWindow:!1},x=(s=g)=>({data(){return{pointer:{evts:[],prevDistance:null,prevDistChangeFactor:null,prevPinchAction:null,prevPinchCenter:null},throttledHandlers:{pointerMove:M(this.onPointerMove,5)},matchMedia:{handler:null,isTouch:!1}}},methods:{onPointerDown(t){let{pointerId:i,clientX:r,clientY:c}=t;this.pointer.evts.push({id:i,prev:{x:r,y:c},current:{x:r,y:c}})},onPointerCancel(t){this.pointer.evts=[],this.pointer.prevDistance=null,this.pointer.prevPinchCenter=null,this.pointer.prevDistChangeFactor=null,this.pointer.prevPinchAction=null,this.postPointerCancel&&this.postPointerCancel()},onPointerMove(t){if(!this.pointer.evts.length)return;let{pointerId:i,pointerType:r,clientX:c,clientY:f}=t,{evts:h}=this.pointer,e=h.find(({id:n})=>n===i);if(e){if(e.prev={x:e.current.x,y:e.current.y},e.current={x:c,y:f},h.length===1){let n=this.matchMedia.isTouch?1.5:1.1;this.translate({x:(e.current.x-e.prev.x)*n,y:(e.current.y-e.prev.y)*n}),this.pointer.prevPinchCenter=null,this.pointer.prevDistance=null,this.pointer.prevDistChangeFactor=null,this.pointer.prevPinchAction=null}else if(r==="touch"&&h.length===2){let[n,a]=h,u=Math.abs(a.current.x-n.current.x),d=Math.abs(a.current.y-n.current.y),C=this.pointer.prevPinchCenter===null?{x:Math.min(n.current.x,a.current.x)+u/2,y:Math.min(n.current.y,a.current.y)+d/2}:this.pointer.prevPinchCenter;this.pointer.prevPinchCenter===null&&(this.pointer.prevPinchCenter=C);let o=Math.sqrt(u*u+d*d),m=this.pointer.prevDistance||o,p=o-m>D?v.OUT:o-m<D*-1?v.IN:null,P=Math.abs(o-m);if(p===this.pointer.prevPinchAction&&this.pointer.prevDistChangeFactor>0&&P>this.pointer.prevDistChangeFactor*3)return;let l={changeFactor:P,center:C};this.pointer.prevDistChangeFactor=P,p===v.OUT?(this.$emit("pinch-out",l),this.pinchOutHandler&&this.pinchOutHandler(l)):p===v.IN&&(this.$emit("pinch-in",l),this.pinchInHandler&&this.pinchInHandler(l)),this.pointer.prevDistance=o,this.pointer.prevPinchAction=p}}}},mounted(){let t=s.pointerMoveOnWindow?window:this.$el;this.$el.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.throttledHandlers.pointerMove),t.addEventListener("pointerup",this.onPointerCancel),this.$el.addEventListener("pointercancel",this.onPointerCancel),s.pointerMoveOnWindow||this.$el.addEventListener("pointerout",this.onPointerCancel);let i=window.matchMedia("(any-pointer:fine)");this.matchMedia.isTouch=!i.matches,this.matchMedia.handler=i,i.onchange=r=>{this.matchMedia.isTouch=!r.matches}},beforeDestroy(){let t=s.pointerMoveOnWindow?window:this.$el;this.$el.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.throttledHandlers.pointerMove),t.removeEventListener("pointerup",this.onPointerCancel),this.$el.removeEventListener("pointercancel",this.onPointerCancel),s.pointerMoveOnWindow||this.$el.removeEventListener("pointerout",this.onPointerCancel),this.matchMedia.handler.onchange=null}}),w=x;export{w as a};
//# sourceMappingURL=chunk-ARAZFESJ-cached.js.map
