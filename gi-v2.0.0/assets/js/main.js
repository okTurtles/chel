import{a as vi,b as Jt,c as eo,d as ki}from"./chunk-HI763YKS-cached.js";import{a as Gi}from"./chunk-567KXCZL-cached.js";import{g as Ii}from"./chunk-TTB57MVS-cached.js";import{a as Di}from"./chunk-FMXZTXSJ-cached.js";import{a as tt,b as Mi}from"./chunk-I2AIXHXH-cached.js";import{c as mi,d as fi}from"./chunk-GEXW5JDJ-cached.js";import{a as Xt,b as Li}from"./chunk-4JOX3BCB-cached.js";import{a as Xo,b as ui}from"./chunk-URDQIHOO-cached.js";import{a as Va,b as qa,c as Wt,d as fe,e as ti,f as oi,g as ue,h as Ie,i as _t,j as Vo,k as qo,l as ci,n as Pi}from"./chunk-MA76ZROG-cached.js";import{b as zo,c as Ho,d as qn,e as Se,f as Wo,g as Kn}from"./chunk-YMRJBWFE-cached.js";import{a as et}from"./chunk-YN7ARXYA-cached.js";import{d as li}from"./chunk-OYX4NVDU-cached.js";import{a as Kt,c as di,e as pi}from"./chunk-MMWHE4QG-cached.js";import{a as Oi}from"./chunk-XK3SURHI-cached.js";import{b as vt,c as Un,d as $n}from"./chunk-F32NHZKM-cached.js";import{a as Ai}from"./chunk-L3DDQKT5-cached.js";import{a as Ei}from"./chunk-JZURTFQX-cached.js";import{a as Ri}from"./chunk-DM23TWK2-cached.js";import"./chunk-NVBWY6TG-cached.js";import{a as hi,b as gi}from"./chunk-FRTBM6HW-cached.js";import{a as yt,b as De,c as ke,d as ri,e as Vt,f as qt,g as ni,h as ii,i as si,l as ai}from"./chunk-3V7YD6RE-cached.js";import{b as Ci}from"./chunk-ZBKQTM3U-cached.js";import{a as Wn}from"./chunk-W2VIWSSX-cached.js";import{a as zt}from"./chunk-GKXQDYNU-cached.js";import{a as I,b as Wa,c as Q}from"./chunk-AZT5ZK4I-cached.js";import"./chunk-VJZRITMK-cached.js";import{a as Si}from"./chunk-ALM2LSB6-cached.js";import"./chunk-ZWHVW34C-cached.js";import{a as Qt}from"./chunk-KRTYB7RO-cached.js";import{a as xi}from"./chunk-WYFJ56Q7-cached.js";import{a as Zt}from"./chunk-GWRDICTQ-cached.js";import{a as Ni}from"./chunk-CJC5SPHT-cached.js";import{a as Ko,c as yi,d as Yt}from"./chunk-YGZ33QYP-cached.js";import{d as ei,e as Me,f as te}from"./chunk-QD6O46IB-cached.js";import{a as _i}from"./chunk-WMVHT3GJ-cached.js";import"./chunk-XHZPFS4B-cached.js";import{a as bi,b as Ti}from"./chunk-6P74MMKF-cached.js";import{a as Bn,b as F,c as jn,h as zn,k as Hn,n as Qe}from"./chunk-VUYUNB2W-cached.js";import"./chunk-B4L7IMS4-cached.js";import{O as Qn,P as Zn,R as Ht,V as bt,a as Ze,b as Z,n as Xn,p as Jn,r as Yn}from"./chunk-SZPI64OI-cached.js";import"./chunk-R4DRX7L2-cached.js";import"./chunk-FTWBMR5D-cached.js";import{a as to}from"./chunk-BZWIYGWR-cached.js";import"./chunk-SVSS5DEP-cached.js";import{a as wi}from"./chunk-MEHASGB7-cached.js";import"./chunk-Z7X5SDSD-cached.js";import{D as Pe,E as Le,I as ft,M as Rn,N as Bt,O as On,P as Pn,Q as Ln,R as ht,S as Mn,T as Dn,U as Gn,V as gt,W as jt,X as Fn,a as Je,b as Oe,c as we,d as Ye,e as yn,f as Fo,g as xn,h as wn,i as Sn,j as Uo,k as $t,l as In,m as kn,n as Tn,o as Cn,p as En,q as An,t as Nn,u as z,v as $o,w as mt,x as Bo}from"./chunk-M3EDVPDK-cached.js";import{a as ye,b,c as Xe,i as bn,j as _n,k as xe}from"./chunk-33M5GGRR-cached.js";import{a as c}from"./chunk-OMOH7TRL-cached.js";import{a as jo,b as oe,c as Vn,d as H}from"./chunk-WBBXU2FL-cached.js";import{c as Ut,e as Re,f as Ha}from"./chunk-XMZXE55N-cached.js";var Vi=Ut(($p,Wi)=>{Wi.exports=function(e){function t(r){if(o[r])return o[r].exports;var s=o[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var o={};return t.m=e,t.c=o,t.i=function(r){return r},t.d=function(r,s,a){t.o(r,s)||Object.defineProperty(r,s,{configurable:!1,enumerable:!0,get:a})},t.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(s,"a",s),s},t.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},t.p="/",t(t.s=5)}([function(e,t){function o(s,a){var n=s[1]||"",l=s[3];if(!l)return n;if(a&&typeof btoa=="function"){var m=r(l);return[n].concat(l.sources.map(function(p){return"/*# sourceURL="+l.sourceRoot+p+" */"})).concat([m]).join(`
`)}return[n].join(`
`)}function r(s){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"}e.exports=function(s){var a=[];return a.toString=function(){return this.map(function(n){var l=o(n,s);return n[2]?"@media "+n[2]+"{"+l+"}":l}).join("")},a.i=function(n,l){typeof n=="string"&&(n=[[null,n,""]]);for(var m={},p=0;p<this.length;p++){var i=this[p][0];typeof i=="number"&&(m[i]=!0)}for(p=0;p<n.length;p++){var u=n[p];typeof u[0]=="number"&&m[u[0]]||(l&&!u[2]?u[2]=l:l&&(u[2]="("+u[2]+") and ("+l+")"),a.push(u))}},a}},function(e,t){e.exports=function(o,r,s,a,n){var l,m=o=o||{},p=typeof o.default;p!=="object"&&p!=="function"||(l=o,m=o.default);var i=typeof m=="function"?m.options:m;r&&(i.render=r.render,i.staticRenderFns=r.staticRenderFns),a&&(i._scopeId=a);var u;if(n?(u=function(g){g=g||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,g||typeof __VUE_SSR_CONTEXT__>"u"||(g=__VUE_SSR_CONTEXT__),s&&s.call(this,g),g&&g._registeredComponents&&g._registeredComponents.add(n)},i._ssrRegister=u):s&&(u=s),u){var d=i.functional,h=d?i.render:i.beforeCreate;d?i.render=function(g,v){return u.call(v),h(g,v)}:i.beforeCreate=h?[].concat(h,u):[u]}return{esModule:l,exports:m,options:i}}},function(e,t,o){function r(y){for(var A=0;A<y.length;A++){var C=y[A],O=i[C.id];if(O){O.refs++;for(var N=0;N<O.parts.length;N++)O.parts[N](C.parts[N]);for(;N<C.parts.length;N++)O.parts.push(a(C.parts[N]));O.parts.length>C.parts.length&&(O.parts.length=C.parts.length)}else{for(var $=[],N=0;N<C.parts.length;N++)$.push(a(C.parts[N]));i[C.id]={id:C.id,refs:1,parts:$}}}}function s(){var y=document.createElement("style");return y.type="text/css",u.appendChild(y),y}function a(y){var A,C,O=document.querySelector('style[data-vue-ssr-id~="'+y.id+'"]');if(O){if(g)return v;O.parentNode.removeChild(O)}if(E){var N=h++;O=d||(d=s()),A=n.bind(null,O,N,!1),C=n.bind(null,O,N,!0)}else O=s(),A=l.bind(null,O),C=function(){O.parentNode.removeChild(O)};return A(y),function($){if($){if($.css===y.css&&$.media===y.media&&$.sourceMap===y.sourceMap)return;A(y=$)}else C()}}function n(y,A,C,O){var N=C?"":O.css;if(y.styleSheet)y.styleSheet.cssText=P(A,N);else{var $=document.createTextNode(N),S=y.childNodes;S[A]&&y.removeChild(S[A]),S.length?y.insertBefore($,S[A]):y.appendChild($)}}function l(y,A){var C=A.css,O=A.media,N=A.sourceMap;if(O&&y.setAttribute("media",O),N&&(C+=`
/*# sourceURL=`+N.sources[0]+" */",C+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(N))))+" */"),y.styleSheet)y.styleSheet.cssText=C;else{for(;y.firstChild;)y.removeChild(y.firstChild);y.appendChild(document.createTextNode(C))}}var m=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!m)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var p=o(16),i={},u=m&&(document.head||document.getElementsByTagName("head")[0]),d=null,h=0,g=!1,v=function(){},E=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(y,A,C){g=C;var O=p(y,A);return r(O),function(N){for(var $=[],S=0;S<O.length;S++){var W=O[S],B=i[W.id];B.refs--,$.push(B)}N?(O=p(y,N),r(O)):O=[];for(var S=0;S<$.length;S++){var B=$[S];if(B.refs===0){for(var ve=0;ve<B.parts.length;ve++)B.parts[ve]();delete i[B.id]}}}};var P=function(){var y=[];return function(A,C){return y[A]=C,y.filter(Boolean).join(`
`)}}()},function(e,t,o){(function(r,s){e.exports=s()})(0,function(){return function(r){function s(n){if(a[n])return a[n].exports;var l=a[n]={exports:{},id:n,loaded:!1};return r[n].call(l.exports,l,l.exports,s),l.loaded=!0,l.exports}var a={};return s.m=r,s.c=a,s.p="",s(0)}([function(r,s){"use strict";function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var n=Object.assign||function(u){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(u[g]=h[g])}return u},l=function(){function u(d,h){for(var g=0;g<h.length;g++){var v=h[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(d,v.key,v)}}return function(d,h,g){return h&&u(d.prototype,h),g&&u(d,g),d}}(),m=function(u,d,h){d.forEach(function(g){u.addEventListener(g,function(v){h(v)})})},p=function(u,d){d.forEach(function(h){u.removeEventListener(h)})},i=function(){function u(d){a(this,u),this.defaults={idle:1e4,events:["mousemove","keydown","mousedown","touchstart"],onIdle:function(){},onActive:function(){},onHide:function(){},onShow:function(){},keepTracking:!0,startAtIdle:!1,recurIdleCall:!1},this.settings=n({},this.defaults,d),this.idle=this.settings.startAtIdle,this.visible=!this.settings.startAtIdle,this.visibilityEvents=["visibilitychange","webkitvisibilitychange","mozvisibilitychange","msvisibilitychange"],this.lastId=null}return l(u,[{key:"resetTimeout",value:function(d,h){if(this.idle&&(h.onActive.call(),this.idle=!1),clearTimeout(d),this.settings.keepTracking)return this.timeout(this.settings)}},{key:"timeout",value:function(d){var h=this.settings.recurIdleCall?setInterval:setTimeout;return h(function(){this.idle=!0,this.settings.onIdle.call()}.bind(this),this.settings.idle)}},{key:"start",value:function(){window.addEventListener("idle:stop",function(d){p(window,this.settings.events),this.settings.keepTracking=!1,this.resetTimeout(this.lastId,this.settings)}),this.lastId=this.timeout(this.settings),m(window,this.settings.events,function(d){this.lastId=this.resetTimeout(this.lastId,this.settings)}.bind(this)),(this.settings.onShow||this.settings.onHide)&&m(document,this.visibilityEvents,function(d){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?this.visible&&(this.visible=!1,this.settings.onHide.call()):this.visible||(this.visible=!0,this.settings.onShow.call())}.bind(this))}}]),u}();r.exports=i}])})},function(e,t,o){function r(a){o(15)}var s=o(1)(o(6),o(13),r,null,null);e.exports=s.exports},function(e,t,o){"use strict";function r(p){return p&&p.__esModule?p:{default:p}}function s(p,i,u){return i in p?Object.defineProperty(p,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):p[i]=u,p}Object.defineProperty(t,"__esModule",{value:!0});var a=o(3),n=r(a),l=o(4),m=r(l);t.default={IdleView:m.default,install:function(p,i){var u=i||{},d=u.eventEmitter,h=u.store,g=u.moduleName,v=g===void 0?"idleVue":g,E=u.idleTime,P=E===void 0?6e4:E,y=u.events,A=y===void 0?["mousemove","keydown","mousedown","touchstart"]:y,C=u.keepTracking,O=C===void 0||C,N=u.startAtIdle,$=N===void 0||N;if(!d&&!h)throw Error("Either `eventEmitter` or `store` must be passed in options");h&&h.registerModule(v,{state:{isIdle:$},mutations:s({},v+"/IDLE_CHANGED",function(B,ve){B.isIdle=ve})});var S=v+"_onIdle",W=v+"_onActive";new n.default({idle:P,events:A,keepTracking:O,startAtIdle:$,onIdle:function(){d&&d.$emit(S),h&&h.commit(v+"/IDLE_CHANGED",!0)},onActive:function(){d&&d.$emit(W),h&&h.commit(v+"/IDLE_CHANGED",!1)}}).start(),p.component("IdleView",m.default),p.mixin({data:function(){var B;return B={},s(B,S,null),s(B,W,null),B},created:function(){d&&this.$options.onIdle&&(this[S]=this.$options.onIdle.bind(this),d.$on(S,this[S])),d&&this.$options.onActive&&(this[W]=this.$options.onActive.bind(this),d.$on(W,this[W]))},destroyed:function(){d&&this[S]&&d.$off(S,this[S]),d&&this[W]&&d.$off(W,this[W])},computed:{isAppIdle:function(){return h&&h.state[v].isIdle}}})}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(11),s=function(a){return a&&a.__esModule?a:{default:a}}(r);t.default={components:{Sprite:s.default},onIdle:function(){this.$refs.sprite.play()},onActive:function(){this.$refs.sprite.stop()}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"sprite",props:{spriteSrc:{type:String,default:""},spriteId:{type:String,default:"sprite"},spriteW:{type:Number,default:1},spriteH:{type:Number,default:1},spriteSpeed:{type:Number,default:1}},data:function(){return{visible:!0,frameIndex:0,tickCount:0,frameLength:0,ticksPerFrame:0,numberOfFrames:0,frameRate:20,ctx:"",canvas:"",mySprite:"",animationFrameId:-1}},mounted:function(){var r=this;this.$nextTick(function(){r.mySprite=new Image,r.mySprite.onload=function(s){r.spriteInit(s.target)},r.mySprite.src=r.spriteSrc})},methods:{spriteInit:function(r){this.canvas=this.$el.querySelector("#"+this.spriteId),this.ctx=this.canvas.getContext("2d"),this.ticksPerFrame=this.spriteSpeed,this.frameLength=r.width,this.numberOfFrames=r.width/this.spriteW,this.spriteLoop()},spriteUpdate:function(){++this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.numberOfFrames-1?this.frameIndex++:this.frameIndex=0)},spriteRender:function(){this.ctx.clearRect(0,0,this.spriteW,this.spriteH);var r=this.frameIndex*this.spriteW;this.ctx.drawImage(this.mySprite,r,0,this.spriteW,this.spriteH,0,0,this.spriteW,this.spriteH)},spriteLoop:function(){this.animationFrameId=window.requestAnimationFrame(this.spriteLoop),this.spriteUpdate(),this.spriteRender()},stop:function(){window.cancelAnimationFrame(this.animationFrameId)},play:function(){this.spriteLoop()}}}},function(e,t,o){t=e.exports=o(0)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Sprite.vue",sourceRoot:""}])},function(e,t,o){t=e.exports=o(0)(!0),t.push([e.i,".idle-view{position:fixed;top:0;width:100vw;height:100vh;z-index:8888;pointer-events:none;display:none}.idle-view.isIdle{pointer-events:all;display:block}.idle-view .sprite{position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);height:10px;width:180px;z-index:9999;-webkit-transform:scale(.7)}.idle-view .overlay{width:100%;height:100%;position:absolute;z-index:8888;background:#000;opacity:0;-webkit-transition:opacity .8s cubic-bezier(.77,0,.175,1)}.idle-view.isIdle .overlay{opacity:.6}@-webkit-keyframes SlowMo{0%{background-position:0 50%}50%{background-position:100% 50%}to{background-position:0 50%}}","",{version:3,sources:["/home/afonso/Dev/idle-vue/src/components/Idle.vue"],names:[],mappings:"AACA,WACE,eAAgB,AAChB,MAAO,AACP,YAAa,AACb,aAAc,AACd,aAAc,AAEd,oBAAqB,AACrB,YAAc,CACf,AACD,kBACE,mBAAoB,AACpB,aAAe,CAChB,AACD,mBACE,kBAAmB,AACnB,QAAS,AACT,SAAU,AACV,4CAA6C,AAE7C,YAAa,AACb,YAAa,AACb,aAAc,AACd,2BAA8B,CAC/B,AACD,oBACE,WAAY,AACZ,YAAa,AACb,kBAAmB,AACnB,aAAc,AAEd,gBAAiB,AACjB,UAAW,AAEX,yDAAkE,CACnE,AACD,2BACE,UAAa,CACd,AACD,0BACA,GAAG,yBAA0B,CAC5B,AACD,IAAI,4BAA4B,CAC/B,AACD,GAAK,yBAA0B,CAC9B,CACA",file:"Idle.vue",sourcesContent:[`
.idle-view {
  position: fixed;
  top: 0;
  width: 100vw;
  height: 100vh;
  z-index: 8888;

  pointer-events: none;
  display: none;
}
.idle-view.isIdle {
  pointer-events: all;
  display: block;
}
.idle-view .sprite {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translateX(-50%) translateY(-50%);

  height: 10px;
  width: 180px;
  z-index: 9999;
  -webkit-transform: scale(0.7);
}
.idle-view .overlay {
  width: 100%;
  height: 100%;
  position: absolute;
  z-index: 8888;

  background: #000;
  opacity: 0;
  /*-webkit-animation: SlowMo 5s cubic-bezier(0.77, 0, 0.175, 1) infinite;*/
  -webkit-transition: opacity 800ms cubic-bezier(0.77, 0, 0.175, 1);
}
.idle-view.isIdle .overlay {
  opacity: 0.6;
}
@-webkit-keyframes SlowMo {
0%{background-position:0% 50%
}
50%{background-position:100% 50%
}
100%{background-position:0% 50%
}
}
`],sourceRoot:""}])},function(e,t,o){e.exports=o.p+"static/img/touch.ba3be66.png"},function(e,t,o){function r(a){o(14)}var s=o(1)(o(7),o(12),r,null,null);e.exports=s.exports},function(e,t){e.exports={render:function(){var o=this,r=o.$createElement,s=o._self._c||r;return s("div",{staticClass:"sprite"},[s("canvas",{attrs:{id:o.spriteId,width:o.spriteW,height:o.spriteH}})])},staticRenderFns:[]}},function(e,t,o){e.exports={render:function(){var r=this,s=r.$createElement,a=r._self._c||s;return a("div",{staticClass:"idle-view",class:{isIdle:r.isIdle}},[a("div",{staticClass:"overlay"}),r._v(" "),a("sprite",{ref:"sprite",attrs:{spriteId:"touch",spriteSrc:o(10),spriteW:180,spriteH:215}})],1)},staticRenderFns:[]}},function(e,t,o){var r=o(8);typeof r=="string"&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),o(2)("b6696284",r,!0)},function(e,t,o){var r=o(9);typeof r=="string"&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals),o(2)("25b5ba8a",r,!0)},function(e,t){e.exports=function(o,r){for(var s=[],a={},n=0;n<r.length;n++){var l=r[n],m=l[0],p=l[1],i=l[2],u=l[3],d={id:o+":"+n,css:p,media:i,sourceMap:u};a[m]?a[m].parts.push(d):s.push(a[m]={id:m,parts:[d]})}return s}}])});var Vs=Ut((iv,Or)=>{(function(){function e(p){for(var i=0;i<l.length;i++)l[i]=0;for(var i=0;i<p.length;i++)l[i%4]=(l[i%4]<<5)-l[i%4]+p.charCodeAt(i)}function t(){var p=l[0]^l[0]<<11;return l[0]=l[1],l[1]=l[2],l[2]=l[3],l[3]=l[3]^l[3]>>19^p^p>>8,(l[3]>>>0)/(1<<31>>>0)}function o(){var p=Math.floor(360*t()),i=60*t()+40+"%",u=25*(t()+t()+t()+t())+"%",d="hsl("+p+","+i+","+u+")";return d}function r(p){for(var i=p,u=p,d=Math.ceil(i/2),h=i-d,g=[],v=0;u>v;v++){for(var E=[],P=0;d>P;P++)E[P]=Math.floor(2.3*t());var y=E.slice(0,h);y.reverse(),E=E.concat(y);for(var A=0;A<E.length;A++)g.push(E[A])}return g}function s(p){var i={};return i.seed=p.seed||Math.floor(Math.random()*Math.pow(10,16)).toString(16),e(i.seed),i.size=p.size||8,i.scale=p.scale||4,i.color=p.color||o(),i.bgcolor=p.bgcolor||o(),i.spotcolor=p.spotcolor||o(),i}function a(p,i){var u=r(p.size),d=Math.sqrt(u.length);i.width=i.height=p.size*p.scale;var h=i.getContext("2d");h.fillStyle=p.bgcolor,h.fillRect(0,0,i.width,i.height),h.fillStyle=p.color;for(var g=0;g<u.length;g++)if(u[g]){var v=Math.floor(g/d),E=g%d;h.fillStyle=u[g]==1?p.color:p.spotcolor,h.fillRect(E*p.scale,v*p.scale,p.scale,p.scale)}return i}function n(i){var i=s(i||{}),u=document.createElement("canvas");return a(i,u),u}var l=new Array(4),m={create:n,render:a};typeof Or<"u"&&(Or.exports=m)})()});var Dr=Ut((Lr,Mr)=>{(function(e,t){typeof Lr=="object"&&typeof Mr<"u"?Mr.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.DOMPurify=t())})(Lr,function(){"use strict";function e(x){if(Array.isArray(x)){for(var w=0,R=Array(x.length);w<x.length;w++)R[w]=x[w];return R}else return Array.from(x)}var t=Object.hasOwnProperty,o=Object.setPrototypeOf,r=Object.isFrozen,s=Object.getPrototypeOf,a=Object.getOwnPropertyDescriptor,n=Object.freeze,l=Object.seal,m=Object.create,p=typeof Reflect<"u"&&Reflect,i=p.apply,u=p.construct;i||(i=function(w,R,L){return w.apply(R,L)}),n||(n=function(w){return w}),l||(l=function(w){return w}),u||(u=function(w,R){return new(Function.prototype.bind.apply(w,[null].concat(e(R))))});var d=N(Array.prototype.forEach),h=N(Array.prototype.pop),g=N(Array.prototype.push),v=N(String.prototype.toLowerCase),E=N(String.prototype.match),P=N(String.prototype.replace),y=N(String.prototype.indexOf),A=N(String.prototype.trim),C=N(RegExp.prototype.test),O=$(TypeError);function N(x){return function(w){for(var R=arguments.length,L=Array(R>1?R-1:0),q=1;q<R;q++)L[q-1]=arguments[q];return i(x,w,L)}}function $(x){return function(){for(var w=arguments.length,R=Array(w),L=0;L<w;L++)R[L]=arguments[L];return u(x,R)}}function S(x,w){o&&o(x,null);for(var R=w.length;R--;){var L=w[R];if(typeof L=="string"){var q=v(L);q!==L&&(r(w)||(w[R]=q),L=q)}x[L]=!0}return x}function W(x){var w=m(null),R=void 0;for(R in x)i(t,x,[R])&&(w[R]=x[R]);return w}function B(x,w){for(;x!==null;){var R=a(x,w);if(R){if(R.get)return N(R.get);if(typeof R.value=="function")return N(R.value)}x=s(x)}function L(q){return console.warn("fallback value for",q),null}return L}var ve=n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),bo=n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_o=n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),da=n(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),yo=n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),pa=n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Hr=n(["#text"]),Wr=n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),xo=n(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Vr=n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),At=n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ma=l(/\{\{[\s\S]*|[\s\S]*\}\}/gm),fa=l(/<%[\s\S]*|[\s\S]*%>/gm),ha=l(/^data-[\-\w.\u00B7-\uFFFF]/),ga=l(/^aria-[\-\w]+$/),va=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ba=l(/^(?:\w+script|data):/i),_a=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x};function ae(x){if(Array.isArray(x)){for(var w=0,R=Array(x.length);w<x.length;w++)R[w]=x[w];return R}else return Array.from(x)}var ya=function(){return typeof window>"u"?null:window},xa=function(w,R){if((typeof w>"u"?"undefined":ct(w))!=="object"||typeof w.createPolicy!="function")return null;var L=null,q="data-tt-policy-suffix";R.currentScript&&R.currentScript.hasAttribute(q)&&(L=R.currentScript.getAttribute(q));var Nt="dompurify"+(L?"#"+L:"");try{return w.createPolicy(Nt,{createHTML:function(Rt){return Rt}})}catch{return console.warn("TrustedTypes policy "+Nt+" could not be created."),null}};function qr(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ya(),w=function(f){return qr(f)};if(w.version="2.2.7",w.removed=[],!x||!x.document||x.document.nodeType!==9)return w.isSupported=!1,w;var R=x.document,L=x.document,q=x.DocumentFragment,Nt=x.HTMLTemplateElement,He=x.Node,Rt=x.Element,Ot=x.NodeFilter,Kr=x.NamedNodeMap,Sa=Kr===void 0?x.NamedNodeMap||x.MozNamedAttrMap:Kr,Ia=x.Text,ka=x.Comment,Ta=x.DOMParser,Ca=x.trustedTypes,Pt=Rt.prototype,Ea=B(Pt,"cloneNode"),Aa=B(Pt,"nextSibling"),Na=B(Pt,"childNodes"),wo=B(Pt,"parentNode");if(typeof Nt=="function"){var So=L.createElement("template");So.content&&So.content.ownerDocument&&(L=So.content.ownerDocument)}var be=xa(Ca,R),Xr=be&&Dt?be.createHTML(""):"",Lt=L,Io=Lt.implementation,Ra=Lt.createNodeIterator,Oa=Lt.getElementsByTagName,Pa=Lt.createDocumentFragment,La=R.importNode,Jr={};try{Jr=W(L).documentMode?L.documentMode:{}}catch{}var ce={};w.isSupported=typeof wo=="function"&&Io&&typeof Io.createHTMLDocument<"u"&&Jr!==9;var ko=ma,To=fa,Ma=ha,Da=ga,Ga=ba,Yr=_a,Co=va,K=null,Qr=S({},[].concat(ae(ve),ae(bo),ae(_o),ae(yo),ae(Hr))),X=null,Zr=S({},[].concat(ae(Wr),ae(xo),ae(Vr),ae(At))),Eo=null,en=null,tn=!0,Ao=!0,on=!1,We=!1,lt=!1,No=!1,Ro=!1,Ve=!1,Mt=!1,rn=!0,Dt=!1,nn=!0,Oo=!0,ut=!1,qe={},Fa=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),sn=null,an=S({},["audio","video","img","source","image","track"]),Po=null,cn=S({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Ke=null,Ua=L.createElement("form"),Lo=function(f){Ke&&Ke===f||((!f||(typeof f>"u"?"undefined":ct(f))!=="object")&&(f={}),f=W(f),K="ALLOWED_TAGS"in f?S({},f.ALLOWED_TAGS):Qr,X="ALLOWED_ATTR"in f?S({},f.ALLOWED_ATTR):Zr,Po="ADD_URI_SAFE_ATTR"in f?S(W(cn),f.ADD_URI_SAFE_ATTR):cn,sn="ADD_DATA_URI_TAGS"in f?S(W(an),f.ADD_DATA_URI_TAGS):an,Eo="FORBID_TAGS"in f?S({},f.FORBID_TAGS):{},en="FORBID_ATTR"in f?S({},f.FORBID_ATTR):{},qe="USE_PROFILES"in f?f.USE_PROFILES:!1,tn=f.ALLOW_ARIA_ATTR!==!1,Ao=f.ALLOW_DATA_ATTR!==!1,on=f.ALLOW_UNKNOWN_PROTOCOLS||!1,We=f.SAFE_FOR_TEMPLATES||!1,lt=f.WHOLE_DOCUMENT||!1,Ve=f.RETURN_DOM||!1,Mt=f.RETURN_DOM_FRAGMENT||!1,rn=f.RETURN_DOM_IMPORT!==!1,Dt=f.RETURN_TRUSTED_TYPE||!1,Ro=f.FORCE_BODY||!1,nn=f.SANITIZE_DOM!==!1,Oo=f.KEEP_CONTENT!==!1,ut=f.IN_PLACE||!1,Co=f.ALLOWED_URI_REGEXP||Co,We&&(Ao=!1),Mt&&(Ve=!0),qe&&(K=S({},[].concat(ae(Hr))),X=[],qe.html===!0&&(S(K,ve),S(X,Wr)),qe.svg===!0&&(S(K,bo),S(X,xo),S(X,At)),qe.svgFilters===!0&&(S(K,_o),S(X,xo),S(X,At)),qe.mathMl===!0&&(S(K,yo),S(X,Vr),S(X,At))),f.ADD_TAGS&&(K===Qr&&(K=W(K)),S(K,f.ADD_TAGS)),f.ADD_ATTR&&(X===Zr&&(X=W(X)),S(X,f.ADD_ATTR)),f.ADD_URI_SAFE_ATTR&&S(Po,f.ADD_URI_SAFE_ATTR),Oo&&(K["#text"]=!0),lt&&S(K,["html","head","body"]),K.table&&(S(K,["tbody"]),delete Eo.tbody),n&&n(f),Ke=f)},ln=S({},["mi","mo","mn","ms","mtext"]),un=S({},["foreignobject","desc","title","annotation-xml"]),Gt=S({},bo);S(Gt,_o),S(Gt,da);var Mo=S({},yo);S(Mo,pa);var Do="http://www.w3.org/1998/Math/MathML",Go="http://www.w3.org/2000/svg",Ft="http://www.w3.org/1999/xhtml",$a=function(f){var _=wo(f);(!_||!_.tagName)&&(_={namespaceURI:Ft,tagName:"template"});var k=v(f.tagName),M=v(_.tagName);if(f.namespaceURI===Go)return _.namespaceURI===Ft?k==="svg":_.namespaceURI===Do?k==="svg"&&(M==="annotation-xml"||ln[M]):!!Gt[k];if(f.namespaceURI===Do)return _.namespaceURI===Ft?k==="math":_.namespaceURI===Go?k==="math"&&un[M]:!!Mo[k];if(f.namespaceURI===Ft){if(_.namespaceURI===Go&&!un[M]||_.namespaceURI===Do&&!ln[M])return!1;var J=S({},["title","style","font","a","script"]);return!Mo[k]&&(J[k]||!Gt[k])}return!1},_e=function(f){g(w.removed,{element:f});try{f.parentNode.removeChild(f)}catch{try{f.outerHTML=Xr}catch{f.remove()}}},dn=function(f,_){try{g(w.removed,{attribute:_.getAttributeNode(f),from:_})}catch{g(w.removed,{attribute:null,from:_})}if(_.removeAttribute(f),f==="is"&&!X[f])if(Ve||Mt)try{_e(_)}catch{}else try{_.setAttribute(f,"")}catch{}},pn=function(f){var _=void 0,k=void 0;if(Ro)f="<remove></remove>"+f;else{var M=E(f,/^[\r\n\t ]+/);k=M&&M[0]}var J=be?be.createHTML(f):f;try{_=new Ta().parseFromString(J,"text/html")}catch{}if(!_||!_.documentElement){_=Io.createHTMLDocument("");var Y=_,j=Y.body;j.parentNode.removeChild(j.parentNode.firstElementChild),j.outerHTML=J}return f&&k&&_.body.insertBefore(L.createTextNode(k),_.body.childNodes[0]||null),Oa.call(_,lt?"html":"body")[0]},mn=function(f){return Ra.call(f.ownerDocument||f,f,Ot.SHOW_ELEMENT|Ot.SHOW_COMMENT|Ot.SHOW_TEXT,function(){return Ot.FILTER_ACCEPT},!1)},Ba=function(f){return f instanceof Ia||f instanceof ka?!1:typeof f.nodeName!="string"||typeof f.textContent!="string"||typeof f.removeChild!="function"||!(f.attributes instanceof Sa)||typeof f.removeAttribute!="function"||typeof f.setAttribute!="function"||typeof f.namespaceURI!="string"||typeof f.insertBefore!="function"},dt=function(f){return(typeof He>"u"?"undefined":ct(He))==="object"?f instanceof He:f&&(typeof f>"u"?"undefined":ct(f))==="object"&&typeof f.nodeType=="number"&&typeof f.nodeName=="string"},me=function(f,_,k){ce[f]&&d(ce[f],function(M){M.call(w,_,k,Ke)})},fn=function(f){var _=void 0;if(me("beforeSanitizeElements",f,null),Ba(f)||E(f.nodeName,/[\u0080-\uFFFF]/))return _e(f),!0;var k=v(f.nodeName);if(me("uponSanitizeElement",f,{tagName:k,allowedTags:K}),!dt(f.firstElementChild)&&(!dt(f.content)||!dt(f.content.firstElementChild))&&C(/<[/\w]/g,f.innerHTML)&&C(/<[/\w]/g,f.textContent))return _e(f),!0;if(!K[k]||Eo[k]){if(Oo&&!Fa[k]){var M=wo(f),J=Na(f);if(J&&M)for(var Y=J.length,j=Y-1;j>=0;--j)M.insertBefore(Ea(J[j],!0),Aa(f))}return _e(f),!0}return f instanceof Rt&&!$a(f)||(k==="noscript"||k==="noembed")&&C(/<\/no(script|embed)/i,f.innerHTML)?(_e(f),!0):(We&&f.nodeType===3&&(_=f.textContent,_=P(_,ko," "),_=P(_,To," "),f.textContent!==_&&(g(w.removed,{element:f.cloneNode()}),f.textContent=_)),me("afterSanitizeElements",f,null),!1)},hn=function(f,_,k){if(nn&&(_==="id"||_==="name")&&(k in L||k in Ua))return!1;if(!(Ao&&C(Ma,_))){if(!(tn&&C(Da,_))){if(!X[_]||en[_])return!1;if(!Po[_]){if(!C(Co,P(k,Yr,""))){if(!((_==="src"||_==="xlink:href"||_==="href")&&f!=="script"&&y(k,"data:")===0&&sn[f])){if(!(on&&!C(Ga,P(k,Yr,"")))){if(k)return!1}}}}}}return!0},gn=function(f){var _=void 0,k=void 0,M=void 0,J=void 0;me("beforeSanitizeAttributes",f,null);var Y=f.attributes;if(Y){var j={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X};for(J=Y.length;J--;){_=Y[J];var le=_,pt=le.name,vn=le.namespaceURI;if(k=A(_.value),M=v(pt),j.attrName=M,j.attrValue=k,j.keepAttr=!0,j.forceKeepAttr=void 0,me("uponSanitizeAttribute",f,j),k=j.attrValue,!j.forceKeepAttr&&(dn(pt,f),!!j.keepAttr)){if(C(/\/>/i,k)){dn(pt,f);continue}We&&(k=P(k,ko," "),k=P(k,To," "));var za=f.nodeName.toLowerCase();if(hn(za,M,k))try{vn?f.setAttributeNS(vn,pt,k):f.setAttribute(pt,k),h(w.removed)}catch{}}}me("afterSanitizeAttributes",f,null)}},ja=function T(f){var _=void 0,k=mn(f);for(me("beforeSanitizeShadowDOM",f,null);_=k.nextNode();)me("uponSanitizeShadowNode",_,null),!fn(_)&&(_.content instanceof q&&T(_.content),gn(_));me("afterSanitizeShadowDOM",f,null)};return w.sanitize=function(T,f){var _=void 0,k=void 0,M=void 0,J=void 0,Y=void 0;if(T||(T="<!-->"),typeof T!="string"&&!dt(T)){if(typeof T.toString!="function")throw O("toString is not a function");if(T=T.toString(),typeof T!="string")throw O("dirty is not a string, aborting")}if(!w.isSupported){if(ct(x.toStaticHTML)==="object"||typeof x.toStaticHTML=="function"){if(typeof T=="string")return x.toStaticHTML(T);if(dt(T))return x.toStaticHTML(T.outerHTML)}return T}if(No||Lo(f),w.removed=[],typeof T=="string"&&(ut=!1),!ut)if(T instanceof He)_=pn("<!---->"),k=_.ownerDocument.importNode(T,!0),k.nodeType===1&&k.nodeName==="BODY"||k.nodeName==="HTML"?_=k:_.appendChild(k);else{if(!Ve&&!We&&!lt&&T.indexOf("<")===-1)return be&&Dt?be.createHTML(T):T;if(_=pn(T),!_)return Ve?null:Xr}_&&Ro&&_e(_.firstChild);for(var j=mn(ut?T:_);M=j.nextNode();)M.nodeType===3&&M===J||fn(M)||(M.content instanceof q&&ja(M.content),gn(M),J=M);if(J=null,ut)return T;if(Ve){if(Mt)for(Y=Pa.call(_.ownerDocument);_.firstChild;)Y.appendChild(_.firstChild);else Y=_;return rn&&(Y=La.call(R,Y,!0)),Y}var le=lt?_.outerHTML:_.innerHTML;return We&&(le=P(le,ko," "),le=P(le,To," ")),be&&Dt?be.createHTML(le):le},w.setConfig=function(T){Lo(T),No=!0},w.clearConfig=function(){Ke=null,No=!1},w.isValidAttribute=function(T,f,_){Ke||Lo({});var k=v(T),M=v(f);return hn(k,M,_)},w.addHook=function(T,f){typeof f=="function"&&(ce[T]=ce[T]||[],g(ce[T],f))},w.removeHook=function(T){ce[T]&&h(ce[T])},w.removeHooks=function(T){ce[T]&&(ce[T]=[])},w.removeAllHooks=function(){ce={}},w}var wa=qr();return wa})});var ca=Ut(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});function Xd(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Et=Xd((Q(),Ha(Wa)));function vo(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vo=function(t){return typeof t}:vo=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(e)}function Jd(e){return Yd(e)||Qd(e)||Zd()}function Yd(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}function Qd(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function Zd(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var go=typeof window<"u";function ep(e){return Array.isArray(e)||vo(e)==="object"?Object.freeze(e):e}function tp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.reduce(function(o,r){var s=r.passengers[0],a=typeof s=="function"?s(t):r.passengers;return o.concat(a)},[])}function op(e,t){return e.map(function(o,r){return[r,o]}).sort(function(o,r){return t(o[1],r[1])||o[0]-r[0]}).map(function(o){return o[1]})}function ia(e,t){return t.reduce(function(o,r){return e.hasOwnProperty(r)&&(o[r]=e[r]),o},{})}var sa={},rp={},np={},ip=Et.extend({data:function(){return{transports:sa,targets:rp,sources:np,trackInstances:go}},methods:{open:function(t){if(go){var o=t.to,r=t.from,s=t.passengers,a=t.order,n=a===void 0?1/0:a;if(!(!o||!r||!s)){var l={to:o,from:r,passengers:ep(s),order:n},m=Object.keys(this.transports);m.indexOf(o)===-1&&Et.set(this.transports,o,[]);var p=this.$_getTransportIndex(l),i=this.transports[o].slice(0);p===-1?i.push(l):i[p]=l,this.transports[o]=op(i,function(u,d){return u.order-d.order})}}},close:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=t.to,s=t.from;if(!(!r||!s&&o===!1)&&this.transports[r])if(o)this.transports[r]=[];else{var a=this.$_getTransportIndex(t);if(a>=0){var n=this.transports[r].slice(0);n.splice(a,1),this.transports[r]=n}}},registerTarget:function(t,o,r){go&&(this.trackInstances&&!r&&this.targets[t]&&console.warn("[portal-vue]: Target ".concat(t," already exists")),this.$set(this.targets,t,Object.freeze([o])))},unregisterTarget:function(t){this.$delete(this.targets,t)},registerSource:function(t,o,r){go&&(this.trackInstances&&!r&&this.sources[t]&&console.warn("[portal-vue]: source ".concat(t," already exists")),this.$set(this.sources,t,Object.freeze([o])))},unregisterSource:function(t){this.$delete(this.sources,t)},hasTarget:function(t){return!!(this.targets[t]&&this.targets[t][0])},hasSource:function(t){return!!(this.sources[t]&&this.sources[t][0])},hasContentFor:function(t){return!!this.transports[t]&&!!this.transports[t].length},$_getTransportIndex:function(t){var o=t.to,r=t.from;for(var s in this.transports[o])if(this.transports[o][s].from===r)return+s;return-1}}}),ne=new ip(sa),sp=1,jr=Et.extend({name:"portal",props:{disabled:{type:Boolean},name:{type:String,default:function(){return String(sp++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}}},created:function(){var t=this;this.$nextTick(function(){ne.registerSource(t.name,t)})},mounted:function(){this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){ne.unregisterSource(this.name),this.clear()},watch:{to:function(t,o){o&&o!==t&&this.clear(o),this.sendUpdate()}},methods:{clear:function(t){var o={from:this.name,to:t||this.to};ne.close(o)},normalizeSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},normalizeOwnChildren:function(t){return typeof t=="function"?t(this.slotProps):t},sendUpdate:function(){var t=this.normalizeSlots();if(t){var o={from:this.name,to:this.to,passengers:Jd(t),order:this.order};ne.open(o)}else this.clear()}},render:function(t){var o=this.$slots.default||this.$scopedSlots.default||[],r=this.tag;return o&&this.disabled?o.length<=1&&this.slim?this.normalizeOwnChildren(o)[0]:t(r,[this.normalizeOwnChildren(o)]):this.slim?t():t(r,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}}),zr=Et.extend({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},data:function(){return{transports:ne.transports,firstRender:!0}},created:function(){var t=this;this.$nextTick(function(){ne.registerTarget(t.name,t)})},watch:{ownTransports:function(){this.$emit("change",this.children().length>0)},name:function(t,o){ne.unregisterTarget(o),ne.registerTarget(t,this)}},mounted:function(){var t=this;this.transition&&this.$nextTick(function(){t.firstRender=!1})},beforeDestroy:function(){ne.unregisterTarget(this.name)},computed:{ownTransports:function(){var t=this.transports[this.name]||[];return this.multiple?t:t.length===0?[]:[t[t.length-1]]},passengers:function(){return tp(this.ownTransports,this.slotProps)}},methods:{children:function(){return this.passengers.length!==0?this.passengers:this.$scopedSlots.default?this.$scopedSlots.default(this.slotProps):this.$slots.default||[]},noWrapper:function(){var t=this.slim&&!this.transition;return t&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),t}},render:function(t){var o=this.noWrapper(),r=this.children(),s=this.transition||this.tag;return o?r[0]:this.slim&&!s?t():t(s,{props:{tag:this.transition&&this.tag?this.tag:void 0},class:{"vue-portal-target":!0}},r)}}),ap=0,cp=["disabled","name","order","slim","slotProps","tag","to"],lp=["multiple","transition"],aa=Et.extend({name:"MountingPortal",inheritAttrs:!1,props:{append:{type:[Boolean,String]},bail:{type:Boolean},mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:function(){return"mounted_"+String(ap++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}},multiple:{type:Boolean,default:!1},targetSlim:{type:Boolean},targetSlotProps:{type:Object,default:function(){return{}}},targetTag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},created:function(){if(!(typeof document>"u")){var t=document.querySelector(this.mountTo);if(!t){console.error("[portal-vue]: Mount Point '".concat(this.mountTo,"' not found in document"));return}var o=this.$props;if(ne.targets[o.name]){o.bail?console.warn("[portal-vue]: Target ".concat(o.name,` is already mounted.
        Aborting because 'bail: true' is set`)):this.portalTarget=ne.targets[o.name];return}var r=o.append;if(r){var s=typeof r=="string"?r:"DIV",a=document.createElement(s);t.appendChild(a),t=a}var n=ia(this.$props,lp);n.slim=this.targetSlim,n.tag=this.targetTag,n.slotProps=this.targetSlotProps,n.name=this.to,this.portalTarget=new zr({el:t,parent:this.$parent||this,propsData:n})}},beforeDestroy:function(){var t=this.portalTarget;if(this.append){var o=t.$el;o.parentNode.removeChild(o)}t.$destroy()},render:function(t){if(!this.portalTarget)return console.warn("[portal-vue] Target wasn't mounted"),t();if(!this.$scopedSlots.manual){var o=ia(this.$props,cp);return t(jr,{props:o,attrs:this.$attrs,on:this.$listeners,scopedSlots:this.$scopedSlots},this.$slots.default)}var r=this.$scopedSlots.manual({to:this.to});return Array.isArray(r)&&(r=r[0]),r||t()}});function up(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.component(t.portalName||"Portal",jr),e.component(t.portalTargetName||"PortalTarget",zr),e.component(t.MountingPortalName||"MountingPortal",aa)}var dp={install:up};ze.default=dp;ze.Portal=jr;ze.PortalTarget=zr;ze.MountingPortal=aa;ze.Wormhole=ne});var xt=class{#e;#r=0;#n="";#o=!1;#t=0;constructor(t,o=""){this.#e=new Array(t).fill(o),this.#r=t,this.#n=o}add(t){let o=this.#r,r=this.#t;this.#e[r]=t,r===o-1&&(this.#o=!0),this.#t=(r+1)%o}addAll(t){for(let o of t)this.add(o)}clear(){this.#e.fill(this.#n),this.#o=!1,this.#t=0}toArray(){let t=this.#e,o=this.#t;return this.#o?[...t.slice(o),...t.slice(0,o)]:t.slice(0,o)}};var Fi=["debug","error","info","log","warn"],Jo=console,Ka=(...e)=>{};async function Ui(e,{getItem:t,removeItem:o,setItem:r}){let s=new xt(e.maxEntries),a=Object.fromEntries(Fi.map(i=>[i,(...u)=>{Jo[i](...u),Xa(m,i,e.source,...u)}])),n=[],l=new Proxy({...a},{get(i,u,d){return Reflect.has(i,u)?Reflect.get(i,u,d):Reflect.get(Jo,u,d)},has(i,u){return Reflect.has(Jo,u)}}),m={get appLogsFilter(){return[...n]},console:l,entries:s,async clear(){await o("entries"),s.clear()},async save(){try{await r("entries",this.entries.toArray())}catch(i){l.error(i)}},setAppLogsFilter(i){n.splice(0,n.length,...i);for(let u of Fi)l[u]=n.includes(u)?a[u]:Ka}},p=await(async()=>{try{let i=await t("entries");return i?JSON.parse(i):[]}catch(i){return l.error("Failed to parse stored entries:",i),[]}})();return e.maxEntries<p.length&&p.splice(0,p.length-e.maxEntries),p.length&&m.entries.addAll(p),m}function Xa(e,t,o,...r){let s={timestamp:new Date().toISOString(),source:o,type:t,msg:r.map(a=>{try{let n=new WeakSet;return JSON.parse(JSON.stringify(a,(l,m)=>{if(m instanceof Error)return{name:m.name,message:m.message,stack:m.stack};if(typeof m=="object"&&m!==null){if(n.has(m))return"[Circular Reference]";n.add(m)}return m}))}catch(n){return`[captureLogs failed to stringify argument of type '${typeof a}'. Err: ${n.message}]`}})};e.entries.add(s),c("sbp/selectors/fn","okTurtles.events/emit")(Pe,s)}var Te=new Map,yp=c("sbp/selectors/register",{"okTurtles.data/get":function(e){return Te.get(e)},"okTurtles.data/set":function(e,t){return Te.set(e,t),t},"okTurtles.data/delete":function(e){return Te.delete(e)},"okTurtles.data/add":function(e,t){let o=Te.get(e);o?o.push(t):Te.set(e,[t])},"okTurtles.data/remove":function(e,t){let o=Te.get(e);if(o){let r=o.length,s=o.filter(a=>a!==t);return Te.set(e,s),r-s.length}},"okTurtles.data/apply":function(e,t){return t(Te.get(e))}});var oo=e=>`events/${e}/listeners`,Ip=c("sbp/selectors/register",{"okTurtles.events/_init":function(){this.errorHandler=(e,t)=>{console.error(`[okTurtles.events] Error at handler for ${e}`,t)}},"okTurtles.events/on":function(e,t){return c("okTurtles.data/add",oo(e),t),()=>c("okTurtles.events/off",e,t)},"okTurtles.events/once":function(e,t){let o=(...r)=>{t(...r),c("okTurtles.events/off",e,o)};return c("okTurtles.events/on",e,o)},"okTurtles.events/emit":function(e,...t){var o;for(let r of c("okTurtles.data/get",oo(e))||[])try{r(...t)}catch(s){(o=this.errorHandler)===null||o===void 0||o.call(this,e,s)}},"okTurtles.events/off":function(e,t){t?c("okTurtles.data/remove",oo(e),t):c("okTurtles.data/delete",oo(e))},"okTurtles.events/setErrorHandler":function(e){this.errorHandler=e}});var $i=e=>{};var Bi={maxEntries:Un,source:"browser"},Yo=self.console,Ce=null,Ge="",Ja=e=>sessionStorage.getItem(`giConsole/${Ge}/${e}`),Ya=e=>sessionStorage.removeItem(`giConsole/${Ge}/${e}`),ji=(e,t)=>{sessionStorage.setItem(`giConsole/${Ge}/${e}`,typeof t=="string"?t:JSON.stringify(t))};async function Qa(e){Ge=e,Ce=await Ui(Bi,{getItem:Ja,removeItem:Ya,setItem:ji}),ji("config",Bi),Ce.setAppLogsFilter(c("state/vuex/state").settings?.appLogsFilter??[]),c("okTurtles.events/on",Le,Ce.setAppLogsFilter),self.console=Ce.console;let t=!sessionStorage.getItem("NEW_SESSION");t&&sessionStorage.setItem("NEW_SESSION","1"),Yo.log(t?"NEW_SESSION":"NEW_VISIT","Starting to capture logs of type:",Ce.appLogsFilter)}async function Za({wipeOut:e}){e&&await zi(),c("okTurtles.events/off",Le),console.log("captureLogs paused"),self.console=Yo}async function zi(){await Ce?.clear()}window.addEventListener("visibilitychange",e=>c("appLogs/save").catch(t=>{console.error("Error saving logs during visibilitychange event handler",t)}));$i(Yo);var Mp=c("sbp/selectors/register",{"appLogs/get"(){return Ce?.entries.toArray()??[]},async"appLogs/save"(){await Ce?.save()},"appLogs/pauseCapture":Za,"appLogs/startCapture":Qa,async"appLogs/clearLogs"(e){let t=Ge;Ge=e;try{await zi()}catch{}Ge=t}});var Hi=e=>Object.prototype.hasOwnProperty.call(e,"sbpInvocation"),Fp=c("sbp/selectors/register",{"okTurtles.eventQueue/_init":function(){this.eventQueues=Object.create(null)},"okTurtles.eventQueue/isWaiting":function(e){var t;return!!(!((t=this.eventQueues[e])===null||t===void 0)&&t.length)},"okTurtles.eventQueue/queuedInvocations":function(e){var t,o;return e==null?Object.fromEntries(Object.entries(this.eventQueues).map(([r,s])=>[r,s.map(a=>Hi(a)?a.sbpInvocation:a.fn)])):(o=(t=this.eventQueues[e])===null||t===void 0?void 0:t.map(r=>Hi(r)?r.sbpInvocation:r.fn))!==null&&o!==void 0?o:[]},"okTurtles.eventQueue/queueEvent":async function(e,t){Object.prototype.hasOwnProperty.call(this.eventQueues,e)||(this.eventQueues[e]=[]);let o=this.eventQueues[e],r,s=new Promise(n=>{r=n}),a=typeof t=="function"?{fn:t,promise:s}:{sbpInvocation:t,promise:s};for(o.push(a);o.length>0;){let n=o[0];if(n===a)try{return typeof t=="function"?await t():await c(...t)}finally{r(),o.shift()}else await n.promise}}});var ua=Re(Vi());var Qo=function(){function e(t,o){for(var r=0;r<o.length;r++){var s=o[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}();function Zo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(function(){if(typeof window>"u")return;var e=Array.prototype.slice,t=Element.prototype.matches||Element.prototype.msMatchesSelector,o=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","details","summary","iframe","object","embed","[contenteditable]"].join(","),r=function(){function p(i,u){Zo(this,p),this._inertManager=u,this._rootElement=i,this._managedNodes=new Set,this._rootElement.hasAttribute("aria-hidden")?this._savedAriaHidden=this._rootElement.getAttribute("aria-hidden"):this._savedAriaHidden=null,this._rootElement.setAttribute("aria-hidden","true"),this._makeSubtreeUnfocusable(this._rootElement),this._observer=new MutationObserver(this._onMutation.bind(this)),this._observer.observe(this._rootElement,{attributes:!0,childList:!0,subtree:!0})}return Qo(p,[{key:"destructor",value:function(){this._observer.disconnect(),this._rootElement&&(this._savedAriaHidden!==null?this._rootElement.setAttribute("aria-hidden",this._savedAriaHidden):this._rootElement.removeAttribute("aria-hidden")),this._managedNodes.forEach(function(u){this._unmanageNode(u.node)},this),this._observer=null,this._rootElement=null,this._managedNodes=null,this._inertManager=null}},{key:"_makeSubtreeUnfocusable",value:function(u){var d=this;n(u,function(E){return d._visitNode(E)});var h=document.activeElement;if(!document.body.contains(u)){for(var g=u,v=void 0;g;){if(g.nodeType===Node.DOCUMENT_FRAGMENT_NODE){v=g;break}g=g.parentNode}v&&(h=v.activeElement)}u.contains(h)&&(h.blur(),h===document.activeElement&&document.body.focus())}},{key:"_visitNode",value:function(u){if(u.nodeType===Node.ELEMENT_NODE){var d=u;d!==this._rootElement&&d.hasAttribute("inert")&&this._adoptInertRoot(d),(t.call(d,o)||d.hasAttribute("tabindex"))&&this._manageNode(d)}}},{key:"_manageNode",value:function(u){var d=this._inertManager.register(u,this);this._managedNodes.add(d)}},{key:"_unmanageNode",value:function(u){var d=this._inertManager.deregister(u,this);d&&this._managedNodes.delete(d)}},{key:"_unmanageSubtree",value:function(u){var d=this;n(u,function(h){return d._unmanageNode(h)})}},{key:"_adoptInertRoot",value:function(u){var d=this._inertManager.getInertRoot(u);d||(this._inertManager.setInert(u,!0),d=this._inertManager.getInertRoot(u)),d.managedNodes.forEach(function(h){this._manageNode(h.node)},this)}},{key:"_onMutation",value:function(u,d){u.forEach(function(h){var g=h.target;if(h.type==="childList")e.call(h.addedNodes).forEach(function(E){this._makeSubtreeUnfocusable(E)},this),e.call(h.removedNodes).forEach(function(E){this._unmanageSubtree(E)},this);else if(h.type==="attributes"){if(h.attributeName==="tabindex")this._manageNode(g);else if(g!==this._rootElement&&h.attributeName==="inert"&&g.hasAttribute("inert")){this._adoptInertRoot(g);var v=this._inertManager.getInertRoot(g);this._managedNodes.forEach(function(E){g.contains(E.node)&&v._manageNode(E.node)})}}},this)}},{key:"managedNodes",get:function(){return new Set(this._managedNodes)}},{key:"hasSavedAriaHidden",get:function(){return this._savedAriaHidden!==null}},{key:"savedAriaHidden",set:function(u){this._savedAriaHidden=u},get:function(){return this._savedAriaHidden}}]),p}(),s=function(){function p(i,u){Zo(this,p),this._node=i,this._overrodeFocusMethod=!1,this._inertRoots=new Set([u]),this._savedTabIndex=null,this._destroyed=!1,this.ensureUntabbable()}return Qo(p,[{key:"destructor",value:function(){if(this._throwIfDestroyed(),this._node&&this._node.nodeType===Node.ELEMENT_NODE){var u=this._node;this._savedTabIndex!==null?u.setAttribute("tabindex",this._savedTabIndex):u.removeAttribute("tabindex"),this._overrodeFocusMethod&&delete u.focus}this._node=null,this._inertRoots=null,this._destroyed=!0}},{key:"_throwIfDestroyed",value:function(){if(this.destroyed)throw new Error("Trying to access destroyed InertNode")}},{key:"ensureUntabbable",value:function(){if(this.node.nodeType===Node.ELEMENT_NODE){var u=this.node;if(t.call(u,o)){if(u.tabIndex===-1&&this.hasSavedTabIndex)return;u.hasAttribute("tabindex")&&(this._savedTabIndex=u.tabIndex),u.setAttribute("tabindex","-1"),u.nodeType===Node.ELEMENT_NODE&&(u.focus=function(){},this._overrodeFocusMethod=!0)}else u.hasAttribute("tabindex")&&(this._savedTabIndex=u.tabIndex,u.removeAttribute("tabindex"))}}},{key:"addInertRoot",value:function(u){this._throwIfDestroyed(),this._inertRoots.add(u)}},{key:"removeInertRoot",value:function(u){this._throwIfDestroyed(),this._inertRoots.delete(u),this._inertRoots.size===0&&this.destructor()}},{key:"destroyed",get:function(){return this._destroyed}},{key:"hasSavedTabIndex",get:function(){return this._savedTabIndex!==null}},{key:"node",get:function(){return this._throwIfDestroyed(),this._node}},{key:"savedTabIndex",set:function(u){this._throwIfDestroyed(),this._savedTabIndex=u},get:function(){return this._throwIfDestroyed(),this._savedTabIndex}}]),p}(),a=function(){function p(i){if(Zo(this,p),!i)throw new Error("Missing required argument; InertManager needs to wrap a document.");this._document=i,this._managedNodes=new Map,this._inertRoots=new Map,this._observer=new MutationObserver(this._watchForInert.bind(this)),l(i.head||i.body||i.documentElement),i.readyState==="loading"?i.addEventListener("DOMContentLoaded",this._onDocumentLoaded.bind(this)):this._onDocumentLoaded()}return Qo(p,[{key:"setInert",value:function(u,d){if(d){if(this._inertRoots.has(u))return;var h=new r(u,this);if(u.setAttribute("inert",""),this._inertRoots.set(u,h),!this._document.body.contains(u))for(var g=u.parentNode;g;)g.nodeType===11&&l(g),g=g.parentNode}else{if(!this._inertRoots.has(u))return;var v=this._inertRoots.get(u);v.destructor(),this._inertRoots.delete(u),u.removeAttribute("inert")}}},{key:"getInertRoot",value:function(u){return this._inertRoots.get(u)}},{key:"register",value:function(u,d){var h=this._managedNodes.get(u);return h!==void 0?h.addInertRoot(d):h=new s(u,d),this._managedNodes.set(u,h),h}},{key:"deregister",value:function(u,d){var h=this._managedNodes.get(u);return h?(h.removeInertRoot(d),h.destroyed&&this._managedNodes.delete(u),h):null}},{key:"_onDocumentLoaded",value:function(){var u=e.call(this._document.querySelectorAll("[inert]"));u.forEach(function(d){this.setInert(d,!0)},this),this._observer.observe(this._document.body||this._document.documentElement,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(u,d){var h=this;u.forEach(function(g){switch(g.type){case"childList":e.call(g.addedNodes).forEach(function(P){if(P.nodeType===Node.ELEMENT_NODE){var y=e.call(P.querySelectorAll("[inert]"));t.call(P,"[inert]")&&y.unshift(P),y.forEach(function(A){this.setInert(A,!0)},h)}},h);break;case"attributes":if(g.attributeName!=="inert")return;var v=g.target,E=v.hasAttribute("inert");h.setInert(v,E);break}},this)}}]),p}();function n(p,i,u){if(p.nodeType==Node.ELEMENT_NODE){var d=p;i&&i(d);var h=d.shadowRoot;if(h){n(h,i,h);return}if(d.localName=="content"){for(var g=d,v=g.getDistributedNodes?g.getDistributedNodes():[],E=0;E<v.length;E++)n(v[E],i,u);return}if(d.localName=="slot"){for(var P=d,y=P.assignedNodes?P.assignedNodes({flatten:!0}):[],A=0;A<y.length;A++)n(y[A],i,u);return}}for(var C=p.firstChild;C!=null;)n(C,i,u),C=C.nextSibling}function l(p){if(!p.querySelector("style#inert-style, link#inert-style")){var i=document.createElement("style");i.setAttribute("id","inert-style"),i.textContent=`
[inert] {
  pointer-events: none;
  cursor: default;
}

[inert], [inert] * {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
`,p.appendChild(i)}}var m=new a(document);Element.prototype.hasOwnProperty("inert")||Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(i){m.setInert(this,i)}})})();var Hp=c("sbp/selectors/register",{"chelonia/externalStateSetup":function({stateSelector:e,reactiveSet:t=Reflect.set.bind(Reflect),reactiveDel:o=Reflect.deleteProperty.bind(Reflect)}){this.stateSelector=e,c("okTurtles.events/on",Se,(r,s)=>{c("okTurtles.eventQueue/queueEvent",Se,async()=>{let{contractState:a,cheloniaState:n}=await c("chelonia/contract/fullState",r),l=c(e);n?(l.contracts||t(l,"contracts",Object.create(null)),t(l.contracts,r,F(n))):l.contracts&&o(l.contracts,r),a?t(l,r,F(a)):o(l,r),c("okTurtles.events/emit",Wo,r,s)})}),c("okTurtles.events/on",Ho,(r,{added:s,removed:a,permanent:n})=>{c("okTurtles.eventQueue/queueEvent",Se,async()=>{let l=s.length?await c("chelonia/contract/fullState",s):{},m=c("state/vuex/state");m.contracts||t(m,"contracts",Object.create(null)),a.forEach(p=>{n?t(m.contracts,p,null):o(m.contracts,p),o(m,p)});for(let p of s){let{contractState:i,cheloniaState:u}=l[p];u&&t(m.contracts,p,F(u)),i&&t(m,p,F(i))}c("okTurtles.events/emit",qn,r,{added:s,removed:a})})})},"chelonia/externalStateWait":async function(e){await c("chelonia/contract/wait",e);let{cheloniaState:t}=await c("chelonia/contract/fullState",e),o=c(this.stateSelector);if(!(!t||t.height<=o.contracts[e]?.height))return new Promise(r=>{let s=c("okTurtles.events/on",Wo,a=>{if(a!==e)return;let n=c(this.stateSelector);t.height<=n.contracts[e]?.height&&(r(),s())})})}});var qi=({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");e&&r.loggedIn?.identityContractID!==e||r[t]&&r.chatroom.currentChatRoomIDs[t]===o&&c("state/vuex/commit","setCurrentChatRoomId",{groupID:t})};c("okTurtles.events/on",Cn,({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");if(r.loggedIn?.identityContractID===e&&(!r.chatroom.currentChatRoomIDs[t]||r.chatroom.pendingChatRoomIDs[t]===o)){let s=0,a=()=>{if(c("state/vuex/state")[o]?.members?.[e])c("state/vuex/commit","setCurrentChatRoomId",{groupID:t,chatRoomID:o});else{if(++s>5){console.warn("[JOINED_CHATROOM] Given up on setCurrentChatRoomId after 5 attempts",{identityContractID:e,groupContractID:t,chatRoomID:o});return}setTimeout(a,5*Math.pow(1.75,s))}};a()}});c("okTurtles.events/on",En,qi);c("okTurtles.events/on",An,qi);c("okTurtles.events/on",ht,({chatRoomID:e,messageHash:t})=>{t?c("state/vuex/commit","setChatRoomScrollPosition",{chatRoomID:e,messageHash:t}):c("state/vuex/commit","deleteChatRoomScrollPosition",{chatRoomID:e})});c("okTurtles.events/on",gt,({chatRoomID:e,settings:t})=>{c("state/vuex/commit","setChatroomNotificationSettings",{chatRoomID:e,settings:t})});c("okTurtles.events/on",Tn,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");o.loggedIn?.identityContractID===e&&o[t]&&c("chelonia/contract/wait",t).then(()=>{if(!c("state/vuex/getters").ourGroups.includes(t))return;c("state/vuex/state")[t].generalChatRoomId||c("gi.ui/prompt",{heading:b("Error joining the #general chatroom"),question:b("There was an error joining the #general chatroom because it doesn't exist"),primaryButton:b("Close")})})});c("okTurtles.events/on",Nn,({identityContractID:e,groupContractID:t,chatRoomID:o})=>{let r=c("state/vuex/state");r.loggedIn?.identityContractID===e&&r[t]&&c("chelonia/contract/wait",t).then(()=>{if(!c("state/vuex/getters").ourGroups.includes(t))return;let a=c("state/vuex/state");a[t].chatRooms[o]?.members[e]?.status===Z.ACTIVE&&!a[o]?.members[e]&&c("gi.ui/prompt",{heading:b("Error joining chatroom"),question:b("There was an error joining the {chatRoomName} chatroom",{chatRoomName:a[t].chatRooms[o]?.name?`#${a[t].chatRooms[o].name}`:b("(unknown)")}),primaryButton:b("Close")})})});c("okTurtles.events/on",In,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");o.loggedIn?.identityContractID===e&&o[t]&&(o.currentGroupId||(c("state/vuex/commit","setCurrentGroupId",{contractID:t}),c("state/vuex/commit","setCurrentChatRoomId",{})))});c("okTurtles.events/on",kn,({identityContractID:e,groupContractID:t})=>{let o=c("state/vuex/state");if(o.loggedIn?.identityContractID!==e)return;let r=o[e],s=o.currentGroupId;if(!s||s===t){let a=Object.entries(r.groups).map(([n,{hasLeft:l}])=>!l&&n).filter(n=>n&&n!==t).sort(n=>c("state/vuex/state")[n]?.profiles?.[t]?-1:1)[0]||null;c("state/vuex/commit","setCurrentChatRoomId",{}),c("state/vuex/commit","setCurrentGroupId",{contractID:a,forceRefresh:s===t})}});c("okTurtles.events/on",Mn,([e,t])=>{c("state/vuex/commit","setLastLoggedIn",[e,t])});var ec=c("sbp/selectors/register",{"gi.app/group/createAndSwitch":async function(e){let t=await c("gi.actions/group/create",e);return c("gi.app/group/switch",t,!0),t},"gi.app/group/switch":function(e,t){c("okTurtles.events/emit",$t,{contractID:e,isNewlyCreated:t}),c("state/vuex/commit","setCurrentGroupId",{contractID:e,isNewlyCreated:t})},"gi.app/group/joinAndSwitch":async function(e){return await c("gi.actions/group/join",e),c("gi.app/group/switch",e.contractID,!0)},"gi.app/group/joinWithInviteSecret":async function(e,t){let o=await c("gi.actions/group/joinWithInviteSecret",e,t);return c("gi.app/group/switch",e,!0),o},"gi.app/group/addAndJoinChatRoom":async function(e){let t=await c("gi.actions/group/addAndJoinChatRoom",e);return c("state/vuex/commit","setPendingChatRoomId",{chatRoomID:t,groupID:e.contractID}),t},"gi.app/group/checkGroupSizeAndProposeMember":async function(){let{groupMembersCount:t,currentGroupState:o}=c("state/vuex/getters"),r=Object.values(o.invites||{}).filter(a=>a.creatorID!==Ze).length;if(t+r>=Yn){let a={a_:`<a class='link' href='${zt.WIKIPEDIA_DUNBARS_NUMBER}' target='_blank'>`,_a:"</a>"},n={heading:"Large group size",question:b("Group sizes are limited to {a_}Dunbar's Number{_a} to prevent fraud.",a),primaryButton:b("OK")},l=await c("gi.ui/prompt",n);return!1}else c("okTurtles.events/emit",z,"AddMembers")},"gi.app/group/checkAndSeeProposal":function({contractID:e,data:t}){let o=c("state/vuex/getters");c("state/vuex/state").currentGroupId!==e&&c("state/vuex/commit","setCurrentGroupId",{contractID:e}),Object.keys(o.currentGroupState.proposals||{}).includes(t.proposalHash)?c("controller/router").push({path:"/dashboard#proposals"}):c("okTurtles.events/emit",z,"PropositionsAllModal",{targetProposal:t.proposalHash})},"gi.app/group/displayMincomeChangedPrompt":async function({contractID:e,data:t}){let o=c("state/vuex/getters");c("state/vuex/state").currentGroupId!==e&&c("state/vuex/commit","setCurrentGroupId",{contractID:e});let{withGroupCurrency:s}=o,a=t.increased?{heading:b("Mincome changed"),question:b("Do you make at least {amount} per month?",{amount:s(t.amount)}),primaryButton:t.memberType==="pledging"?b("No"):b("Yes"),secondaryButton:t.memberType==="pledging"?b("Yes"):b("No")}:{heading:b("Automatically switched to pledging {zero}",{zero:s(0)}),question:b("You now make more than the mincome. Would you like to increase your pledge?"),primaryButton:b("Yes"),secondaryButton:b("No")};await c("gi.ui/prompt",a)&&c("okTurtles.events/emit",mt,"IncomeDetails")}});Q();var G=Re(Va()),Ji=Re(qa());var er="AUTHSALT",tr="CONTRACTSALT",Ki="CS",Xi="SU";var no=e=>e.replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,""),Yi=e=>e.replace(/_/g,"/").replace(/-/g,"+")+"=".repeat((4-e.length%4)%4),ot=(...e)=>G.default.hash(Buffer.concat(e.map(t=>G.default.hash(Buffer.from(t))))),Qi=(...e)=>G.default.hash(Buffer.concat(e.map(t=>Buffer.from(t)))),or=()=>no(Buffer.from(G.default.randomBytes(12)).toString("base64")),io=e=>no(Buffer.from(G.default.hash(Buffer.from(e))).toString("base64")),rr=(e,t,o)=>{let r=ot(e,t),s=ot(o,r),a=G.default.hash(s);return[s,a]};var so=(e,t)=>{let o=Qi(Ki,e).slice(0,G.default.secretbox.keyLength),r=Buffer.from(Yi(t),"base64"),s=r.slice(0,G.default.secretbox.nonceLength),a=r.slice(G.default.secretbox.nonceLength);return Buffer.from(G.default.secretbox.open(a,s,o)).toString()};var wt=(e,t)=>new Promise(o=>(0,Ji.default)(e,t,{N:16384,r:8,p:1,dkLen:32,encoding:"hex"},o)),Zi=()=>G.default.box.keyPair(),tc=(e,t)=>{let o=Buffer.from(Yi(e),"base64"),r=G.default.box.before(o,t);if(!o||o.byteLength!==G.default.box.publicKeyLength)return!1;let s=Buffer.from(ot(er,r)).slice(0,24).toString("base64"),a=Buffer.from(ot(tr,r)).slice(0,24).toString("base64");return[s,a]};var es=async(e,t,o)=>{let r=tc(e,t);if(!r)throw new Error("Invalid public or secret key");let[s,a]=r,n=await wt(o,s),l=G.default.randomBytes(G.default.box.nonceLength),m=G.default.hash(Buffer.from(s+a)).slice(0,G.default.secretbox.keyLength),p=G.default.secretbox(Buffer.from(n),l,m);return[a,no(Buffer.concat([l,p]).toString("base64")),m]},ts=async(e,t)=>{let o=Buffer.from(ot(er,t)).slice(0,24).toString("base64"),r=Buffer.from(ot(tr,t)).slice(0,24).toString("base64"),s=Qi(Xi,t).slice(0,G.default.secretbox.keyLength),a=G.default.randomBytes(G.default.secretbox.nonceLength),n=await wt(e,o),l=G.default.secretbox(Buffer.from(n),a,s),m=Buffer.concat([a,l]);return[r,no(m.toString("base64"))]};var os=[],St={async ready(){await Promise.all(os.map(e=>e()))},createInstance({name:e,storeName:t}){let o=(()=>{let r;return()=>(r||(r=new Promise((s,a)=>{if(e.includes("-")||t.includes("-")){a(new Error("Unsupported characters in name: -"));return}let n=l=>{let m=self.indexedDB.open(e+"--"+t,l);m.onupgradeneeded=p=>{p.target.result.createObjectStore(t)},m.onsuccess=p=>{let i=p.target.result;if(!i.objectStoreNames.contains(t))return n(i.version+1);s(i)},m.onerror=p=>{a(p)},m.onblocked=p=>{a(new Error("DB is blocked"))}};n()})),r)})();return os.push(o),{async clear(){let n=(await o()).transaction([t],"readwrite").objectStore(t).clear();return new Promise((l,m)=>{n.onsuccess=()=>{l()},n.onerror=p=>{m(p)}})},async getItem(r){let l=(await o()).transaction([t],"readonly").objectStore(t).get(r);return new Promise((m,p)=>{l.onsuccess=i=>{m(i.target.result)},l.onerror=i=>{p(i)}})},async removeItem(r){let l=(await o()).transaction([t],"readwrite").objectStore(t).delete(r);return new Promise((m,p)=>{l.onsuccess=()=>{m()},l.onerror=i=>{p(i.target.error)}})},async setItem(r,s){let m=(await o()).transaction([t],"readwrite").objectStore(t).put(s,r);return new Promise((p,i)=>{m.onsuccess=()=>{p()},m.onerror=u=>{i(u.target.error)}})}}}},oc=async e=>{let t=ti(fe),o=_t(t),r=Ie(t,!0),s=Ie(t,!1),a=oi(),n=await e(o,a),l=Vo(n,r,o);return{encryptionParams:{stateEncryptionKeyId:o,salt:a,encryptedStateEncryptionKey:l},stateEncryptionKeyP:s}},de=St.createInstance({name:"Group Income",storeName:"Settings"}),lo=class extends Error{},ns="@settings/currentUser",is="CHELONIA_STATE";c("sbp/selectors/register",{"gi.db/ready":function(){return St.ready()},"gi.db/settings/save":function(e,t){return de.setItem("u"+e,t)},"gi.db/settings/load":function(e){return de.getItem("u"+e)},"gi.db/settings/delete":function(e){return de.removeItem("u"+e)},"gi.db/settings/saveEncrypted":async function(e,t,o){let{stateEncryptionKeyId:r,salt:s,encryptedStateEncryptionKey:a}=o,n=await de.getItem("k"+r);if(!n)throw new Error(`Unable to retrieve the key corresponding to key ID ${r}`);let l=Vo(n,JSON.stringify(t),e);return de.setItem("e"+e,`${btoa(r)}.${btoa(s)}.${btoa(a)}.${btoa(l)}`).finally(()=>{c("gi.db/settings/delete",e).catch(m=>{console.error("[gi.db/settings/saveEncrypted] Error deleting unencrypted data for key",e,m)})})},"gi.db/settings/loadEncrypted":function(e,t){return de.getItem("e"+e).then(async o=>{if(!o||typeof o!="string")throw new lo(`Unable to retrive state for ${e||""}`);let[r,s,a,n]=o.split(".").map(u=>atob(u)),l=await t(r,s),m=qo(l,a,r),p=_t(m);if(p!==r)throw new Error(`Invalid state key ID: expected ${r} but got ${p}`);let i=JSON.parse(qo(m,n,e||""));return await de.setItem("k"+r,m),{encryptionParams:{stateEncryptionKeyId:r,salt:s,encryptedStateEncryptionKey:a},value:i}}).catch(async o=>{if(!t)throw o;o instanceof lo||console.warn("Error while retrieving local state",o);let{encryptionParams:r,stateEncryptionKeyP:s}=await oc(t);return await de.setItem("k"+r.stateEncryptionKeyId,s),{encryptionParams:r,value:null}})},"gi.db/settings/deleteStateEncryptionKey":function({stateEncryptionKeyId:e}){return de.removeItem("k"+e)},"gi.db/settings/deleteEncrypted":function(e){return de.removeItem("e"+e)}});var ie=St.createInstance({name:"Group Income",storeName:"Files Cache"}),rs=100;c("sbp/selectors/register",{"gi.db/filesCache/save":async function(e,t){if(e.startsWith("__"))throw new Error("Invalid key");let o=await ie.getItem("keys")??[];return c("okTurtles.eventQueue/queueEvent","gi.db/files",()=>ie.setItem(e,t).then(async r=>{console.log("successfully saved:",e);let s=o.indexOf(e);if(s!==-1&&o.splice(s,1),o.push(e),o.length>rs){let a=o.splice(0,o.length-rs);await Promise.all(a.map(n=>ie.removeItem(n)))}await ie.setItem("keys",o)}).catch(r=>{console.error("error saving:",e,r)}))},"gi.db/filesCache/load":async function(e){if(e.startsWith("__"))throw new Error("Invalid key");let t=await ie.getItem(e);return t&&c("okTurtles.eventQueue/queueEvent","gi.db/files",async()=>{let o=await ie.getItem("keys")??[],r=o.indexOf(e);r!==-1&&(o.splice(r,1),o.push(e),await ie.setItem("keys",o))}).catch(o=>{console.error("[gi.db/filesCache/load] Error updating keys")}),t},"gi.db/filesCache/delete":async function(e){if(e.startsWith("__"))throw new Error("Invalid key");await ie.removeItem(e),c("okTurtles.eventQueue/queueEvent","gi.db/files",async()=>{let t=await ie.getItem("keys")??[],o=t.indexOf(e);o!==-1&&(t.splice(o,1),await ie.setItem("keys",t))}).catch(t=>{console.error("[gi.db/filesCache/delete] Error updating keys")})},"gi.db/filesCache/clear":async function(){await ie.clear()}});var ao=St.createInstance({name:"Group Income",storeName:"Archive"});c("sbp/selectors/register",{"gi.db/archive/save":function(e,t){return ao.setItem(e,t)},"gi.db/archive/load":function(e){return ao.getItem(e)},"gi.db/archive/delete":function(e){return ao.removeItem(e)},"gi.db/archive/clear":function(){return ao.clear()}});var co=St.createInstance({name:"Group Income",storeName:"Logs"});c("sbp/selectors/register",{"gi.db/logs/save":function(e,t){return co.setItem(e,t)},"gi.db/logs/load":function(e){return co.getItem(e)},"gi.db/logs/delete":function(e){return co.removeItem(e)},"gi.db/logs/clear":function(){return co.clear()}});function Ee(e){return function(t){if(!t.ok){let o=`${t.status}: ${t.statusText}`;throw t.status===404||t.status===410?new _n(o,{cause:t.status}):new bn(o)}return t[e]()}}var rc=async(e,t)=>{if(t){let o=(a,n)=>ue(fe,t,n+a),{encryptionParams:r,value:s}=await c("gi.db/settings/loadEncrypted",e,o);if(s){let a=s.cheloniaState;return delete s.cheloniaState,{encryptionParams:r,state:s,cheloniaState:a}}else return{encryptionParams:r,state:null,cheloniaState:null}}else return{encryptionParams:null,state:await c("gi.db/settings/load",e),cheloniaState:null}};c("okTurtles.events/on",Je,async({identityContractID:e,encryptionParams:t,state:o})=>{await c("okTurtles.eventQueue/queueEvent",Se,async()=>{try{let r=c("state/vuex/state");if(r.loggedIn&&r.loggedIn.identityContractID!==e)throw console.error("Received login event during active session",{receivedIdentityContractID:e,existingIdentityContractID:r.loggedIn.identityContractID}),new Error("Received login event but there already is an active session");let s=F(await c("chelonia/rootState"));if(o)o.contracts&&Object.keys(o.contracts).forEach(n=>{delete o[n]}),Object.keys(s.contracts).forEach(n=>{s[n]&&(o[n]=s[n])}),o.contracts=s.contracts,s.namespaceLookups&&(o.namespaceLookups=s.namespaceLookups),c("state/vuex/postUpgradeVerification",o),c("state/vuex/replace",o);else{let n=r;n.contracts&&Object.keys(n.contracts).forEach(l=>{I.delete(n,l)}),Object.keys(s.contracts).forEach(l=>{s[l]&&I.set(n,l,s[l])}),I.set(n,"contracts",s.contracts),s.namespaceLookups&&I.set(n,"namespaceLookups",s.namespaceLookups),c("state/vuex/postUpgradeVerification",n)}t&&c("state/vuex/commit","login",{identityContractID:e,encryptionParams:t});let a=c("state/vuex/state");if(!a.currentGroupId){let n=Object.keys(a.contracts).find(l=>a[e].groups[l]&&!a[e].groups[l].hasLeft);n&&c("gi.app/group/switch",n)}c("gi.db/settings/deleteEncrypted",e).catch(n=>{console.error("Error deleting encrypted settings after login")}),c("okTurtles.events/emit",we,{identityContractID:e})}catch(r){c("okTurtles.events/emit",Oe,{identityContractID:e,error:r})}})});c("okTurtles.events/on",Dn,e=>{c("state/vuex/commit","setUnreadMessages",e)});c("okTurtles.events/on",Gn,e=>{c("state/vuex/commit","setPreferences",e)});var nc=c("sbp/selectors/register",{"gi.app/identity/retrieveSalt":async(e,t)=>{let o=or(),r=io(o),s=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/auth_hash?b=${encodeURIComponent(r)}`).then(Ee("json")),{authSalt:a,s:n,sig:l}=s,m=await wt(t.valueOf(),a),[p,i]=rr(o,n,m),u=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/contract_hash?${new URLSearchParams({r:o,s:n,sig:l,hc:Buffer.from(i).toString("base64").replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,"")}).toString()}`).then(Ee("text"));return JSON.parse(so(p,u))},"gi.app/identity/updateSaltRequest":async(e,t,o)=>{let r=or(),s=io(r),a=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/auth_hash?b=${encodeURIComponent(s)}`).then(Ee("json")),{authSalt:n,s:l,sig:m}=a,p=await wt(t.valueOf(),n),[i,u]=rr(r,l,p),[d,h]=await ts(o.valueOf(),i),g=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/${encodeURIComponent(e)}/updatePasswordHash`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`${new URLSearchParams({r,s:l,sig:m,hc:Buffer.from(u).toString("base64").replace(/\//g,"_").replace(/\+/g,"-").replace(/=*$/,""),Ea:h}).toString()}`}).then(Ee("text")),[v,E]=JSON.parse(so(i,g));return[d,v,E]},"gi.app/identity/create":async function({data:{username:e,email:t,password:o,picture:r},publishOptions:s}){o=o.valueOf();let a=Zi(),n=Buffer.from(a.publicKey).toString("base64").replace(/\//g,"_").replace(/\+/g,"-"),l=io(n),m=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/register/${encodeURIComponent(e)}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`b=${encodeURIComponent(l)}`}).then(Ee("json")),{p,s:i,sig:u}=m,[d,h,g]=await es(p,a.secretKey,o),v=await fetch(`${c("okTurtles.data/get","API_URL")}/zkpp/register/${encodeURIComponent(e)}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:new URLSearchParams({r:n,s:i,sig:u,Eh:h})});if(!v.ok)throw new Error("Unable to register hash");let E=await v.text(),P=so(g,E),y=await ue(Wt,o,d),A=await ue(fe,o,d);try{return await c("gi.actions/identity/create",{IPK:new te(Ie(y,!0)),IEK:new te(Ie(A,!0)),publishOptions:s,username:e,email:t,picture:r,token:new te(P)})}catch(C){throw console.error("gi.app/identity/create failed!",C),new xe(b("Failed to create user identity: {reportError}",Xe(C)))}},"gi.app/identity/signup":async function({username:e,email:t,password:o},r){try{let s=c("gi.utils/avatar/create");return await c("gi.app/identity/create",{data:{username:e,email:t,password:o,picture:s},publishOptions:r})}catch(s){console.error("gi.app/identity/signup failed!",s),await c("gi.app/identity/logout");let a=Xe(s);throw s.name==="GIErrorUIRuntimeError"&&(a.reportError=s.message),new xe(b("Failed to signup: {reportError}",a))}},"gi.app/identity/login":function({username:e,password:t,identityContractID:o}){return c("okTurtles.eventQueue/queueEvent","APP-LOGIN",async()=>{if(console.debug("[gi.app/identity/login] Scheduled call starting",o,e),e){let n=await c("namespace/lookup",e,{skipCache:!1});if(!o)o=n;else if(n!==o)throw console.error(new Error(`Identity contract ID mismatch during login: ${o} != ${n}`)),new xe(b("Identity contract ID mismatch during login"))}if(!o)throw new xe(b("Incorrect username or password"));let r=t?.valueOf(),s=[],a;if(r)try{let[n,l]=await c("gi.app/identity/retrieveSalt",o,t),m=await ue(fe,r,n);s.push(m),a=l}catch(n){throw console.error("caught error calling retrieveSalt:",n),new xe(b("Incorrect username or password"))}try{await c("appLogs/startCapture",o);let{state:n,cheloniaState:l,encryptionParams:m}=await rc(o,r),p,i;try{let u=new Promise((d,h)=>{let g=({identityContractID:y})=>{P(),y===o?d(c("state/vuex/save")):h(new Error(`Identity contract ID mismatch during login: ${o} != ${y}`))},v=({identityContractID:y,error:A})=>{E(),h(y===o?A:new Error(`Identity contract ID mismatch during login (on error): ${o} != ${y}`))},E=c("okTurtles.events/once",we,g),P=c("okTurtles.events/once",Oe,v)});if(r)await c("gi.actions/identity/login",{identityContractID:o,encryptionParams:m,cheloniaState:l,state:n,transientSecretKeys:new te(s.map(d=>Ie(d,!0))),oldKeysAnchorCid:a});else{try{await c("chelonia/contract/sync",o)}catch(d){throw u.catch(h=>{console.warn("[gi.app/identity/login] Error in login complete promise",h)}),d}c("okTurtles.events/emit",Je,{identityContractID:o,state:n})}await u}catch(u){c("okTurtles.events/off",we,p),c("okTurtles.events/off",Oe,i);let d=u?.message||String(u);console.error("[gi.app/identity] Error during login contract sync",u);let h=u&&(u.name==="ChelErrorForkedChain"||u.cause?.name==="ChelErrorForkedChain"),g=u&&(u.name==="ChelErrorResourceGone"||u.cause?.name==="ChelErrorResourceGone"),v={heading:b("Login error"),question:h?b("The server's history for your identity contract has diverged from ours. This can happen in extremely rare circumstances due to either malicious activity or a bug. {br_}To fix this, the contract needs to be resynced, and some recent events may be missing. {br_}Would you like to log out and resync data on your next login? {br_}Error details: {err}.",{err:d,...ye()}):g?b("Your account seems to have been deleted from the server. {br_}To fix this, you need to log out and create a new account. {br_}Error details: {err}.",{err:d,...ye()}):b("An error occurred while logging in. Please try logging in again. {br_}Error details: {err}.",{err:d,...ye()}),primaryButton:b("Log out"),primaryButtonStyle:"primary",isContentCentered:!h&&!g};if(await c("gi.ui/prompt",v))return c("gi.ui/clearBanner"),c("gi.app/identity/_private/logout",n,h);throw c("okTurtles.events/emit",Oe,{username:e,identityContractID:o,error:u}),u}return o}catch(n){console.error("gi.app/identity/login failed!",n);let l=b("Failed to log in: {reportError}",Xe(n));throw alert(l),await c("gi.app/identity/_private/logout").catch(m=>{console.error("[gi.app/identity/login] Error calling logout (after failure to login)",m)}),new xe(l)}})},"gi.app/identity/signupAndLogin":async function({username:e,email:t,password:o}){let r=await c("gi.app/identity/signup",{username:e,email:t,password:o});return await c("gi.app/identity/login",{username:e,password:o,identityContractID:r}),r},"gi.app/identity/_private/logout":async function(e,t){try{let o=e||F(c("state/vuex/state"));if(!o.loggedIn)return;let r=await c("gi.actions/identity/logout"),{identityContractID:s,encryptionParams:a}=o.loggedIn;a&&(t||(o.cheloniaState=r,Object.keys(r.contracts||{}).forEach(n=>{delete o[n]}),delete o.contracts,await c("state/vuex/save",!0,o)),await c("gi.db/settings/deleteStateEncryptionKey",a),await c("appLogs/pauseCapture",{wipeOut:!0})),t&&await Promise.all([c("gi.db/settings/delete",s),c("gi.db/settings/deleteEncrypted",s),c("gi.db/settings/delete",is)])}catch(o){console.error(`${o.name} during logout: ${o.message}`,o)}},"gi.app/identity/logout":(...e)=>c("okTurtles.eventQueue/queueEvent","APP-LOGIN",["gi.app/identity/_private/logout",...e]),"gi.app/identity/changePassword":async(e,t)=>{let o=c("state/vuex/state");if(!o.loggedIn)return;let r=c("state/vuex/getters"),{identityContractID:s}=o.loggedIn,a=r.usernameFromID(s),n=e.valueOf(),l=t.valueOf(),[m,p,i]=await c("gi.app/identity/updateSaltRequest",s,e,t),u=await ue(Wt,n,p),d=await ue(fe,n,p),h=await ue(Wt,l,m),g=await ue(fe,l,m);return c("gi.actions/identity/changePassword",{identityContractID:s,username:a,oldIPK:new te(u),oldIEK:new te(d),newIPK:new te(h),newIEK:new te(g),updateToken:new te(i)})},"gi.app/identity/delete":async(e,t)=>{let o=t?.valueOf(),r=[],s;if(o)try{let[a,n]=await c("gi.app/identity/retrieveSalt",e,t),l=await ue(fe,o,a);r.push(l),s=n}catch(a){throw console.error("caught error calling retrieveSalt:",a),new xe(b("Incorrect username or password"))}await c("gi.actions/identity/delete",{contractID:e,transientSecretKeys:new te(r.map(a=>Ie(a,!0))),oldKeysAnchorCid:s})}});var re=Object.freeze({ENTRY:"entry",DELETION:"deletion",KV:"kv",KV_FILTER:"kv_filter",PING:"ping",PONG:"pong",PUB:"pub",SUB:"sub",UNSUB:"unsub",VERSION_INFO:"version_info"}),Fe=Object.freeze({PUB:"pub",SUB:"sub",UNSUB:"unsub",PUSH_ACTION:"push_action",KV_FILTER:"kv_filter"}),ss=Object.freeze({ERROR:"error",OK:"ok"}),Em=Object.freeze({SEND_PUBLIC_KEY:"send-public-key",STORE_SUBSCRIPTION:"store-subscription",DELETE_SUBSCRIPTION:"delete-subscription",SEND_PUSH_NOTIFICATION:"send-push-notification"});var as="pubsub-error";var ic="pubsub-reconnection-failed";var sc="pubsub-reconnection-succeeded",ac="pubsub-subscription-succeeded";function cc(e,t,o){let r={...o,type:e,data:t},s,a=function(){return s||(s=JSON.stringify(this)),s};return Object.defineProperties(r,{[Symbol.toPrimitive]:{value:a}}),r}function lc(e,t){return JSON.stringify(Object.assign({type:e},t))}var uc={close(e){let t=this;if(console.debug("[pubsub] Event: close",e.code,e.reason),t.failedConnectionAttempts++,t.socket)for(let o of cs)t.socket.removeEventListener(o,t.listeners[o]);t.socket=null,t.clearAllTimers(),t.shouldReconnect&&t.subscriptionSet.forEach(o=>{t.pendingUnsubscriptionSet.has(o)||t.pendingSubscriptionSet.add(o)}),t.subscriptionSet.clear(),t.pendingUnsubscriptionSet.clear(),t.shouldReconnect&&t.options.reconnectOnDisconnection&&(t.failedConnectionAttempts>t.options.maxRetries?c("okTurtles.events/emit",ic,t):(!mc()||t.isLocal)&&t.scheduleConnectionAttempt())},error(e){let t=this;console.warn("[pubsub] Event: error",e),clearTimeout(t.pingTimeoutID)},message(e){let t=this,{data:o}=e;if(typeof o!="string")return c("okTurtles.events/emit",as,t,{message:`Wrong data type: ${typeof o}`}),t.destroy();let r={type:""};try{r=fc(o)}catch(a){return c("okTurtles.events/emit",as,t,{message:`Malformed message: ${a?.message}`}),t.destroy()}let s=t.messageHandlers[r.type];if(s)s.call(t,r);else throw new Error(`Unhandled message type: ${r.type}`)},offline(){console.info("[pubsub] Event: offline");let e=this;e.clearAllTimers(),e.failedConnectionAttempts=0,e.socket?.close()},online(){console.info("[pubsub] Event: online");let e=this;e.options.reconnectOnOnline&&e.shouldReconnect&&(e.socket||(e.failedConnectionAttempts=0,e.scheduleConnectionAttempt()))},open(){console.debug("[pubsub] Event: open");let e=this,{options:t}=this;e.connectionTimeUsed=void 0,e.clearAllTimers(),c("okTurtles.events/emit",sc,e),e.failedConnectionAttempts=-1,e.isNew=!1,t.pingTimeout>0&&t.pingTimeout<1/0&&(e.pingTimeoutID=setTimeout(()=>{e.socket?.close()},t.pingTimeout)),e.pendingSubscriptionSet.forEach(o=>{let r=this.kvFilter.get(o);e.socket?.send(lc(Fe.SUB,r?{channelID:o,kvFilter:r}:{channelID:o}))})},"reconnection-attempt"(){console.info("[pubsub] Trying to reconnect...")},"reconnection-succeeded"(){console.info("[pubsub] Connection re-established")},"reconnection-failed"(){console.warn("[pubsub] Reconnection failed"),this.destroy()},"reconnection-scheduled"(e){let{delay:t,nth:o}=e.detail;console.info(`[pubsub] Scheduled connection attempt ${o} in ~${t} ms`)},"subscription-succeeded"(e){let{channelID:t}=e.detail;console.debug(`[pubsub] Subscribed to channel ${t}`)}},Am={[re.ENTRY](e){console.debug("[pubsub] Received ENTRY:",e)},[re.PING]({data:e}){let t=this;t.options.logPingMessages&&console.debug(`[pubsub] Ping received in ${Date.now()-Number(e)} ms`),t.socket?.send(cc(re.PONG,e)),clearTimeout(t.pingTimeoutID),t.pingTimeoutID=setTimeout(()=>{t.socket?.close()},t.options.pingTimeout)},[re.PUB]({channelID:e,data:t}){console.log(`[pubsub] Received data from channel ${e}:`,t)},[re.KV]({channelID:e,key:t,data:o}){console.log(`[pubsub] Received KV update from channel ${e} ${t}:`,o)},[re.SUB](e){console.debug(`[pubsub] Ignoring ${e.type} message:`,e.data)},[re.UNSUB](e){console.debug(`[pubsub] Ignoring ${e.type} message:`,e.data)},[ss.ERROR]({data:e}){let{type:t,channelID:o,reason:r}=e;console.warn(`[pubsub] Received ERROR response for ${t} request to ${o}`);let s=this;switch(t){case Fe.SUB:{console.warn(`[pubsub] Could not subscribe to ${o}: ${r}`),s.pendingSubscriptionSet.delete(o);break}case Fe.UNSUB:{console.warn(`[pubsub] Could not unsubscribe from ${o}: ${r}`),s.pendingUnsubscriptionSet.delete(o);break}case Fe.PUSH_ACTION:{let{actionType:a,message:n}=e;console.warn(`[pubsub] Received ERROR for PUSH_ACTION request with the action type '${a}' and the following message: ${n}`);break}default:console.error(`[pubsub] Malformed response: invalid request type ${t}`)}},[ss.OK]({data:{type:e,channelID:t}}){let o=this;switch(e){case Fe.SUB:{o.pendingSubscriptionSet.delete(t),o.subscriptionSet.add(t),c("okTurtles.events/emit",ac,o,{channelID:t});break}case Fe.UNSUB:{console.debug(`[pubsub] Unsubscribed from ${t}`),o.pendingUnsubscriptionSet.delete(t),o.subscriptionSet.delete(t),o.kvFilter.delete(t);break}case Fe.KV_FILTER:{console.debug(`[pubsub] Set KV filter for ${t}`);break}default:console.error(`[pubsub] Malformed response: invalid request type ${e}`)}}},dc=["offline","online"],cs=["close","error","message","open"],pc=new Map;if(typeof self=="object"&&self instanceof EventTarget)for(let e of dc){let t=o=>pc.get(e)?.(o);self.addEventListener(e,t,!1)}var mc=()=>typeof navigator=="object"&&navigator.onLine===!1,fc=e=>{let t=JSON.parse(e);if(typeof t!="object"||t===null)throw new TypeError("Message is null or not an object");let{type:o}=t;if(typeof o!="string"||o==="")throw new TypeError("Message type must be a non-empty string");return t};for(let e of Object.keys(uc))(e==="error"||!cs.includes(e))&&c("okTurtles.events/on",`pubsub-${e}`,(t,o)=>{let r=new CustomEvent(e,{detail:o});t.listeners[e].call(t,r)});var ls="@instance/pubsub";var hc=new Map([["fr","french.json"]]);c("okTurtles.events/on",re.VERSION_INFO,e=>{if(e.GI_VERSION==="2.0.0"){sessionStorage.removeItem(re.VERSION_INFO);return}console.info("New Group Income version available:",e);try{let t=sessionStorage.getItem(re.VERSION_INFO);if(t){let o=JSON.parse(t);if(Array.isArray(o)&&!(Date.now()-o[0]>=2.5*De)&&e.GI_VERSION===o[1].GI_VERSION){console.warn("[NOTIFICATION_TYPE.VERSION_INFO] A different Group Income version is available, but reloading has failed to address it",{existingVersionInfo:o,versionInfo:e});return}}sessionStorage.setItem(re.VERSION_INFO,JSON.stringify([Date.now(),e]))}catch(t){console.error("[NOTIFICATION_TYPE.VERSION_INFO] Error in handler",t)}c("okTurtles.data/get",ls)?.destroy(),window.location.reload()});var Gm=c("sbp/selectors/register",{async"backend/translations/get"(e){let[t]=e.toLowerCase().split("-"),o=hc.get(t)||"";if(o!=="")return await fetch(`${c("okTurtles.data/get","API_URL")}/assets/strings/${o}`).then(Ee("json"))}});c("sbp/selectors/register",{"namespace/lookupCached":e=>c("state/vuex/state").namespaceLookups?.[e]??null,"namespace/lookupReverseCached":e=>c("state/vuex/state").reverseNamespaceLookups?.[e]??null,"namespace/lookup":(e,{skipCache:t}={skipCache:!1})=>{if(!t){let o=c("namespace/lookupCached",e);if(o)return Promise.resolve(o)}return c("sw-namespace/lookup",e,{skipCache:t})}});Q();var uo=60*ke,po=180*ke,It=30,us=20,ds=30;var gc=2*De;function he(e){return Date.now()-e.timestamp}function ps(e,t={}){let o=e.filter(r=>!bc({...r,...t[r.hash]}));return o.length>It&&(o.sort(vc),[[r=>r.read,us],[r=>!r.read,ds]].forEach(([r,s])=>{if(s!==-1&&s<It){let a=0;o=o.filter(n=>!r(n)||(a++,a<=s))}})),o.length>It&&(o.length=It),o.sort(nr)}function nr(e,t){return t.timestamp-e.timestamp}function vc(e,t){let o=2*ke,r=15*ke,s=21*ke,a=-1,n=1;if(e.read===t.read)return e.timestamp>t.timestamp?a:n;{let l=e.read?e:t,m=e.read?t:e,p=m;return[(u,d)=>he(u)<ke&&he(d)>r,(u,d)=>he(u)<o&&he(d)>s].some(u=>u(l,m))&&(p=l),p===e?a:n}}function bc(e){return he(e)>_c(e)}function ir(e){return he(e)<gc}function ms(e){return!ir(e)}function _c(e){return e.read?uo:po}var fs={chatRoomSettings(e,t){return t.currentChatRoomState.settings||{}},chatRoomAttributes(e,t){return t.currentChatRoomState.attributes||{}},chatRoomMembers(e,t){return t.currentChatRoomState.members||{}},chatRoomRecentMessages(e,t){return t.currentChatRoomState.messages||[]},chatRoomPinnedMessages(e,t){return(t.currentChatRoomState.pinnedMessages||[]).sort((o,r)=>o.height<r.height?1:-1)}};var hs={currentGroupOwnerID(e,t){return t.currentGroupState.groupOwnerID},groupSettingsForGroup(e,t){return o=>o.settings||{}},groupSettings(e,t){return t.groupSettingsForGroup(t.currentGroupState)},profileActive(e,t){return o=>t.currentGroupState.profiles?.[o]?.status===Z.ACTIVE},pendingAccept(e,t){return o=>t.currentGroupState.profiles?.[o]?.status===Z.PENDING},groupProfileForGroup(e,t){return(o,r)=>{let s=o.profiles;return s&&s[r]&&{...s[r],get lastLoggedIn(){return t.currentGroupLastLoggedIn[r]||this.joinedDate}}}},groupProfile(e,t){return o=>t.groupProfileForGroup(t.currentGroupState,o)},groupProfilesForGroup(e,t){return o=>{let r={};for(let s in o.profiles||{}){let a=t.groupProfileForGroup(o,s);a.status===Z.ACTIVE&&(r[s]=a)}return r}},groupProfiles(e,t){return t.groupProfilesForGroup(t.currentGroupState)},groupCreatedDate(e,t){return t.groupProfile(t.currentGroupOwnerID).joinedDate},groupMincomeAmountForGroup(e,t){return o=>t.groupSettingsForGroup(o).mincomeAmount},groupMincomeAmount(e,t){return t.groupMincomeAmountForGroup(t.currentGroupState)},groupMincomeCurrency(e,t){return t.groupSettings.mincomeCurrency},groupSortedPeriodKeysForGroup(e,t){return o=>{let{distributionDate:r,distributionPeriodLength:s}=t.groupSettingsForGroup(o);if(!r)return[];let a=Object.keys(t.groupPeriodPaymentsForGroup(o)).sort();return!a.length&&Jn>0&&a.push(qt(si(r,-s))),a[a.length-1]!==r&&a.push(r),a}},groupSortedPeriodKeys(e,t){return t.groupSortedPeriodKeysForGroup(t.currentGroupState)},periodStampGivenDateForGroup(e,t){return(o,r,s)=>Vt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).current},periodStampGivenDate(e,t){return(o,r)=>t.periodStampGivenDateForGroup(t.currentGroupState,o,r)},periodBeforePeriodForGroup(e,t){return(o,r,s)=>Vt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).previous},periodBeforePeriod(e,t){return(o,r)=>t.periodBeforePeriodForGroup(t.currentGroupState,o,r)},periodAfterPeriodForGroup(e,t){return(o,r,s)=>Vt(r,{knownSortedStamps:s||t.groupSortedPeriodKeysForGroup(o),periodLength:t.groupSettingsForGroup(o).distributionPeriodLength}).next},periodAfterPeriod(e,t){return(o,r)=>t.periodAfterPeriodForGroup(t.currentGroupState,o,r)},dueDateForPeriodForGroup(e,t){return(o,r,s)=>t.periodAfterPeriodForGroup(o,r,s)},dueDateForPeriod(e,t){return(o,r)=>t.dueDateForPeriodForGroup(t.currentGroupState,o,r)},paymentHashesForPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o)[r];if(s)return hi(s)}},paymentHashesForPeriod(e,t){return o=>t.paymentHashesForPeriodForGroup(t.currentGroupState,o)},groupMembersByContractID(e,t){return Object.keys(t.groupProfiles)},groupMembersCount(e,t){return t.groupMembersByContractID.length},groupMembersPending(e,t){let o=t.currentGroupState.invites,r=t.currentGroupState._vm.invites,s=Object.create(null);for(let a in o)r[a].status===et.VALID&&o[a].creatorID!==Ze&&(s[a]={displayName:o[a].invitee,invitedBy:o[a].creatorID,expires:r[a].expires});return s},groupShouldPropose(e,t){return t.groupMembersCount>=3},groupDistributionStarted(e,t){return o=>o>=t.groupSettings?.distributionDate},groupProposalSettings(e,t){return(o=Xn)=>t.groupSettings.proposals?.[o]},groupCurrency(e,t){let o=t.groupMincomeCurrency;return o&&li[o]},groupMincomeFormatted(e,t){return t.withGroupCurrency?.(t.groupMincomeAmount)},groupMincomeSymbolWithCode(e,t){return t.groupCurrency?.symbolWithCode},groupPeriodPaymentsForGroup(e,t){return o=>o.paymentsByPeriod||{}},groupPeriodPayments(e,t){return t.groupPeriodPaymentsForGroup(t.currentGroupState)},groupThankYousFrom(e,t){return t.currentGroupState.thankYousFrom||{}},groupStreaks(e,t){return t.currentGroupState.streaks||{}},groupTotalPledgeAmount(e,t){return t.currentGroupState.totalPledgeAmount||0},withGroupCurrency(e,t){return t.groupCurrency?.displayWithCurrency},groupChatRooms(e,t){return t.currentGroupState.chatRooms},groupGeneralChatRoomId(e,t){return t.currentGroupState.generalChatRoomId},haveNeedsForThisPeriodForGroup(e,t){return(o,r)=>{let s=t.groupProfilesForGroup(o),a=[];for(let n in s){let{incomeDetailsType:l,joinedDate:m}=s[n];if(l){let p=s[n][l],i=l==="incomeAmount"?p-t.groupMincomeAmountForGroup(o):p,u=ni(r).toISOString();ii({date:m,periodStart:r,periodLength:t.groupSettingsForGroup(o).distributionPeriodLength})&&(u=m),a.push({memberID:n,haveNeed:i,when:u})}}return a}},haveNeedsForThisPeriod(e,t){return o=>t.haveNeedsForThisPeriodForGroup(t.currentGroupState,o)},paymentsForPeriodForGroup(e,t){return(o,r)=>{let s=t.paymentHashesForPeriodForGroup(o,r),a=[];if(s&&s.length>0){let n=o.payments;for(let l of s){let m=n[l];m.data.status===fi&&a.push(gi(l,m))}}return a}},paymentsForPeriod(e,t){return o=>t.paymentsForPeriodForGroup(t.currentGroupState,o)}};var gs={loginState(e,t){return t.currentIdentityState.loginState},ourDirectMessages(e,t){return t.currentIdentityState.chatRooms||{}}};var vs=(e,t,o)=>{if(t&&e.namespaceLookups?.[t]===o)return t},yc=(e,t)=>Object.keys(e).find(o=>e[o].creatorID===Ze&&t.currentGroupState._vm.invites[o].status===et.VALID&&!(t.currentGroupState._vm.invites[o].expires<Date.now())&&!(t.currentGroupState._vm.invites[o].quantity<=0)),xc={currentGroupState(e){return e[e.currentGroupId]||{}},currentIdentityState(e){return e.loggedIn&&e[e.loggedIn.identityContractID]||{}},ourUsername(e,t){return e.loggedIn&&t.usernameFromID(e.loggedIn.identityContractID)},ourPreferences(e){return e.preferences},ourProfileActive(e,t){return t.profileActive(t.ourIdentityContractId)},ourPendingAccept(e,t){return t.pendingAccept(t.ourIdentityContractId)},ourGroupProfileForGroup(e,t){return o=>t.groupProfileForGroup(o,t.ourIdentityContractId)},ourGroupProfile(e,t){return t.ourGroupProfileForGroup(t.currentGroupState)},ourUserDisplayName(e,t){return(t.currentIdentityState||{}).attributes?.displayName||t.ourUsername||t.ourIdentityContractId},ourIdentityContractId(e){return e.loggedIn&&e.loggedIn.identityContractID},ourGroups(e,t){let o=t.ourIdentityContractId;return o?Object.keys(e[o]?.groups||{}).filter(r=>!e[o].groups[r].hasLeft&&e[r]):[]},currentGroupLastLoggedIn(e){return e.lastLoggedIn[e.currentGroupId]||{}},ourContributionSummary(e,t){let o=t.groupProfiles,r=t.ourIdentityContractId,s=t.ourGroupProfile;if(!s||!s.incomeDetailsType)return{};let a=s.incomeDetailsType==="incomeAmount",n=t.groupIncomeDistribution,l=m=>o[m].nonMonetaryContributions||[];return{givingMonetary:(()=>{if(a)return null;let m=[],p=[],i=n.filter(u=>u.fromMemberID===r).reduce((u,d)=>(m.push(t.userDisplayNameFromID(d.toMemberID)),p.push(d.toMemberID),u+d.amount),0);return{who:m,whoIds:p,total:i,pledged:s.pledgeAmount}})(),receivingMonetary:(()=>{if(!a)return null;let m=t.groupSettings.mincomeAmount-s.incomeAmount,p=[],i=[],u=n.filter(d=>d.toMemberID===r).reduce((d,h)=>(p.push(t.userDisplayNameFromID(h.fromMemberID)),i.push(h.fromMemberID),d+h.amount),0);return{who:p,whoIds:i,total:u,needed:m}})(),receivingNonMonetary:(()=>{let m=Object.keys(o).filter(i=>i!==r&&l(i).length>0),p=m.reduce((i,u)=>{let d=t.userDisplayNameFromID(u);return l(u).forEach(g=>{let v=i.findIndex(E=>E.what===g);v>=0?(i[v].who.push(d),i[v].whoIds.push(u)):i.push({who:[d],whoIds:[u],what:g})}),i},[]);return m.length>0?{what:p,who:m}:null})(),givingNonMonetary:(()=>{let m=s.nonMonetaryContributions;return m.length>0?m:null})()}},usernameFromID(e,t){return o=>t.ourContactProfilesById[o]?.username||e.reverseNamespaceLookups[o]||o},userDisplayNameFromID(e,t){return o=>{if(o===t.ourIdentityContractId)return t.ourUserDisplayName;let r=t.ourContactProfilesById[o];return r?.displayName||r?.username||e.reverseNamespaceLookups[o]||o}},thisPeriodPaymentInfoForGroup(e,t){return o=>t.groupPeriodPaymentsForGroup(o)[t.currentPaymentPeriodForGroup(o)]},thisPeriodPaymentInfo(e,t){return t.thisPeriodPaymentInfoForGroup(t.currentGroupState)},latePayments(e,t){let o=t.groupPeriodPayments;if(Object.keys(o).length===0)return;let r=t.ourIdentityContractId,s=t.periodBeforePeriod(t.currentPaymentPeriod),a=o[s];if(a)return a.lastAdjustedDistribution.filter(n=>n.fromMemberID===r)},groupIncomeDistribution(e,t){return Xo({haveNeeds:t.haveNeedsForThisPeriod(t.currentPaymentPeriod),minimize:!1})},groupIncomeAdjustedDistributionForGroup(e,t){return o=>{let r=t.thisPeriodPaymentInfoForGroup(o);if(r&&r.lastAdjustedDistribution)return r.lastAdjustedDistribution;{let s=t.currentPaymentPeriodForGroup(o);return ui({distribution:Xo({haveNeeds:t.haveNeedsForThisPeriodForGroup(o,s),minimize:t.groupSettingsForGroup(o).minimizeDistribution}),payments:t.paymentsForPeriodForGroup(o,s),dueOn:t.dueDateForPeriodForGroup(o,s)})}}},groupIncomeAdjustedDistribution(e,t){return t.groupIncomeAdjustedDistributionForGroup(t.currentGroupState)},ourPaymentsSentInPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o);if(Object.keys(s).length===0)return;let a=[],n=s[r],l=n&&n.paymentsFrom;if(l){let m=t.ourIdentityContractId,p=o.payments;for(let i in l[m])for(let u of l[m][i]){let{data:d,meta:h,height:g}=p[u];a.push({hash:u,height:g,data:d,meta:h,amount:d.amount,period:r})}}return a.sort((m,p)=>p.height-m.height)}},ourPaymentsSentInPeriod(e,t){return o=>t.ourPaymentsSentInPeriodForGroup(t.currentGroupState,o)},ourPaymentsReceivedInPeriodForGroup(e,t){return(o,r)=>{let s=t.groupPeriodPaymentsForGroup(o);if(Object.keys(s).length===0)return;let a=[],n=s[r],l=n&&n.paymentsFrom;if(l){let m=t.ourIdentityContractId,p=o.payments;for(let i in l)for(let u in l[i])if(u===m)for(let d of l[i][u]){let{data:h,meta:g,height:v}=p[d];a.push({hash:d,height:v,data:h,meta:g,amount:h.amount})}}return a.sort((m,p)=>p.height-m.height)}},ourPaymentsReceivedInPeriod(e,t){return o=>t.ourPaymentsReceivedInPeriodForGroup(t.currentGroupState,o)},ourPaymentsForGroup(e,t){return o=>{let r=t.groupPeriodPaymentsForGroup(o);if(Object.keys(r).length===0)return;let s=t.ourIdentityContractId,a=t.currentPaymentPeriodForGroup(o),n=t.periodBeforePeriodForGroup(o,a),l=t.ourPaymentsSentInPeriodForGroup(o,a),m=t.ourPaymentsSentInPeriodForGroup(o,n),p=t.ourPaymentsReceivedInPeriodForGroup(o,a),i=t.ourPaymentsReceivedInPeriodForGroup(o,n),u=()=>t.groupIncomeAdjustedDistributionForGroup(o).filter(d=>d.fromMemberID===s);return{sent:[...l,...m],received:[...p,...i],todo:u()}}},ourPayments(e,t){return t.ourPaymentsForGroup(t.currentGroupState)},ourPaymentsSummary(e,t){let o=t.ourGroupProfile.incomeDetailsType==="incomeAmount",r=t.ourIdentityContractId,s=y=>o?y.toMemberID===r:y.fromMemberID===r,a=(y,A)=>y+A.amount,n=t.currentPaymentPeriod,l=t.groupIncomeAdjustedDistribution.filter(s),m=o?t.ourPaymentsReceivedInPeriod(n):t.ourPaymentsSentInPeriod(n),p=m.filter(y=>y.data.status===mi),i=p.reduce(a,0),u=l.length+m.length,d=l.filter(y=>!y.isLate),h=u-d.length-p.length,g=l.some(y=>y.partial),v=m.reduce(a,0)-i,E=l.reduce((y,A)=>y+A.amount,0)+i,P=v+E;return{paymentsDone:h,hasPartials:g,paymentsTotal:u,amountDone:v,amountTotal:P}},currentWelcomeInvite(e,t){let o=t.currentGroupState.invites,r=yc(o,t),s=t.currentGroupState._vm.invites[r].expires;return{inviteId:r,expires:s}},groupsByName(e,t){let o=t.ourIdentityContractId,r=e[o]?.groups;return r?Object.entries(r).filter(([,{hasLeft:s}])=>!s).map(([s])=>({groupName:e[s]?.settings?.groupName||b("Pending"),contractID:s,active:e[s]?.profiles?.[o]?.status===Z.ACTIVE})):[]},profilesByGroup(e,t){return o=>{let r={};if(e.contracts[o]?.type!=="gi.contracts/group")return r;let s=e[o].profiles||{};for(let a in s){let n=s[a];n.status===Z.ACTIVE&&(r[a]=n)}return r}},groupMembersSorted(e,t){let o=t.currentGroupState.profiles;if(!o||!o[t.ourIdentityContractId])return[];let r=o[t.ourIdentityContractId].joinedHeight,s=n=>{if(n===t.ourIdentityContractId)return!1;let l=o[n];if(!l)return!1;let m=l.joinedHeight,p=new Date(l.joinedDate).getTime();return r<m&&Date.now()-p<6048e5},a=t.groupMembersPending;return[a,t.groupProfiles].flatMap(Object.keys).filter(n=>t.groupProfiles[n]||!(t.groupMembersPending[n].expires<Date.now())).map(n=>{let{contractID:l,displayName:m,username:p}=t.globalProfile(n)||a[n]||(t.groupProfiles[n]?{contractID:n}:{});return{id:n,contractID:l,username:p,displayName:m||p||n,invitedBy:t.groupMembersPending[n],isNew:s(n)}}).sort((n,l)=>{let m=n.displayName.normalize().toUpperCase(),p=l.displayName.normalize().toUpperCase();return n.invitedBy&&!l.invitedBy?-1:!n.invitedBy&&l.invitedBy?1:n.isNew&&!l.isNew?-1:!n.isNew&&l.isNew?1:m<p?-1:1})},groupProposals(e,t){return o=>e[o]?.proposals},globalProfile(e,t){return o=>t.ourContactProfilesById[o]},ourContactProfilesByUsername(e,t){let o={};return Object.keys(e.contracts).filter(r=>e.contracts[r]?.type==="gi.contracts/identity").forEach(r=>{let s=e[r].attributes;if(s){let a=vs(e,s.username,r);if(!a)return;o[a]={...s,username:a,contractID:r}}}),o},ourContactProfilesById(e,t){let o={};return Object.keys(e.contracts).filter(r=>e.contracts[r]?.type==="gi.contracts/identity").forEach(r=>{let s=e[r]?.attributes;if(s){let a=vs(e,s.username,r);o[r]={...s,username:a,contractID:r}}else o[r]={contractID:r}}),Object.keys(e.reverseNamespaceLookups).forEach(r=>{o[r]||e.contracts[r]===null||(o[r]={username:e.reverseNamespaceLookups[r],contractID:r})}),o},currentGroupContactProfilesById(e,t){let o=Object.keys(t.currentGroupState.profiles||{}),r={};for(let s in t.ourContactProfilesById)o.includes(s)&&(r[s]=t.ourContactProfilesById[s]);return r},ourContactsById(e,t){return Object.keys(t.ourContactProfilesById).sort((o,r)=>{let s=t.ourContactProfilesById[o].displayName||t.ourContactProfilesById[o].username||o,a=t.ourContactProfilesById[r].displayName||t.ourContactProfilesById[r].username||r;return s.normalize().toUpperCase()>a.normalize().toUpperCase()?1:-1})},ourContactsByUsername(e,t){return Object.keys(t.ourContactProfilesByUsername).sort((o,r)=>{let s=t.ourContactProfilesByUsername[o].displayName||o,a=t.ourContactProfilesByUsername[r].displayName||r;return s.normalize().toUpperCase()>a.normalize().toUpperCase()?1:-1})},seenWelcomeScreen(e,t){return t.currentIdentityState?.groups?.[e.currentGroupId]?.hasLeft||t.ourProfileActive&&t.currentIdentityState?.groups?.[e.currentGroupId]?.seenWelcomeScreen},...fs,...hs,...gs},bs=xc;Q();var wc={notifications(e,t,o){return e.items.map(r=>{let s={...r,...e.status[r.hash]};return he(s)>po?null:(!s.read&&he(s)>uo&&(s.read=!0),s)}).filter(Boolean)},currentGroupNotifications(e,t,o){return t.notifications.filter(r=>r.groupID===o.currentGroupId)},notificationsByGroup(e,t){return o=>t.notifications.filter(r=>r.groupID===o)},currentGroupUnreadNotificationCount(e,t){return t.currentGroupUnreadNotifications.length},currentGroupUnreadNotifications(e,t,o){return t.currentGroupNotifications.filter(r=>!r.read)},currentNewNotifications(e,t){return t.currentNotifications.filter(ir)},currentNotificationCount(e,t){return t.currentNotifications.length},currentNotifications(e,t,o){return t.notifications.filter(r=>!r.groupID||r.groupID===o.currentGroupId)},currentOlderNotifications(e,t){return t.currentNotifications.filter(ms)},currentUnreadNotificationCount(e,t){return t.currentNotifications.filter(o=>!o.read).length},currentUnreadNotifications(e,t){return t.currentNotifications.filter(o=>!o.read)},totalUnreadNotificationCount(e,t){return t.notifications.filter(o=>!o.read).length},unreadGroupNotificationCountFor(e,t){return o=>t.unreadGroupNotificationsFor(o).length},unreadGroupNotificationsFor(e,t,o){return r=>r===o.currentGroupId?t.currentGroupUnreadNotifications:t.notifications.filter(s=>!s.read&&s.groupID===r)}},_s=wc;var sr="addNotification";var ys="removeAllNotifications",ar="removeNotification",xs="setNotifications";c("okTurtles.events/on",On,e=>{c("state/vuex/commit",sr,e)});c("okTurtles.events/on",Pn,e=>{e.forEach(t=>c("state/vuex/commit",ar,t))});c("okTurtles.events/on",Ln,e=>{c("state/vuex/commit","setNotificationStatus",e)});var ws={items:[],status:{}},Ic={logout(e){Object.keys(e).forEach(t=>{I.delete(e,t)}),Object.assign(e,F(ws))},[sr](e,t){if(e.items.some(o=>o.hash===t.hash))return console.error("[ADD_NOTIFICATION] This notification is already in the store.",t.hash);e.items.push(t),e.items.sort(nr)},[ar](e,t){let o=e.items.findIndex(r=>r.hash===t);o>-1&&e.items.splice(o,1)},[ys](e){e.items.splice(0,e.items.length)},[xs](e,t){e.items.splice(0,e.items.length,...t)},setNotificationStatus(e,t){e.status=t}},cr={state:()=>F(ws),getters:_s,mutations:Ic};var Ss=()=>window.matchMedia?.("(prefers-color-scheme: dark)").matches?Jt:vi,kc=e=>{let t=document.querySelector('meta[name="theme-color"]');t&&(t.content=e===Jt?"#2E3032":"#F5F5F5")},Tc="system",Cc=Ss(),Is={appLogsFilter:new URLSearchParams(location.search).get("debug")?["error","warn","info","debug","log"]:["error","warn","info"],fontSize:16,increasedContrast:!1,notificationEnabled:null,notificationVolume:1,reducedMotion:!1,theme:Tc,themeColor:Cc},Ec={colors(e){return Xt[e.themeColor]},fontSize(e){return e.fontSize},isDarkTheme(e){return e.themeColor===Jt},isReducedMotionMode(e){return e.reducedMotion===!0},notificationVolume(e){return e.notificationVolume},theme(e){return e.theme}},Ac={resetSettings(e){Object.assign(e,F(Is))},setAppLogsFilter(e,t){e.appLogsFilter=t,c("okTurtles.events/emit",Le,t)},setFontSize(e,t){e.fontSize=t},setIncreasedContrast(e,t){e.increasedContrast=t},setNotificationEnabled(e,t){console.info("[setNotificationEnabled] set to:",t),e.notificationEnabled=t,c("sw/deviceSettings/set",$n.DISABLE_NOTIFICATIONS,!t).catch(o=>{console.error(`Couldn't set DISABLE_NOTIFICATIONS (${!t}): ${o.message}`)}),c("service-worker/setup-push-subscription").catch(o=>{console.error(`[setNotificationEnabled] Error calling setup-push-subscription (enabled=${t})`,o)})},setNotificationVolume(e,t){e.notificationVolume=t},setReducedMotion(e,t){e.reducedMotion=t},setTemporaryReducedMotion(e){let t=e.reducedMotion;e.reducedMotion=!0,setTimeout(()=>{e.reducedMotion=t},300)},setTheme(e,t){e.theme=t;let o=t==="system"?Ss():t;e.themeColor=o,c("okTurtles.events/emit",ft,o)}};c("okTurtles.events/on",Ye,()=>c("state/vuex/commit","resetSettings"));c("okTurtles.events/on",ft,kc);var lr={state:()=>F(Is),getters:Ec,mutations:Ac};var Nc={currentChatRoomId(e,t,o){return e.currentChatRoomIDs[o.currentGroupId]||null},currentChatRoomState(e,t,o){return o[t.currentChatRoomId]||{}},chatNotificationSettings(e){return Object.assign({publicDefault:{messageNotification:bt.DIRECT_MESSAGES,messageSound:bt.DIRECT_MESSAGES},privateDefault:{messageNotification:bt.ALL_MESSAGES,messageSound:bt.ALL_MESSAGES}},e.chatNotificationSettings||{})},ourUnreadMessages(e){return e.unreadMessages||{}},directMessagesByGroup(e,t,o){return r=>{let s={};if(!r)return s;for(let a of Object.keys(t.ourDirectMessages)){let n=o[a],l=t.ourDirectMessages[a],m=t.ourIdentityContractId;if(!n||!n.members?.[m])continue;let p=Object.keys(n.members),i=p.length===1&&p[0]===m,u=p.filter(h=>h!==m).sort((h,g)=>{let v=new Date(n.members[h].joinedDate).getTime(),E=new Date(n.members[g].joinedDate).getTime();return v-E}),d=u.some(h=>Object.keys(t.profilesByGroup(r)).includes(h));if(l.visible&&(i||d)){let h=i?m:u[u.length-1],g=n.messages?.length>0?new Date(n.messages[n.messages.length-1].datetime).getTime():0;s[a]={...l,members:p,partners:u.map(v=>({contractID:v,username:t.usernameFromID(v),displayName:t.userDisplayNameFromID(v)})),lastJoinedPartner:h,title:i?t.userDisplayNameFromID(m):u.map(v=>t.userDisplayNameFromID(v)).join(", "),lastMsgTimeStamp:g,picture:t.ourContactProfilesById[h]?.picture,isDMToMyself:i}}}return s}},ourGroupDirectMessages(e,t,o){return t.directMessagesByGroup(o.currentGroupId)},ourGroupDirectMessageFromUserIds(e,t,o){return r=>{typeof r=="string"&&(r=[r]);let s=r.length===1&&r[0]===o.loggedIn.identityContractID,a=t.ourGroupDirectMessages;return Object.keys(a).find(n=>{let l=a[n];if(s)return l.isDMToMyself;{let m=l.partners.map(p=>p.contractID);return m.length===r.length&&Hn(m,r).length===r.length}})}},isGroupDirectMessage(e,t){return o=>!!t.ourGroupDirectMessages[o||t.currentChatRoomId]},isDirectMessage(e,t){return o=>!!t.ourDirectMessages[o||t.currentChatRoomId]},isGroupDirectMessageToMyself(e,t){return o=>{let r=t.ourGroupDirectMessages[o||t.currentChatRoomId];return!!r&&r?.isDMToMyself}},isJoinedChatRoom(e,t,o){return(r,s)=>!!o[r]?.members?.[s||t.ourIdentityContractId]},currentChatVm(e,t,o){return o?.[t.currentChatRoomId]?._vm||null},currentChatRoomScrollPosition(e,t){return e.chatRoomScrollPosition?.[t.currentChatRoomId]},currentChatRoomReadUntil(e,t){return t.ourUnreadMessages[t.currentChatRoomId]?.readUntil},chatRoomUnreadMessages(e,t){return o=>t.ourUnreadMessages[o]?.unreadMessages||[]},isChatRoomManuallyMarkedUnread(e,t){return o=>!!t.ourUnreadMessages[o||t.currentChatRoomId]?.readUntil?.isManuallyMarked},groupUnreadMessages(e,t,o){return r=>{let s=n=>Object.keys(t.directMessagesByGroup(r)).includes(n),a=n=>Object.keys(o[r]?.chatRooms||{}).includes(n);return Object.keys(t.ourUnreadMessages).filter(n=>s(n)||a(n)).map(n=>t.ourUnreadMessages[n].unreadMessages.length).reduce((n,l)=>n+l,0)}},groupIdFromChatRoomId(e,t,o){return r=>Object.keys(o.contracts).find(s=>o.contracts[s].type==="gi.contracts/group"&&Object.keys(o[s].chatRooms).includes(r))},chatRoomsInDetail(e,t,o){let r=jn({},t.groupChatRooms),s=o.loggedIn.identityContractID;for(let a in r){let n=o[a];if(n&&n.attributes&&n.members[s])r[a]={...n.attributes,id:a,unreadMessagesCount:t.chatRoomUnreadMessages(a).length,joined:!0};else{let{name:l,privacyLevel:m}=r[a];r[a]={id:a,name:l,privacyLevel:m,joined:!1}}}return r},mentionableChatroomsInDetails(e,t){return Object.values(t.chatRoomsInDetail).filter(o=>[Ht.GROUP,Ht.PUBLIC].includes(o.privacyLevel)||o.privacyLevel===Ht.PRIVATE&&o.joined)},getChatroomNameById(e,t){return o=>{let r=Object.values(t.chatRoomsInDetail).find(s=>s.id===o);return r?r.name:null}},chatRoomMembersInSort(e,t){return t.groupMembersSorted.map(o=>({contractID:o.contractID,username:o.username,displayName:o.displayName})).filter(o=>!!t.chatRoomMembers[o.contractID])||[]}},ks=Nc;Q();var Rc={currentChatRoomIDs:{},pendingChatRoomIDs:{},chatRoomScrollPosition:{},unreadMessages:null,chatNotificationSettings:{}},Ts={setCurrentChatRoomId(e,{groupID:t,chatRoomID:o}){let r=c("state/vuex/state");t&&r[t]?(o?I.set(e.currentChatRoomIDs,t,o):I.set(e.currentChatRoomIDs,t,r[t].generalChatRoomId||null),I.delete(e.pendingChatRoomIDs,t)):(o?I.set(e.currentChatRoomIDs,r.currentGroupId,o):I.set(e.currentChatRoomIDs,r.currentGroupId,null),I.delete(e.pendingChatRoomIDs,r.currentGroupId))},setPendingChatRoomId(e,{groupID:t,chatRoomID:o}){let r=c("state/vuex/state");if(c("state/vuex/getters").isJoinedChatRoom(o)){Ts.setCurrentChatRoomId(e,{groupID:t,chatRoomID:o});return}t&&r[t]&&(o?I.set(e.pendingChatRoomIDs,t,o):I.set(e.pendingChatRoomIDs,t,null))},setUnreadMessages(e,t){I.set(e,"unreadMessages",t)},setChatRoomScrollPosition(e,{chatRoomID:t,messageHash:o}){I.set(e.chatRoomScrollPosition,t,o)},deleteChatRoomScrollPosition(e,{chatRoomID:t}){I.delete(e.chatRoomScrollPosition,t)},setChatroomNotificationSettings(e,{chatRoomID:t,settings:o}){if(t){e.chatNotificationSettings[t]||I.set(e.chatNotificationSettings,t,{});for(let r in o)I.set(e.chatNotificationSettings[t],r,o[r])}}},ur={state:()=>F(Rc),getters:ks,mutations:Ts};I.use(jo.default);var Cs={currentGroupId:null,contracts:{},loggedIn:!1,namespaceLookups:Object.create(null),reverseNamespaceLookups:Object.create(null),contractSigningKeys:Object.create(null),lastLoggedIn:{},preferences:{},periodicNotificationAlreadyFiredMap:{alreadyFired:Object.create(null),lastRun:Object.create(null)}};window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{c("state/vuex/getters").theme==="system"&&V.commit("setTheme","system")});var kt=I.observable({date:new Date});setInterval(function(){let e=V.getters.periodStampGivenDate?.(kt.date),t=V.getters.periodStampGivenDate?.(new Date);e!==t&&(kt.date=new Date)},60*1e3);c("sbp/selectors/register",{"state/vuex/state":()=>V.state,"state/vuex/reset":()=>{let e=F(Cs);e.notifications=cr.state(),e.settings=lr.state(),e.chatroom=ur.state(),e.idleVue={isIdle:!1},V.replaceState(e)},"state/vuex/replace":e=>V.replaceState(e),"state/vuex/commit":(e,t)=>V.commit(e,t),"state/vuex/getters":()=>V.getters,"state/vuex/settings":()=>V.state.settings,"state/vuex/postUpgradeVerification":function(e){e.preferences||(e.preferences={}),e.periodicNotificationAlreadyFiredMap&&(e.periodicNotificationAlreadyFiredMap.alreadyFired||(e.periodicNotificationAlreadyFiredMap.alreadyFired=Object.create(null)),e.periodicNotificationAlreadyFiredMap.lastRun||(e.periodicNotificationAlreadyFiredMap.lastRun=Object.create(null))),Promise.resolve(c("chelonia/rootState")).then(t=>{if(t.namespaceLookups)return;let o=Object.entries(t.contracts).filter(([,{type:r}])=>r==="gi.contracts/identity").map(([r])=>r);return console.info("Fixing missing lookup entries",o),Promise.all(o.map(r=>{let s=t[r].attributes?.username;if(s)return c("namespace/lookup",s,{skipCache:!0})})).catch(r=>{console.error("[state/vuex/postUpgradeVerification] Error during lookup",r)})})},"state/vuex/save":(e,t)=>c("okTurtles.eventQueue/queueEvent","state/vuex/save",async function(){if(t=t||V.state,!t.loggedIn)return;let{identityContractID:o,encryptionParams:r}=t.loggedIn;t.notifications.items=ps(t.notifications.items||[],t.notifications.status||{}),e?await c("gi.db/settings/saveEncrypted",o,t,r):await c("gi.db/settings/save",o,t)})});var Oc={login(e,t){e.loggedIn=t},setCurrentGroupId(e,{contractID:t,forceRefresh:o,isNewlyCreated:r}){if(I.set(e,"currentGroupId",t),!t||o){if(c("controller/router").history.current.path==="/join")return;c("controller/router").push({path:"/"}).catch(()=>{})}else r&&c("controller/router").push({path:"/pending-approval"}).catch(()=>{})},setPreferences(e,t){I.set(e,"preferences",t)},setLastLoggedIn(e,[t,o]){I.set(e.lastLoggedIn,t,o)},noop(){}},V=new jo.default.Store({state:F(Cs),mutations:Oc,getters:{...bs,currentPaymentPeriodForGroup(e,t){return o=>t.periodStampGivenDateForGroup(o,kt.date)},currentPaymentPeriod(e,t){return t.currentPaymentPeriodForGroup(t.currentGroupState)}},modules:{notifications:cr,settings:lr,chatroom:ur},strict:!1});V.watch(function(e,t){return t.currentGroupState.settings?.distributionDate},function(){kt.date=new Date});var dr=!1,pr=Qe(()=>!dr&&c("state/vuex/save"),500);V.subscribe(e=>{e.type!=="noop"&&pr()});c("okTurtles.events/on",Se,pr);c("sbp/filters/selector/add","gi.app/identity/logout",function(){dr=!0,pr.clear()});c("okTurtles.events/on",Ye,()=>{dr=!1});c("okTurtles.events/on",Kn,async e=>{let{contracts:{manifests:t}}=await c("chelonia/config");t[e.name]===e.manifest&&e.name==="gi.contracts/group"&&V.watch((o,r)=>r.currentPaymentPeriod,(o,r)=>{let s=V.getters.groupSettings.distributionDate,a=V.getters.groupDistributionStarted(kt.date);r&&o&&a&&o!==s&&c("gi.actions/group/updateDistributionDate",{contractID:V.state.currentGroupId}).catch(n=>{console.error("okTurtles.events/on CONTRACT_REGISTERED Error calling updateDistributionDate",n)})})});var se=V;var Pc={name:"Home",components:{SvgJoinGroup:ki,SvgCreateGroup:eo,BannerSimple:bi,ButtonSubmit:_i,RenderMessageWithMarkdown:Ii},computed:{...H(["currentIdentityState","seenWelcomeScreen"]),...oe(["currentGroupId"]),isLoggedIn(){return!!this.$store.state.loggedIn}},data(){return{ephemeral:{serverMessages:[],seenWelcomeScreen:!1,listener:({contractID:e})=>{e===this.currentGroupId&&(this.ephemeral.seenWelcomeScreen=!1)},showPwaPromo:!1}}},beforeMount(){c("okTurtles.events/on",Uo,this.ephemeral.listener),this.checkPwaInstallability(),fetch(`${c("okTurtles.data/get","API_URL")}/serverMessages`).then(async e=>{let t=await e.json();this.ephemeral.serverMessages=t.filter(o=>o.type==="giHomeWarning").map(o=>o.message)}).catch(e=>{console.error("[Home.vue] Error fetching or processing server announcements",e)})},mounted(){this.ephemeral.seenWelcomeScreen=this.seenWelcomeScreen,this.isLoggedIn&&this.currentGroupId?this.navigateToGroupPage():this.$route.query.next&&this.openModal("LoginModal")},destroyed(){c("okTurtles.events/off",Uo,this.ephemeral.listener)},methods:{openModal(e){c("okTurtles.events/emit",z,e)},navigateToGroupPage(){let e=this.$route.query.next??(this.ephemeral.seenWelcomeScreen?"/dashboard":"/pending-approval");this.$router.push({path:e}).catch(t=>yi(t,e))},checkPwaInstallability(){this.ephemeral.showPwaPromo=c("service-worker/check-pwa-installability"),c("okTurtles.events/once",Bt,()=>{this.ephemeral.showPwaPromo=!0})},async onInstallClick(){await c("service-worker/trigger-install-prompt")}},watch:{currentGroupId(e){this.ephemeral.seenWelcomeScreen=this.seenWelcomeScreen,e&&this.isLoggedIn&&this.navigateToGroupPage()},isLoggedIn(e){e&&this.currentGroupId&&this.navigateToGroupPage()}}},Lc=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.currentGroupId?e._e():o("main",{staticClass:"c-splash",attrs:{"data-test":"homeLogo"}},[e.isLoggedIn?o("header",{key:"title-not-login"},[o("img",{staticClass:"logo-2",attrs:{src:"/assets/images/logo-transparent.png"}}),o("i18n",{staticClass:"is-subtitle",attrs:{tag:"p"}},[e._v("Welcome to Group Income")]),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"welcomeHomeLoggedIn"}},[e._v("Let\u2019s get this party started")])],1):o("header",{key:"title-login"},[o("img",{staticClass:"logo",attrs:{src:"/assets/images/group-income-icon-transparent.png"}}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"welcomeHome"}},[e._v("Welcome to Group Income")])],1),e.isLoggedIn?o("div",{key:"body-create",staticClass:"create-or-join"},[o("div",{staticClass:"card"},[o("svg-create-group"),o("i18n",{staticClass:"is-title-3",attrs:{tag:"h3"}},[e._v("Create")]),o("i18n",{attrs:{tag:"p"}},[e._v("Create a new group and invite your friends.")]),o("i18n",{attrs:{tag:"button","data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[e._v("Create Group")])],1),o("div",{staticClass:"card"},[o("svg-join-group"),o("i18n",{staticClass:"is-title-3",attrs:{tag:"h3"}},[e._v("Join")]),o("i18n",{attrs:{tag:"p"}},[e._v("Enter an existing group using your username.")]),o("i18n",{attrs:{tag:"button","data-test":"joinGroup"},on:{click:function(r){return e.openModal("GroupJoinModal")}}},[e._v("Join a Group")])],1)]):o("div",{key:"body-loggin",staticClass:"buttons"},[o("i18n",{ref:"loginBtn",attrs:{tag:"button","data-test":"loginBtn"},on:{click:function(r){return e.openModal("LoginModal")}}},[e._v("Login")]),o("i18n",{directives:[{name:"focus",rawName:"v-focus"}],ref:"signupBtn",attrs:{tag:"button","data-test":"signupBtn"},on:{click:function(r){return e.openModal("SignupModal")},keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.openModal("SignupModal")}}},[e._v("Signup")])],1),!e.isLoggedIn&&e.ephemeral.showPwaPromo?o("banner-simple",{staticClass:"hide-hoverable-device hide-tablet c-pwa-promo",attrs:{severity:"general"},scopedSlots:e._u([{key:"header",fn:function(){return[o("i18n",[e._v("Install this web app on your device for better usability.")])]},proxy:!0}],null,!1,1382767684)},[o("button-submit",{staticClass:"is-success is-small c-install-btn",attrs:{type:"button"},on:{click:e.onInstallClick}},[e._v(e._s(e.L("Install")))])],1):e._e(),!e.isLoggedIn&&e.ephemeral.serverMessages.length>0?o("footer",{staticClass:"c-footer"},e._l(e.ephemeral.serverMessages,function(r){return o("banner-simple",{staticClass:"c-demo-warning",attrs:{severity:"warning"}},[o("render-message-with-markdown",{attrs:{text:r}})],1)}),1):e._e()],1)},Mc=[],Dc=function(e){e&&e("data-v-2fc59f2f_0",{source:".c-splash[data-v-2fc59f2f]{display:flex;flex-direction:column;text-align:center;align-items:center;min-height:100%}@media screen and (min-width:769px),print{.c-splash[data-v-2fc59f2f]{justify-content:center}}.logo[data-v-2fc59f2f]{width:8rem;margin:2rem auto}.logo-2[data-v-2fc59f2f]{width:8rem;margin:0 auto 3rem auto}@media screen and (min-width:769px),print{.logo-2[data-v-2fc59f2f]{margin:0;position:absolute;left:1.5rem;top:1.5rem}}@media screen and (min-width:769px),print{.is-subtitle[data-v-2fc59f2f]{margin-top:3rem}}@media screen and (min-width:1200px){.is-subtitle[data-v-2fc59f2f]{margin-top:0}}.buttons[data-v-2fc59f2f]{min-width:230px}.create-or-join[data-v-2fc59f2f]{display:flex;width:100%;flex-wrap:wrap;margin-top:.5rem;justify-content:center;text-align:left}@media screen and (min-width:769px),print{.create-or-join[data-v-2fc59f2f]{text-align:center}}.card[data-v-2fc59f2f]{margin:1.5rem 1.5rem 0 1.5rem;width:100%}@media screen and (min-width:769px),print{.card[data-v-2fc59f2f]{width:24.375rem}}.card h3[data-v-2fc59f2f]{margin-bottom:.25rem}.card svg[data-v-2fc59f2f]{width:6rem;margin-left:1rem;float:right}@media screen and (min-width:769px),print{.card svg[data-v-2fc59f2f]{float:none;width:9.75rem;margin:2.5rem auto 1.5rem auto}}.card .button[data-v-2fc59f2f]{margin-top:2rem}@media screen and (min-width:769px),print{.card .button[data-v-2fc59f2f]{margin-bottom:1rem}}.c-footer[data-v-2fc59f2f]{margin-top:2.25rem;padding:0 1rem;max-width:31.25rem}.c-demo-warning[data-v-2fc59f2f]{text-align:start;margin-block-end:1rem}.c-pwa-promo[data-v-2fc59f2f]{position:fixed;bottom:1.875rem;left:50%;transform:translateX(-50%);z-index:10;text-align:left;width:calc(100vw - 3rem);max-width:31.25rem}.c-pwa-promo[data-v-2fc59f2f]  .c-body{margin-top:1rem;text-align:right}.c-install-btn[data-v-2fc59f2f]{padding-left:1.75rem;padding-right:1.75rem}",map:void 0,media:void 0})},Gc="data-v-2fc59f2f",Fc=void 0,Uc=!1;function $c(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function mr(){let e=mr.styles||(mr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Bc=$c({render:Lc,staticRenderFns:Mc},Dc,Pc,Gc,Uc,Fc,!1,mr,void 0,void 0),Es=Bc;var jc={name:"Loading",props:{title:{default:b("Hang in there"),type:String},text:{default:b("Magic is happening..."),type:[String,Number]},theme:{validator(e){return["fullView",""].indexOf(e)!==-1}}}},zc=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"c-loading has-text-centered",class:{"c-fullView":e.theme==="fullView"}},[o("h1",{staticClass:"is-title-1"},[e._v(e._s(e.title))]),o("p",[e._v(e._s(e.text))])])},Hc=[],Wc=function(e){e&&e("data-v-78cdfd82_0",{source:".c-loading[data-v-78cdfd82]{opacity:0;padding:2rem 0;animation:showLoading-data-v-78cdfd82 .2s .5s forwards}.c-loading.c-fullView[data-v-78cdfd82]{min-height:100%;display:flex;flex-direction:column;justify-content:center}@keyframes showLoading-data-v-78cdfd82{from{opacity:0}to{opacity:1}}",map:void 0,media:void 0})},Vc="data-v-78cdfd82",qc=void 0,Kc=!1;function Xc(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function fr(){let e=fr.styles||(fr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Jc=Xc({render:zc,staticRenderFns:Hc},Wc,jc,Vc,Kc,qc,!1,fr,void 0,void 0),As=Jc;var Ns=!1;c("okTurtles.events/once",Je,()=>{Ns=!0});var Yc={name:"Join",components:{Loading:As,LoginForm:Ei,SignupForm:Ci,Avatar:Zt,SvgBrokenLink:Ai,SvgCreateGroup:eo},data(){return{ephemeral:{pageStatus:"LOADING",invitation:{},groupInfo:{},hash:null}}},computed:{...H(["ourIdentityContractId"]),...oe(["currentGroupId"]),pageStatus:{get(){return this.ephemeral.pageStatus},set(e){let t=["LOADING","SIGNING","LOGGING","INVALID","EXPIRED","JOINED"];if(!t.includes(e))throw new Error(`Bad status: ${e}. Use one of the following: ${t.join(", ")}`);this.ephemeral.pageStatus=e}}},mounted(){this.ephemeral.hash=new URLSearchParams(this.$route.hash.slice(1)),Ns||!this.ourIdentityContractId?this.initialize():c("okTurtles.events/once",Je,()=>this.initialize())},methods:{async initialize(){try{let e=b("You should ask for a new one. Sorry about that!"),t=this.ephemeral.hash.get("groupId"),o=this.ephemeral.hash.get("secret");if(!t||!o){console.error("Invalid invite link: missing group ID or secret"),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}let r=await c("chelonia/latestContractState",t),s=_t(o),a=r._vm.invites[s];if(a?.expires<Date.now()){console.log("Join.vue error: Link is already expired."),this.ephemeral.errorMsg=e,this.pageStatus="EXPIRED";return}else if(a?.initialQuantity>0&&!a.quantity){console.log("Join.vue error: Link is already used."),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}if(a?.status!==et.VALID){console.error("Join.vue error: Link is not valid."),this.ephemeral.errorMsg=e,this.pageStatus="INVALID";return}if(this.ourIdentityContractId){let i=this.ephemeral.hash?.get("groupId")||"",u=this.$store.state[i]||{};if(this.currentGroupId&&[Z.ACTIVE,Z.PENDING].includes(u?.profiles?.[this.ourIdentityContractId]))this.goToDashboard();else if(this.checkAlreadyJoinedGroup(i)){this.ephemeral.groupInfo={name:u.settings?.groupName||"",id:i},this.pageStatus="JOINED";return}else await this.accept();return}let n=this.ephemeral.hash.get("creatorID"),l=this.ephemeral.hash.get("creatorUsername"),m=l||n,p=m?b("{who} invited you to join their group!",{who:m}):b("You were invited to join");this.ephemeral.invitation={groupName:this.ephemeral.hash.get("groupName")??b("(group name unavailable)"),creatorID:n,creatorUsername:l,message:p},this.pageStatus="SIGNING"}catch(e){console.error(e),this.ephemeral.errorMsg=`${b("Something went wrong. Please, try again.")} ${e.message}`,this.pageStatus="INVALID"}},isStatus(e){return this.pageStatus===e},goHome(){this.$router.push({path:"/"})},checkAlreadyJoinedGroup(e){if(this.ourIdentityContractId){let t=this.$store.state[this.ourIdentityContractId]?.groups||{};return t[e]&&!t[e]?.hasLeft}else return!1},goToDashboard(e){e&&this.currentGroupId!==e&&c("gi.app/group/switch",e),this.$router.push({path:"/dashboard"})},async accept(){this.ephemeral.errorMsg=null;let e=this.ephemeral.hash.get("groupId"),t=this.ephemeral.hash.get("secret"),o=this.$store.state.contracts[e]?.profiles?.[this.ourIdentityContractId]?.status;if([Z.ACTIVE,Z.PENDING].includes(o))return this.goToDashboard();try{await c("gi.app/group/joinWithInviteSecret",e,t)}catch(r){console.error("Join.vue accept() error:",r),this.ephemeral.errorMsg=r.message;let s=this.checkAlreadyJoinedGroup(e);if(this.pageStatus=s?"JOINED":"INVALID",s){let a=this.$store.state[e]||{};this.ephemeral.groupInfo={name:a.settings?.groupName||"",id:e}}else c("gi.ui/prompt",{heading:b("Failed to join the group"),question:b("Error details:{br_}{err}",{err:r.message,...ye()}),primaryButton:b("Close")})}}}},Qc=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("img",{staticClass:"c-logo",attrs:{src:"/assets/images/logo-transparent.png"}}),e.isStatus("LOADING")?o("loading",{attrs:{theme:"fullView"}}):o("div",{staticClass:"c-page"},[e.isStatus("SIGNING")||e.isStatus("LOGGING")?o("div",[o("div",{staticClass:"c-header"},[o("div",{staticClass:"c-avatars"},[e.ephemeral.invitation.groupPicture?o("avatar",{staticClass:"c-avatars-group",attrs:{src:e.ephemeral.invitation.groupPicture,size:"lg"}}):e._e(),e.ephemeral.invitation.creatorPicture?o("avatar",{staticClass:"c-avatars-creator",attrs:{src:e.ephemeral.invitation.creatorPicture}}):e._e()],1),o("h1",{staticClass:"is-title-1 c-title",attrs:{"data-test":"groupName"}},[e._v(e._s(e.ephemeral.invitation.groupName))]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"invitationMessage"}},[e._v(e._s(e.ephemeral.invitation.message))])]),o("div",{staticClass:"card"},[e.isStatus("SIGNING")?o("signup-form",{attrs:{postSubmit:e.accept}}):o("login-form",{attrs:{postSubmit:e.accept}})],1),e.isStatus("SIGNING")?o("p",{staticClass:"c-switchEnter"},[o("i18n",[e._v("Already have an account?")]),e._v("\xA0"),o("i18n",{staticClass:"link",attrs:{tag:"button"},on:{click:function(r){e.pageStatus="LOGGING"}}},[e._v("Log in")])],1):o("p",{staticClass:"c-switchEnter"},[o("i18n",[e._v("Not on Group Income yet?")]),e._v("\xA0"),o("i18n",{staticClass:"link",attrs:{tag:"button"},on:{click:function(r){e.pageStatus="SIGNING"}}},[e._v("Create an account")])],1)]):e.isStatus("JOINED")?o("div",{staticClass:"c-joined"},[o("svg-create-group",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:{groupName:e.ephemeral.groupInfo.name}}},[e._v("You are already a member of '{groupName}'")]),o("i18n",{staticClass:"has-text-1",attrs:{tag:"p","data-test":"helperText"}},[e._v("You cannot join already joined group.")]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:function(r){return e.goToDashboard(e.ephemeral.groupInfo.id)}}},[e._v("Go to dashboard")])],1):e.isStatus("INVALID")?o("div",{staticClass:"c-broken"},[o("svg-broken-link",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:e.LTags()}},[e._v("Oh no! {br_}This invite is not valid")]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"helperText"}},[e._v(e._s(e.ephemeral.errorMsg))]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:e.goHome}},[e._v("Take me home")])],1):e.isStatus("EXPIRED")?o("div",{staticClass:"c-broken"},[o("svg-broken-link",{staticClass:"c-svg"}),o("i18n",{staticClass:"is-title-1",attrs:{tag:"h1","data-test":"pageTitle",args:e.LTags()}},[e._v("Oh no! {br_}This invite is already expired")]),o("p",{staticClass:"has-text-1",attrs:{"data-test":"helperText"}},[e._v(e._s(e.ephemeral.errorMsg))]),o("i18n",{staticClass:"c-goHome",attrs:{tag:"button"},on:{click:e.goHome}},[e._v("Take me home")])],1):e._e()])],1)},Zc=[],el=function(e){e&&e("data-v-83f79d74_0",{source:".c-logo[data-v-83f79d74]{min-width:8rem;width:8rem;margin:auto}@media screen and (min-width:769px),print{.c-logo[data-v-83f79d74]{position:absolute;top:1.5rem;left:1.5rem}}.c-page[data-v-83f79d74]{max-width:33rem;margin:auto;height:100%}.c-welcome[data-v-83f79d74]{margin-top:-1.5rem}.c-header[data-v-83f79d74]{margin-top:1rem;display:flex;flex-direction:column;align-items:center}.c-header .c-title[data-v-83f79d74]{order:2}@media screen and (min-width:769px),print{.c-header[data-v-83f79d74]{margin-top:2.5rem}}.c-avatars[data-v-83f79d74]{position:relative;margin-bottom:1.5rem}@media screen and (min-width:769px),print{.c-avatars .c-avatars-group.is-lg[data-v-83f79d74]{width:8rem;height:8rem}}.c-avatars .c-avatars-creator[data-v-83f79d74]{position:absolute;bottom:0;right:0;border:2px solid #fff}.card[data-v-83f79d74]{padding:1.5rem 1rem;margin-top:1.5rem}@media screen and (min-width:769px),print{.card[data-v-83f79d74]{padding:2.5rem}}.c-switchEnter[data-v-83f79d74]{margin-top:1.5rem;text-align:center}.c-broken[data-v-83f79d74],.c-joined[data-v-83f79d74]{margin-top:20vh;text-align:center}.c-broken .is-title-1[data-v-83f79d74],.c-joined .is-title-1[data-v-83f79d74]{margin-top:3rem;margin-bottom:.5rem}.c-broken .c-goHome[data-v-83f79d74],.c-joined .c-goHome[data-v-83f79d74]{margin-top:2rem}@media screen and (min-width:769px),print{.c-debug[data-v-83f79d74]{position:absolute;bottom:1rem;right:1rem}}",map:void 0,media:void 0})},tl="data-v-83f79d74",ol=void 0,rl=!1;function nl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function hr(){let e=hr.styles||(hr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var il=nl({render:Qc,staticRenderFns:Zc},el,Yc,tl,rl,ol,!1,hr,void 0,void 0),gr=il;Q();var sl={name:"LoadingModal",components:{ModalTemplate:to},props:{type:{type:Number,default:500}}},al=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading")}},[o("template",{slot:"title"},[e.type===500?o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("500")]):o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("404")])],1),e.type===500?o("div",{staticClass:"c-wrapper"},[o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Server error")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We are having some trouble. Please try again later.")])],1):o("div",{staticClass:"c-wrapper"},[o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Page not found")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We couldn\u2019t find what you are looking for.")]),o("router-link",{staticClass:"button",attrs:{to:"/"}},[o("i18n",[e._v("Take me home")])],1)],1)],2)},cl=[],ll=function(e){e&&e("data-v-6a5ffef8_0",{source:".c-title[data-v-6a5ffef8]{padding:1.5rem 0}.c-wrapper[data-v-6a5ffef8]{text-align:center}",map:void 0,media:void 0})},ul="data-v-6a5ffef8",dl=void 0,pl=!1;function ml(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function vr(){let e=vr.styles||(vr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var fl=ml({render:al,staticRenderFns:cl},ll,sl,ul,pl,dl,!1,vr,void 0,void 0),br=fl;var hl={name:"ErrorPage",props:{type:{type:Number,default:500}},data(){return{ephemeral:{isOnline:null}}},methods:{onlineHandler(){this.ephemeral.isOnline=!0},offlineHandler(){this.ephemeral.isOnline=!1},onRetryClick(){window.location.reload()}},mounted(){navigator.onLine===!0&&this.onlineHandler(),window.addEventListener("online",this.onlineHandler),window.addEventListener("offline",this.offlineHandler)},beforeDestroy(){window.removeEventListener("online",this.onlineHandler),window.removeEventListener("offline",this.offlineHandler)}},gl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.type===500?o("div",{staticClass:"p-wrapper"},[o("h1",{staticClass:"is-title-1 p-title"},[e._v("500")]),o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Server error")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We are having some trouble. Please try again later.")]),e.ephemeral.isOnline?o("i18n",{staticClass:"is-outlined is-small c-retry-btn",attrs:{tag:"button"},on:{click:e.onRetryClick}},[e._v("Retry")]):e._e()],1):o("div",{staticClass:"p-wrapper"},[o("h1",{staticClass:"is-title-1 p-title"},[e._v("404")]),o("i18n",{staticClass:"is-title-3 c-title",attrs:{tag:"h2"}},[e._v("Page not found")]),o("i18n",{staticClass:"c-text",attrs:{tag:"p"}},[e._v("We couldn\u2019t find what you are looking for.")]),o("router-link",{staticClass:"button",attrs:{to:"/"}},[o("i18n",[e._v("Take me home")])],1)],1)},vl=[],bl=function(e){e&&e("data-v-09c500b0_0",{source:".p-wrapper[data-v-09c500b0]{display:flex;flex-direction:column;text-align:center;justify-content:center;align-items:center}.c-title[data-v-09c500b0]{margin-bottom:.5rem}.c-text[data-v-09c500b0]{color:var(--text_1)}.c-text+.button[data-v-09c500b0]{align-self:center;margin-top:2rem}.c-retry-btn[data-v-09c500b0]{width:max-content}",map:void 0,media:void 0})},_l="data-v-09c500b0",yl=void 0,xl=!1;function wl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function _r(){let e=_r.styles||(_r.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Sl=wl({render:gl,staticRenderFns:vl},bl,hl,_l,xl,yl,!1,_r,void 0,void 0),Rs=Sl;var Il={name:"LoadingModal",components:{ModalTemplate:to}},kl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading"),loading:!0,"data-test":"loadingModal"}},[o("template",{slot:"title"},[o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("Loading...")])],1),o("div",{staticClass:"loading-box"})],2)},Tl=[],Cl=function(e){e&&e("data-v-1809ff32_0",{source:".c-title[data-v-1809ff32]{padding:1.5rem 0}",map:void 0,media:void 0})},El="data-v-1809ff32",Al=void 0,Nl=!1;function Rl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function yr(){let e=yr.styles||(yr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Ol=Rl({render:kl,staticRenderFns:Tl},Cl,Il,El,Nl,Al,!1,yr,void 0,void 0),Os=Ol;var Pl={name:"LoadingModal",components:{ModalBaseTemplate:Ni}},Ll=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("modal-base-template",{ref:"modal",staticClass:"has-background",attrs:{a11yTitle:e.L("Loading"),loading:!0}},[o("div",{staticClass:"wrapper-container"},[o("div",{staticClass:"container"},[o("i18n",{staticClass:"is-title-2 c-title",attrs:{tag:"h2"}},[e._v("Loading...")]),o("div",{staticClass:"loading-box"})],1)])])},Ml=[],Dl=function(e){e&&e("data-v-4f5fa5b8_0",{source:".wrapper-container[data-v-4f5fa5b8]{height:100%;width:100%;opacity:1;background-color:var(--general_2)}.container[data-v-4f5fa5b8]{max-width:66vw;margin:0 auto}.c-title[data-v-4f5fa5b8]{padding:2.5rem 0 1rem 0}",map:void 0,media:void 0})},Gl="data-v-4f5fa5b8",Fl=void 0,Ul=!1;function $l(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function xr(){let e=xr.styles||(xr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Bl=$l({render:Ll,staticRenderFns:Ml},Dl,Pl,Gl,Ul,Fl,!1,xr,void 0,void 0),Ps=Bl;var jl={name:"LoadingPage"},zl=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-wrapper"},[o("header",{staticClass:"p-header"},[o("h1",{staticClass:"is-title-2 p-title"},[o("img",{staticClass:"c-logo",attrs:{src:"/assets/images/group-income-icon-transparent.png",alt:""}}),e._v(e._s(e.$route.meta.title))])]),e._m(0)])},Hl=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("main",{staticClass:"p-main"},[o("div",{staticClass:"loading-box"}),o("div",{staticClass:"loading-box"}),o("div",{staticClass:"loading-box"})])}],Wl=function(e){e&&e("data-v-0f1d4d2c_0",{source:'.p-wrapper[data-v-0f1d4d2c]{display:grid;grid-template-areas:"p-header" "p-main";grid-template-columns:1fr;grid-template-rows:auto minmax(0,1fr);height:100%;width:100vw}@media screen and (min-width:1200px){.p-wrapper[data-v-0f1d4d2c]{width:auto;grid-template-columns:minmax(0,1fr) 16.5rem;grid-template-areas:"p-header p-sidebar" "p-main p-sidebar"}}.p-main[data-v-0f1d4d2c]{grid-area:p-main;width:calc(100% - 2rem);margin:0 auto;padding-top:1.5rem;max-width:50rem;display:flex;flex-direction:column;-webkit-overflow-scrolling:touch}@media screen and (min-width:769px),print{.p-main[data-v-0f1d4d2c]{width:calc(100% - 4rem)}}@media screen and (min-width:1200px){.p-main[data-v-0f1d4d2c]{width:auto;padding-top:0;margin-right:2rem;margin-left:5.5rem}}.p-header[data-v-0f1d4d2c]{grid-area:p-header;transition:padding ease-out .3s;text-align:center;min-height:4rem}@media screen and (max-width:1199px){.p-header[data-v-0f1d4d2c]{display:flex;justify-content:center;align-items:center;position:sticky;top:0;background:var(--general_2);z-index:3}}@media screen and (min-width:1200px){.p-header[data-v-0f1d4d2c]{display:block;padding-top:1.125rem;text-align:left;min-height:4.75rem;padding-left:5.5rem}}.p-title[data-v-0f1d4d2c]{display:flex;align-items:center}.c-logo[data-v-0f1d4d2c]{width:1.5rem;height:1.5rem;margin-right:1rem}@media screen and (min-width:1200px){.c-logo[data-v-0f1d4d2c]{display:none}}',map:void 0,media:void 0})},Vl="data-v-0f1d4d2c",ql=void 0,Kl=!1;function Xl(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function wr(){let e=wr.styles||(wr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Jl=Xl({render:zl,staticRenderFns:Hl},Wl,jl,Vl,Kl,ql,!1,wr,void 0,void 0),Ls=Jl;function Ms(e,{loading:t,error:o}={}){return()=>({component:e().then(r=>r.default??r),loading:t,error:o})}function D(e,t,{loading:o,error:r}={}){I.component(e,Ms(t,{loading:o,error:r}))}function U(e,t){D(e,t,{loading:Os,error:br})}function rt(e,t){D(e,t,{loading:Ps,error:br})}function ge(e,{loading:t=Ls,error:o=Rs}={}){let r=Ms(e,{loading:t,error:o});return()=>Promise.resolve({functional:!0,render(s,{data:a,children:n}){return s(r,a,n)}})}U("AccountRemovalModal",()=>import("./AccountRemovalModal-DXHPS7NI-cached.js"));U("ChatMembersAllModal",()=>import("./ChatMembersAllModal-XQ4VLSKA-cached.js"));U("CreateNewChannelModal",()=>import("./CreateNewChannelModal-BWWQZEDP-cached.js"));U("DeleteChannelModal",()=>import("./DeleteChannelModal-7H3VVFXT-cached.js"));U("EditChannelDescriptionModal",()=>import("./EditChannelDescriptionModal-LZOVAJLC-cached.js"));U("EditChannelNameModal",()=>import("./EditChannelNameModal-AG3MONYP-cached.js"));U("ChatNotificationSettingsModal",()=>import("./ChatNotificationSettingsModal-M3UM5UV2-cached.js"));U("GroupLeaveModal",()=>import("./GroupLeaveModal-3UZKELQA-cached.js"));U("GroupDeletionModal",()=>import("./GroupDeletionModal-4NUM5Z7A-cached.js"));U("InvitationLinkModal",()=>import("./InvitationLinkModal-T2HFVICR-cached.js"));U("LeaveChannelModal",()=>import("./LeaveChannelModal-7LAT4ZBS-cached.js"));U("LoginModal",()=>import("./LoginModal-NT7ARKP4-cached.js"));U("NotificationModal",()=>import("./NotificationModal-GUNHLZRY-cached.js"));U("PasswordModal",()=>import("./PasswordModal-H6CS6I4N-cached.js"));U("SignupModal",()=>import("./SignupModal-CC2KFD6B-cached.js"));U("Prompt",()=>import("./Prompt-4NKEJHWD-cached.js"));U("SendThankYouModal",()=>import("./SendThankYouModal-QJC6EZRY-cached.js"));U("ThankYouNoteModal",()=>import("./ThankYouNoteModal-NLJEXKLC-cached.js"));U("AvatarEditorModal",()=>import("./AvatarEditorModal-T6S5R346-cached.js"));U("ChatFileAttachmentWarningModal",()=>import("./ChatFileAttachmentWarningModal-FAULRHMT-cached.js"));U("ImageViewerModal",()=>import("./ImageViewerModal-MI2JSL3U-cached.js"));rt("GroupCreationModal",()=>import("./GroupCreationModal-EINCIFKK-cached.js"));rt("GroupJoinModal",()=>import("./GroupJoinModal-QH7EMZOE-cached.js"));rt("GroupMembersAllModal",()=>import("./GroupMembersAllModal-Y77FLVCL-cached.js"));rt("IncomeDetails",()=>import("./IncomeDetails-GXPY4ECV-cached.js"));rt("UserSettingsModal",()=>import("./UserSettingsModal-OCGEBYDC-cached.js"));D("AddMembers",()=>import("./AddMembers-LWRFQUAY-cached.js"));D("ChangeVotingRules",()=>import("./ChangeVotingRules-3GIZ4GRV-cached.js"));D("MincomeProposal",()=>import("./Mincome-7T26IM5M-cached.js"));D("DistributionDateProposal",()=>import("./DistributionDate-QTJ2TN3F-cached.js"));D("PaymentsHistoryModal",()=>import("./PaymentsHistoryModal-OUAQ5TNW-cached.js"));D("RemoveMember",()=>import("./RemoveMember-AAZLDIQL-cached.js"));D("GenericProposal",()=>import("./GenericProposal-U6QPJKDC-cached.js"));rt("PropositionsAllModal",()=>import("./PropositionsAllModal-5LITQENO-cached.js"));D("PaymentDetail",()=>import("./PaymentDetail-JUGETP5W-cached.js"));D("RecordPayment",()=>import("./RecordPayment-JWF3CNH5-cached.js"));D("SendPaymentsViaLightning",()=>import("./SendPaymentsViaLightning-QP6PMMXE-cached.js"));D("ExportPaymentsModal",()=>import("./ExportPaymentsModal-YMZSVK3N-cached.js"));D("Appearence",()=>import("./Appearence-7QVYDCOT-cached.js"));D("NotificationSettings",()=>import("./NotificationSettings-FIWD4UKT-cached.js"));D("AppLogs",()=>import("./AppLogs-AOQFXBRY-cached.js"));D("NewDirectMessageModal",()=>import("./NewDirectMessageModal-32IYVQ6S-cached.js"));D("Placeholder",()=>import("./Placeholder-AAI57BQ7-cached.js"));D("Troubleshooting",()=>import("./Troubleshooting-UYFKZB3F-cached.js"));D("UserProfile",()=>import("./UserProfile-TNY4ZDC7-cached.js"));D("Acknowledgements",()=>import("./Acknowledgements-J3M5LOCV-cached.js"));D("DSModalFullscreen",()=>import("./DSModalFullscreen-Z7QJ4KAR-cached.js"));D("DSModalNested",()=>import("./DSModalNested-PIKKEYZL-cached.js"));D("DSModalQuery",()=>import("./DSModalQuery-2EAIQKDC-cached.js"));Q();var Yl=ge(()=>import("./Contributions-ZNFZG3U6-cached.js")),Ql=ge(()=>import("./DesignSystem-YLM3JFMW-cached.js")),Ds=ge(()=>import("./GroupChat-34J6JU6J-cached.js")),Zl=ge(()=>import("./GroupDashboard-VHLUMYUF-cached.js")),eu=ge(()=>import("./GlobalDashboard-XYPCMJSB-cached.js")),tu=ge(()=>import("./GroupSettings-UHQCL47H-cached.js")),ou=ge(()=>import("./Payments-JLBEIICU-cached.js")),ru=ge(()=>import("./PendingApproval-WUULHSZC-cached.js"));I.use(Ko);var nu={guard:(e,t)=>!!se.state.currentGroupId,redirect:(e,t)=>({path:se.getters.seenWelcomeScreen?"/dashboard":"/pending-approval"})},Ae={guard:(e,t)=>!se.state.loggedIn,redirect:(e,t)=>({path:"/",query:{next:e.fullPath}})},iu={guard:(e,t)=>!(e.hash.includes("groupId=")&&e.hash.includes("secret=")),redirect:(e,t)=>({path:"/"})},Ue={guard:(e,t)=>!se.state.currentGroupId,redirect:(e,t)=>({path:"/"})},nt={guard:(e,t)=>se.state.currentGroupId&&!se.getters.ourProfileActive,redirect:(e,t)=>({path:"/pending-approval"})};function pe(...e){return function(t,o,r){for(let s of e)if(s.guard(t,o))return r(s.redirect(t,o));r()}}var Sr=new Ko({mode:"history",base:"/app",scrollBehavior(e,t,o){return{x:0,y:0}},routes:[{path:"/",component:Es,name:"home",meta:{title:b("Group Income")},beforeEnter:pe(nu)},{path:"/design-system",component:Ql,name:"DesignSystem",meta:{title:b("Design System")}},{path:"/dashboard",component:Zl,name:"GroupDashboard",meta:{title:b("Group Dashboard")},beforeEnter:pe(Ae,Ue,nt)},{path:"/global-dashboard/:id",component:eu,name:"GlobalDashboard",meta:{title:b("Global Dashboard")},beforeEnter:pe(Ae,Ue)},{path:"/global-dashboard",redirect:"/global-dashboard/news-and-updates"},{path:"/contributions",component:Yl,name:"Contributions",meta:{title:b("Contributions")},beforeEnter:pe(Ae,Ue,nt)},{path:"/payments",component:ou,name:"Payments",meta:{title:b("Payments")},beforeEnter:pe(Ae,Ue,nt)},{path:"/group-chat",component:Ds,name:"GroupChat",meta:{title:b("Group Chat")},beforeEnter:pe(Ae,Ue,nt)},{path:"/group-chat/:chatRoomID",component:Ds,name:"GroupChatConversation",meta:{title:b("Loading")},beforeEnter:pe(Ae,Ue,nt)},{path:"/group-settings",component:tu,name:"GroupSettings",meta:{title:b("Group Settings")},beforeEnter:pe(Ae,Ue,nt)},{path:"/join",name:gr.name,component:gr,meta:{title:b("Join a Group")},beforeEnter:pe(iu)},{path:"/pending-approval",component:ru,name:"PendingApproval",meta:{title:b("Pending Approval")},beforeEnter:pe(Ae)},{path:"*",redirect:"/"}]});Sr.beforeEach((e,t,o)=>{if(e.query.modal&&!["Prompt","SignupModal","LoginModal"].includes(e.query.modal)&&!se.state.loggedIn)return o({path:"/",query:{next:e.fullPath}});document.title=e.meta.title,o()});c("sbp/selectors/register",{"controller/router":()=>Sr});var mo=Sr;var fo=(()=>{let e;return()=>(e==null&&(e=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)").matches||navigator.standalone),e)})();var ho={deferredInstallPrompt:null,installed:!1};Me.register(Pi);Me.register(te);window.addEventListener("beforeinstallprompt",e=>{ho.deferredInstallPrompt=e,c("okTurtles.events/emit",Bt)});var Ir=new WeakMap,kr=()=>{let e=new Promise((t,o)=>{let r=new MessageChannel;r.port1.onmessage=a=>{a.data.type==="ready"?(a.data.currentSyncs&&c("okTurtles.events/emit",jt,a.data.currentSyncs),t()):o(a.data.error),r.port1.close()},r.port1.onmessageerror=()=>{o(new Error("Message error")),r.port1.close()};let s=()=>{navigator.serviceWorker.removeEventListener("controllerchange",s,!1),t(kr())};navigator.serviceWorker.addEventListener("controllerchange",s,!1),navigator.serviceWorker.ready.then(a=>{if(Ir.has(a.active)){t(Ir.get(a.active));return}Ir.set(a.active,e),a.active.postMessage({type:"ready",port:r.port2,GI_VERSION:"2.0.0"},[r.port2])}).catch(a=>{o(a),r.port1.close()})});return e};c("sbp/selectors/register",{"service-worker/setup":async function(){if(!("serviceWorker"in navigator))throw new Error("Service worker APIs missing");try{let e=new URLSearchParams([["routerBase",c("controller/router").options.base??""],["standalone",fo()?"1":"0"]]),t=await navigator.serviceWorker.register(`/assets/js/sw-primary.js?${e}`,{scope:"/"});if(t.active==null&&t.installing==null&&t.waiting==null)throw new Error("No valid service worker found");await t.update(),setInterval(()=>c("service-worker/update"),De),navigator.serviceWorker.addEventListener("message",o=>{let r=o.data,s=c("sbp/selectors/fn","okTurtles.events/emit");if(typeof r=="object"&&r.type)switch(r.type){case"pong":break;case"event":{c("okTurtles.events/emit",o.data.subtype,...Me(o.data.data));break}case"navigate":{r.groupID&&c("state/vuex/commit","setCurrentGroupId",{contractID:r.groupID}),c("controller/router").push({path:r.path}).catch(console.warn);break}case"sbp":{c(...Me(o.data.data));break}case Pe:{s(Pe,...Me(o.data.data));break}default:console.error("[sw] Received unknown message type from the service worker:",r);break}}),await kr(),typeof PeriodicSyncManager=="function"&&navigator.permissions.query({name:"periodic-background-sync"}).then(o=>{if(o.state!=="granted"){console.error("[service-workers/setup] Periodic sync event permission denied");return}return navigator.serviceWorker.ready.then(r=>r.periodicSync.register("periodic-notifications",{minInterval:12*De}))}).catch(o=>{console.error("[service-workers/setup] Error setting up periodic background sync events",o)}),t.addEventListener("updatefound",o=>{let r=s=>{if(["activated","redundant"].includes(s.target.state)){s.target.removeEventListener("statechange",r);return}s.target.state==="installed"&&s.target.postMessage({type:"skip-waiting"})};o.target.installing.addEventListener("statechange",r,!1)}),setInterval(()=>navigator.serviceWorker.controller?.postMessage({type:"ping"}),5e3)}catch(e){throw console.error("error setting up service worker:",e),e}},"service-worker/setup-push-subscription":async function(e=1){let t=null;await c("okTurtles.eventQueue/queueEvent","service-worker/setup-push-subscription",async()=>{let{notificationEnabled:o}=c("state/vuex/state").settings,r=await navigator.serviceWorker.ready;if(!r)throw new Error("No service-worker registration found!");let a=await r.pushManager.permissionState({userVisibleOnly:!0})==="granted"||Notification.permission==="granted";console.info(`[service-worker/setup-push-subscription] setup: notifications (${o}) perms (${a})`);try{let n=null,l=null;if(o&&a){n=await r.pushManager.getSubscription();let m=!1,p=null;if(!n||n.expirationTime!=null&&n.expirationTime<=Date.now()){let i=await c("push/getSubscriptionOptions");n=await r.pushManager.subscribe(i),m=!0}n?.endpoint&&(p=new URL(n.endpoint).host,l=await ci(n.toJSON())),console.info(`[service-worker/setup-push-subscription] got ${m?"new":"existing"} subscription '${l}':`,p)}console.info("[service-worker/setup-push-subscription] calling push/reportExistingSubscription on:",l),await c("push/reportExistingSubscription",n?.toJSON(),n?.options.applicationServerKey)}catch(n){if(console.error("[service-worker/setup-push-subscription] error getting a subscription:",n),e>=12)throw console.error("[service-worker/setup-push-subscription] maxAttempts reached, giving up"),c("gi.ui/prompt",{heading:b("Error setting up push notifications"),question:b("Error setting up push notifications: {errMsg}{br_}{br_}Please make sure {a_}push services are enabled{_a} in your Browser settings, and then try reloading the app and toggling the push notifications toggle in the Notifications user settings.",{errMsg:n?.message,a_:'<a class="link" target="_blank" href="https://stackoverflow.com/a/69624651">',_a:"</a>",br_:"<br/>"}),primaryButton:b("Close")}),n;t=new Promise((l,m)=>{setTimeout(()=>{c("service-worker/setup-push-subscription",e+1).then(l).catch(m)},5e3)})}}),t&&await t},"service-worker/update":async function(){if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.ready;if(e)return await e.update();console.debug("[sw] No active service-worker was found while checking for the updates.");return}catch(e){console.error(`[sw] Failed to update the service-worker! - ${e.message}`)}},"service-worker/check-pwa-installability":function(){return!!ho.deferredInstallPrompt},"service-worker/trigger-install-prompt":async function(){return ho.deferredInstallPrompt?(await ho.deferredInstallPrompt.prompt()).outcome:!1}});[we,Le].forEach(e=>c("okTurtles.events/on",e,(...t)=>{navigator.serviceWorker.controller?.postMessage({type:"event",subtype:e,data:t})}));c("okTurtles.events/on",ht,e=>{e.from!=="sw"&&navigator.serviceWorker.controller?.postMessage({type:"event",subtype:ht,data:[e]})});c("okTurtles.events/on",gt,e=>{e.from!=="sw"&&navigator.serviceWorker.controller?.postMessage({type:"event",subtype:gt,data:[e]})});var $e=(()=>{if(!navigator.serviceWorker)throw new Error("Missing service worker object");let e=navigator.serviceWorker.controller;navigator.serviceWorker.addEventListener("controllerchange",o=>{e=navigator.serviceWorker.controller},!1);let t=async(o,...r)=>{if(!e)throw new Error("Service worker not ready");return await kr(),new Promise((s,a)=>{let n=new MessageChannel,l=h=>{if(h.data&&Array.isArray(h.data)){let g=Me(h.data[1]);h.data[0]===!0?s(g):a(g),i()}},m=h=>{a(h.data),i()},p=h=>{o>0?s(t(o-1,...r)):a(new Error("SW controller changed")),i()},i=()=>{n.port1.removeEventListener("message",l,!1),n.port1.removeEventListener("messageerror",m,!1),navigator.serviceWorker.removeEventListener("controllerchange",p,!1),n.port1.close()};n.port1.addEventListener("message",l,!1),n.port1.addEventListener("messageerror",m,!1),navigator.serviceWorker.addEventListener("controllerchange",p,!1),n.port1.start();let{data:u,transferables:d}=ei(r);e.postMessage({type:"sbp",port:n.port2,data:u},[n.port2,...d])})};return(...o)=>t(3,...o)})();c("sbp/selectors/register",{"gi.actions/*":$e,"chelonia/*":$e,"sw-namespace/*":(...e)=>$e(e[0].slice(3),...e.slice(1)),"gi.notifications/*":$e,"sw/*":$e,"swLogs/*":$e,"push/*":$e});var su={name:"AppStyles",mixins:[Li],computed:{...H(["fontSize","colors"]),softTone(){return this.colors.theme==="dark"?.1:-.1}}},au=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-style",[e._v(`:root {
  --primary_0: `+e._s(e.colors.primary_0)+`;
  --primary_0_1: `+e._s(e.lightenDarkenColor(e.colors.primary_0,e.softTone))+`;
  --primary_1: `+e._s(e.colors.primary_1)+`;
  --primary_2: `+e._s(e.colors.primary_2)+`;
  --success_0: `+e._s(e.colors.success_0)+`;
  --success_0_1: `+e._s(e.lightenDarkenColor(e.colors.success_0,e.softTone))+`;
  --success_1: `+e._s(e.colors.success_1)+`;
  --success_2: `+e._s(e.colors.success_2)+`;
  --warning_0: `+e._s(e.colors.warning_0)+`;
  --warning_0_1: `+e._s(e.lightenDarkenColor(e.colors.warning_0,e.softTone))+`;
  --warning_0_text: `+e._s(e.colors.warning_0_text)+`;
  --warning_0_2: `+e._s(e.colors.warning_0_2)+`;
  --warning_1: `+e._s(e.colors.warning_1)+`;
  --warning_2: `+e._s(e.colors.warning_2)+`;
  --danger_0: `+e._s(e.colors.danger_0)+`;
  --danger_0_1: `+e._s(e.lightenDarkenColor(e.colors.danger_0,e.softTone))+`;
  --danger_1: `+e._s(e.colors.danger_1)+`;
  --danger_2: `+e._s(e.colors.danger_2)+`;
  --danger_3: `+e._s(e.colors.danger_3)+`;
  --text_0: `+e._s(e.colors.text_0)+`;
  --text_1: `+e._s(e.colors.text_1)+`;
  --general_0: `+e._s(e.colors.general_0)+`;
  --general_1: `+e._s(e.colors.general_1)+`;
  --general_1_opacity_6: `+e._s(e.hexToRgbA(e.colors.general_1,.6))+`;
  --general_2: `+e._s(e.colors.general_2)+`;
  --background_0: `+e._s(e.colors.background_0)+`;
  --background_0_opacity_0: `+e._s(e.hexToRgbA(e.colors.background_0,0))+`;
  --text-size: `+e._s(e.fontSize)+`px;
}`)])},cu=[],lu=void 0,uu=void 0,du=void 0,pu=!1;function mu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`script>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var fu=mu({render:au,staticRenderFns:cu},lu,su,uu,pu,du,!1,void 0,void 0,void 0),Gs=fu;var hu={name:"BannerGeneral",components:{TransitionExpand:Ti},data:()=>({ephemeral:{message:null,icon:null,severity:null}}),methods:{clean(){this.ephemeral.message="",this.ephemeral.icon="",this.ephemeral.severity=""},show(e,t){this.ephemeral.message=e,this.ephemeral.icon=t,this.ephemeral.severity="neutral"},danger(e,t){this.ephemeral.message=e,this.ephemeral.icon=t,this.ephemeral.severity="danger"},severity(){return this.ephemeral.severity},debouncedShow({message:e,icon:t,seconds:o,clearWhen:r}){let s;return Qe((...a)=>{let n=()=>{r()?(this.severity()!=="danger"&&this.clean(),s=void 0):setTimeout(n,500)};!s&&!r()&&(this.show(e(...a),t),s=setTimeout(n,1e3*o))},1e3*o)}}},gu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition-expand",[e.ephemeral.message?o("div",{staticClass:"l-banner",class:"is-"+e.ephemeral.severity,attrs:{"data-test":"bannerGeneral","aria-live":"polite"}},[o("i",{class:"icon-"+e.ephemeral.icon+" is-prefix"}),o("div",{directives:[{name:"safe-html",rawName:"v-safe-html:a",value:e.ephemeral.message,expression:"ephemeral.message",arg:"a"}],staticClass:"c-banner-content"})]):e._e()])},vu=[],bu=function(e){e&&e("data-v-42dd8395_0",{source:".l-banner[data-v-42dd8395]{display:flex;justify-content:center;align-items:flex-start}.l-banner .c-banner-content[data-v-42dd8395]{text-align:left;word-break:break-word}.l-banner[data-v-42dd8395]  .link{color:inherit;border-bottom-color:inherit;font-weight:inherit}.is-neutral[data-v-42dd8395]{background-color:var(--text_0);color:var(--background_0)}.is-danger[data-v-42dd8395]{background-color:var(--danger_0);color:var(--background_0)}",map:void 0,media:void 0})},_u="data-v-42dd8395",yu=void 0,xu=!1;function wu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Tr(){let e=Tr.styles||(Tr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Su=wu({render:gu,staticRenderFns:vu},bu,hu,_u,xu,yu,!1,Tr,void 0,void 0),Fs=Su;var Iu={name:"Modal",data(){return{content:null,subcontent:[],queries:{},replacementQueries:{},childData:{},replacement:null,lastFocus:null}},computed:{activeSubContent(){return this.subcontent.length?this.subcontent[this.subcontent.length-1]:null}},created(){c("okTurtles.events/on",z,this.openModal),c("okTurtles.events/on",$o,this.unloadModal),c("okTurtles.events/on",mt,this.replaceModal),c("okTurtles.events/on",Bo,this.setModalQueries),window.addEventListener("keyup",this.handleKeyUp)},mounted(){let{modal:e,subcontent:t}=this.$route.query;e&&this.openModal(e),t&&this.openModal(t)},beforeDestroy(){c("okTurtles.events/off",z),c("okTurtles.events/off",$o),c("okTurtles.events/off",mt),c("okTurtles.events/off",Bo),window.removeEventListener("keyup",this.handleKeyUp)},watch:{$route(e,t){let o=e.query.modal;if(o){if(o!==this.content&&(this.content?this.replaceModal(o,Bn(e.query,"modal")):this.content=o),e.query.subcontent){let r=e.query.subcontent.split("+").pop();if(r!==this.activeSubContent){let s=this.subcontent.indexOf(r);s!==-1?this.subcontent=this.subcontent.slice(0,s):this.subcontent=[r]}}}else this.content&&this.unloadModal()}},methods:{handleKeyUp(e){this.content&&e.key==="Escape"&&(e.preventDefault(),this.unloadModal())},updateUrl(){let e=this.subcontent.length;if(this.content||e>0){let t=this.queries[this.content]||{},o=this.queries[this.subcontent[e-1]]||{};this.$router.push({query:{...this.$route.query,...t,...o,modal:this.content,subcontent:e?this.subcontent.join("+"):void 0}}).catch(console.error)}else if(this.$route.query.modal||this.$route.query.subcontent){let t={...this.$route.query},o={modal:!0,subcontent:!0,...this.queries[t.modal]};for(let r in o)delete t[r];this.$router.push({rQueries:t}).catch(console.error)}},openModal(e,t={},o={}){this.content!==e&&(this.lastFocus=document.activeElement,this.content?this.subcontent.push(e):this.content=e,this.queries[e]=t,this.updateUrl(),this.childData[e]=o)},unloadModal(e=""){let t=a=>{delete this.childData[a]},o=this.subcontent.length>0,r=!1,s=a=>{t(a),this.content=null,r=!0,this.lastFocus&&this.lastFocus.focus()};e?o&&this.subcontent.indexOf(e)>=0?(t(e),this.subcontent=this.subcontent.filter(a=>a!==e),r=!0):this.content===e&&s(e):o?(t(this.activeSubContent),this.subcontent.pop(),r=!0):s(this.content),r&&(this.replacement?(this.openModal(this.replacement,this.replacementQueries[this.replacement]),delete this.replacementQueries[this.replacement],this.replacement=null):this.updateUrl())},replaceModal(e,t=null){this.replacement=e,t&&(this.replacementQueries[e]=t),this.$refs[this.activeSubContent?"subcontent":"content"].$children[0].close()},setModalQueries(e,t){this.queries[e]=t}}},ku=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o(e.content,e._b({ref:"content",tag:"component"},"component",e.childData[e.content],!1)),e.activeSubContent?o(e.activeSubContent,e._b({ref:"subcontent",tag:"component"},"component",e.childData[e.activeSubContent],!1)):e._e()],1)},Tu=[],Cu=void 0,Eu=void 0,Au=void 0,Nu=!1;function Ru(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`script>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var Ou=Ru({render:ku,staticRenderFns:Tu},Cu,Iu,Eu,Nu,Au,!1,void 0,void 0,void 0),Us=Ou;var Pu={name:"BackgroundSounds",created(){c("okTurtles.events/on",Qn,this.playMessageReceive),c("okTurtles.events/on",Zn,this.playMessageSend)},computed:{volumeFromStore(){return this.$store.getters.notificationVolume??1},isAppIdle(){return this.$store.state.idleVue?.isIdle}},methods:{shouldPlay(e){return!fo()&&!(this.$route.name==="GroupChatConversation"&&this.$route.params.chatRoomID===e&&!this.isAppIdle)},playMessageReceive({contractID:e}){this.shouldPlay(e)&&this.$refs.msgReceive.play()},playMessageSend(){this.shouldPlay()&&this.$refs.msgSend.play()},updateAudioVolumes(){this.$refs.msgReceive.volume=this.volumeFromStore,this.$refs.msgSend.volume=this.volumeFromStore}},mounted(){this.updateAudioVolumes()},watch:{volumeFromStore(){this.updateAudioVolumes()}}},Lu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"c-bgsound-wrapper"},[o("audio",{ref:"msgReceive",attrs:{src:"/assets/audio/msg-received.mp3",type:"audio/mpeg"}}),o("audio",{ref:"msgSend",attrs:{src:"/assets/audio/msg-sent.mp3",type:"audio/mpeg"}})])},Mu=[],Du=void 0,Gu="data-v-445785f9",Fu=void 0,Uu=!1;function $u(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};return i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r,i}var Bu=$u({render:Lu,staticRenderFns:Mu},Du,Pu,Gu,Uu,Fu,!1,void 0,void 0,void 0),$s=Bu;var ju={name:"NotificationCard",components:{ModalClose:wi,NotificationList:Ri,Tooltip:Qt},methods:{toggleTooltip(){this.$refs.tooltip.toggle()},handleSettingsClick(){c("okTurtles.events/emit",z,"UserSettingsModal",{tab:"notifications"}),this.toggleTooltip()},markAllNotificationsAsRead(){c("gi.notifications/markAllAsRead",this.currentGroupId)}},computed:{...oe(["currentGroupId"]),...H(["currentNotificationCount"])}},zu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("tooltip",{ref:"tooltip",attrs:{direction:"right",manual:!0,opacity:1,"aria-label":e.L("Show notifications")}},[e._t("default"),o("template",{slot:"tooltip"},[o("div",{staticClass:"card c-card",attrs:{role:"dialog","aria-label":e.L("Notifications"),"data-test":"notificationCard"}},[o("div",{staticClass:"c-header"},[o("i18n",{staticClass:"is-title-4",attrs:{tag:"h2"}},[e._v("Notifications")]),o("button",{staticClass:"is-icon-small c-settings-btn",on:{click:e.handleSettingsClick}},[o("i",{staticClass:"icon-cog"})])],1),o("div",{staticClass:"c-body"},[o("notification-list",{attrs:{variant:"compact"},on:{select:e.toggleTooltip}})],1),e.currentNotificationCount?o("div",{staticClass:"c-footer"},[o("i18n",{staticClass:"link",attrs:{tag:"button","data-test":"markAllAsRead_In_Tooltip"},on:{click:e.markAllNotificationsAsRead}},[e._v("Mark all as read")]),o("router-link",{staticClass:"link",attrs:{to:{query:{modal:"NotificationModal"}}},nativeOn:{click:function(r){return e.toggleTooltip(r)}}},[o("i18n",[e._v("See all")])],1)],1):e._e(),o("modal-close",{staticClass:"c-close",attrs:{"aria-label":e.L("Close profile")},on:{close:e.toggleTooltip}})],1)])],2)},Hu=[],Wu=function(e){e&&e("data-v-32fe52eb_0",{source:'.c-card[data-v-32fe52eb]{position:relative;padding:0 0 4rem;color:var(--text_0);max-width:100vw;border-radius:3px;width:100vw;box-shadow:none}.c-card[data-v-32fe52eb]:last-child{margin-bottom:0}.is-active .c-card[data-v-32fe52eb]{animation:zoom .1s both cubic-bezier(.165,.84,.44,1)}@media screen and (max-width:768px){.is-active .c-card[data-v-32fe52eb]{animation-name:enterFromBottom}}@media screen and (min-width:769px),print{.c-card[data-v-32fe52eb]{margin-top:-.5rem;box-shadow:0 .5rem 1.25rem rgba(54,54,54,.3);width:25rem;padding:0}.c-card[data-v-32fe52eb]::before{content:"";position:absolute;top:1rem;left:-.5rem;display:block;width:0;z-index:0;border-top:.5rem solid transparent;border-right:.5rem solid var(--background_0);border-bottom:.5rem solid transparent}}.c-close[data-v-32fe52eb]{left:calc(100vw - 4rem);top:1.5rem}@media screen and (min-width:769px),print{.c-close[data-v-32fe52eb]{left:auto;right:1rem;opacity:0;pointer-events:none}.c-close[data-v-32fe52eb]:focus{opacity:1}}.c-footer[data-v-32fe52eb],.c-header[data-v-32fe52eb]{display:flex;justify-content:space-between;align-items:center}.c-header[data-v-32fe52eb]{padding:1rem 1rem .5rem}.c-footer[data-v-32fe52eb]{border-top:1px solid var(--general_1);padding:.75rem 1rem}.c-body[data-v-32fe52eb]{height:18rem;overflow:auto;overscroll-behavior-y:contain}.c-settings-btn .icon-cog[data-v-32fe52eb]{transform-origin:49% 48%}.c-settings-btn:focus .icon-cog[data-v-32fe52eb],.c-settings-btn:hover .icon-cog[data-v-32fe52eb]{animation:cog-data-v-32fe52eb .4s forwards}@keyframes cog-data-v-32fe52eb{to{transform:rotate(180deg)}}',map:void 0,media:void 0})},Vu="data-v-32fe52eb",qu=void 0,Ku=!1;function Xu(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Cr(){let e=Cr.styles||(Cr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Ju=Xu({render:zu,staticRenderFns:Hu},Wu,ju,Vu,Ku,qu,!1,Cr,void 0,void 0),Bs=Ju;var Yu={name:"NotificationBell",components:{Badge:tt,NotificationCard:Bs},computed:{...H(["currentUnreadNotificationCount"])}},Qu=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("router-link",{staticClass:"button is-icon-small c-btn hide-tablet",attrs:{to:{query:{modal:"NotificationModal"}}}},[o("i",{staticClass:"icon-bell",class:{"is-active":e.currentUnreadNotificationCount}}),e.currentUnreadNotificationCount?o("badge",{attrs:{"data-test":"alertNotification"}},[e._v(e._s(e.currentUnreadNotificationCount))]):e._e()],1),o("notification-card",[o("button",{staticClass:"is-icon-small c-btn hide-phone"},[o("i",{staticClass:"icon-bell",class:{"is-active":e.currentUnreadNotificationCount}}),e.currentUnreadNotificationCount?o("badge",{attrs:{"data-test":"alertNotification"}},[e._v(e._s(e.currentUnreadNotificationCount))]):e._e()],1)])],1)},Zu=[],ed=function(e){e&&e("data-v-67f648b3_0",{source:".c-badge[data-v-67f648b3]{top:-.25rem;right:-.25rem}.icon-bell[data-v-67f648b3]{font-size:.9rem;transform-origin:center 2px;margin-top:2px}.icon-bell.is-active[data-v-67f648b3]{font-weight:900}.c-btn:focus .icon-bell[data-v-67f648b3],.c-btn:hover .icon-bell[data-v-67f648b3]{animation:bell-data-v-67f648b3 750ms forwards}@keyframes bell-data-v-67f648b3{10%{transform:rotate(15deg)}20%{transform:rotate(-15deg)}35%{transform:rotate(15deg)}60%{transform:rotate(-10deg)}80%{transform:rotate(5deg)}}",map:void 0,media:void 0})},td="data-v-67f648b3",od=void 0,rd=!1;function nd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Er(){let e=Er.styles||(Er.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var id=nd({render:Qu,staticRenderFns:Zu},ed,Yu,td,rd,od,!1,Er,void 0,void 0),js=id;var sd={name:"GroupsList",components:{Avatar:Zt,Badge:tt,Tooltip:Qt},computed:{...oe(["currentGroupId"]),...H(["groupsByName","groupUnreadMessages","unreadGroupNotificationCountFor"]),badgeVisiblePerGroup(){return Object.fromEntries(this.groupsByName.map(e=>[e.contractID,this.groupUnreadMessages(e.contractID)+this.unreadGroupNotificationCountFor(e.contractID)>0]))},isInGlobalDashboard(){return this.$route.path.startsWith("/global-dashboard")}},methods:{openModal(e){c("okTurtles.events/emit",z,e)},handleMenuSelect(e){e&&this.changeGroup(e),this.isInGlobalDashboard&&this.$router.push("/dashboard")},onGlobalDashboardClick(){this.$router.push({path:"/global-dashboard"})},changeGroup(e){let t=this.$route.path,o=this.groupPictureForContract(e)==="";e!==this.currentGroupId&&c("gi.app/group/switch",e),o&&t!=="/pending-approval"?this.$router.push({path:"/pending-approval"}):!o&&t==="/pending-approval"&&this.$router.push({path:"/dashboard"})},groupPictureForContract(e){return this.$store.state[e]?.settings?.groupPicture||""}}},ad=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.groupsByName.length?o("ul",{staticClass:"c-group-list",attrs:{"data-test":"groupsList"}},[o("li",{staticClass:"c-group-list-item group-badge",class:{"is-active":e.isInGlobalDashboard}},[o("tooltip",{attrs:{direction:"right",text:e.L("Global dashboard")}},[o("button",{staticClass:"c-group-picture is-unstyled c-global-dashboard-logo",on:{click:e.onGlobalDashboardClick}},[o("avatar",{staticClass:"c-avatar",attrs:{src:"/assets/images/group-income-icon-transparent-circle.png",alt:"Global dashboard logo"}})],1)])],1),e._l(e.groupsByName,function(r,s){return o("li",{key:"group-"+s,staticClass:"c-group-list-item group-badge",class:{"is-active":!e.isInGlobalDashboard&&e.currentGroupId===r.contractID}},[o("tooltip",{attrs:{direction:"right",text:r.groupName}},[o("button",{staticClass:"c-group-picture is-unstyled",on:{click:function(a){return e.handleMenuSelect(r.contractID)}}},[o("avatar",{staticClass:"c-avatar",attrs:{src:e.groupPictureForContract(r.contractID)}})],1),e.badgeVisiblePerGroup[r.contractID]?o("badge",{attrs:{type:"compact","data-test":"groupBadge-"+r.groupName}}):e._e()],1)],1)}),o("li",{staticClass:"c-group-list-item"},[o("tooltip",{attrs:{direction:"right",text:e.L("Create a new group")}},[o("button",{staticClass:"is-icon has-background",attrs:{"data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[o("i",{staticClass:"icon-plus"})])])],1)],2):e._e()},cd=[],ld=function(e){e&&e("data-v-1c75e934_0",{source:'.c-badge[data-v-1c75e934]{top:0;right:1px;z-index:2}.c-group-list[data-v-1c75e934]{width:3.5rem;padding-top:.7rem;background-color:var(--general_1)}.c-group-list-item[data-v-1c75e934]{position:relative;display:flex;justify-content:center;align-items:center;height:3.2rem;margin-bottom:.25rem}.group-badge[data-v-1c75e934]::before{content:"";position:absolute;width:3rem;height:3rem;border:1px solid transparent;border-radius:50%;transform:scale(.7);transition:all .25s cubic-bezier(.18,.89,.32,1.38)}.group-badge.is-active[data-v-1c75e934]::before{transform:scale(1);border-color:var(--text_0);animation:spin-data-v-1c75e934 .5s ease-out}.group-badge[data-v-1c75e934]:not(.is-active){cursor:pointer}.group-badge[data-v-1c75e934]:not(.is-active):focus::before,.group-badge[data-v-1c75e934]:not(.is-active):hover::before{border-color:#fff;border-width:3px;transform:scale(1.1)}@keyframes spin-data-v-1c75e934{0%{transform:rotate(45deg);filter:hue-rotate(0);border-color:var(--primary_0) transparent transparent}50%{transform:rotate(315deg);filter:hue-rotate(360deg);border-color:var(--primary_0) transparent transparent}100%{transform:rotate(585deg);border-color:#fff}}.c-avatar[data-v-1c75e934]{position:relative;z-index:1}.c-group-picture[data-v-1c75e934]{display:flex}.c-group-picture.c-global-dashboard-logo[data-v-1c75e934]{background-color:var(--background_0);border-radius:50%;width:2.5rem;height:2.5rem}.c-group-picture.c-global-dashboard-logo[data-v-1c75e934]  img.c-avatar{width:1.75rem;height:1.75rem}',map:void 0,media:void 0})},ud="data-v-1c75e934",dd=void 0,pd=!1;function md(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Ar(){let e=Ar.styles||(Ar.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var fd=md({render:ad,staticRenderFns:cd},ld,sd,ud,pd,dd,!1,Ar,void 0,void 0),zs=fd;var hd={name:"Profile",components:{AvatarUser:xi,ProfileCard:Si},computed:{...H(["ourUsername","ourIdentityContractId"]),ourDisplayName(){let e=this.$store.getters.currentIdentityState;return e&&e.attributes&&e.attributes.displayName}},methods:{openModalUserSettings(){c("okTurtles.events/emit",z,"UserSettingsModal")}}},gd=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.$store.state.loggedIn?o("div",{staticClass:"c-profile",attrs:{"data-test":"userProfile"}},[o("profile-card",{attrs:{contractID:e.ourIdentityContractId,direction:"top-left"}},[o("button",{staticClass:"is-unstyled c-avatar-user",attrs:{"data-test":"openProfileCard"}},[o("avatar-user",{attrs:{contractID:e.ourIdentityContractId,size:"sm"}}),o("div",{staticClass:"c-user"},[o("strong",{staticClass:"has-ellipsis",attrs:{"data-test":e.ourDisplayName?"profileDisplayName":"profileName"}},[e._v(e._s(e.ourDisplayName||e.ourUsername||e.ourIdentityContractId))]),e.ourDisplayName?o("span",{staticClass:"has-ellipsis",attrs:{"data-test":"profileName"}},[e._v("@"+e._s(e.ourUsername))]):e._e()])],1)]),o("button",{staticClass:"is-icon-small",attrs:{"data-test":"settingsBtn"},on:{click:e.openModalUserSettings}},[o("i",{staticClass:"icon-cog"})])],1):e._e()},vd=[],bd=function(e){e&&e("data-v-469c796a_0",{source:".c-profile[data-v-469c796a]{display:flex;justify-content:space-between;align-items:center;height:4rem;padding:0 1rem}.c-avatar-user[data-v-469c796a]{display:flex;align-items:center}.c-avatar-user:focus .c-user strong[data-v-469c796a],.c-avatar-user:hover .c-user strong[data-v-469c796a]{border-bottom-color:var(--text_0)}.c-user[data-v-469c796a]{display:flex;flex-direction:column;align-items:flex-start;margin-left:.5rem;max-width:7rem;white-space:nowrap;line-height:1.3;margin-top:1px}.c-user strong[data-v-469c796a]{border-bottom:1px solid transparent;width:100%}.c-user span[data-v-469c796a]{font-family:Lato;color:var(--text_1);width:100%}button .icon-cog[data-v-469c796a]{font-size:.875rem;transform-origin:49% 48%}button:focus .icon-cog[data-v-469c796a],button:hover .icon-cog[data-v-469c796a]{animation:cog-data-v-469c796a .4s forwards}@keyframes cog-data-v-469c796a{to{transform:rotate(180deg)}}",map:void 0,media:void 0})},_d="data-v-469c796a",yd=void 0,xd=!1;function wd(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Nr(){let e=Nr.styles||(Nr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Sd=wd({render:gd,staticRenderFns:vd},bd,hd,_d,xd,yd,!1,Nr,void 0,void 0),Hs=Sd;var kd={name:"Navigation",mixins:[Yt],components:{Badge:tt,Toggle:Mi,NotificationBell:js,GroupsList:zs,Profile:Hs,ListItem:Di},data(){return{config:{debounceResize:Qe(this.checkIsTouch,250),globalDashboard:Object.entries(Gi).map(([e,t])=>({...t,id:e}))},ephemeral:{isActive:!1,isTouch:null}}},created(){this.checkIsTouch()},mounted(){window.addEventListener("resize",this.config.debounceResize)},beforeDestroy(){window.removeEventListener("resize",this.config.debounceResize)},watch:{$route(e,t){let o=t.path!==e.path;this.ephemeral.isActive&&o&&(this.ephemeral.isActive=!1)}},computed:{...oe(["currentGroupId","loggedIn"]),...H(["groupsByName","colors","totalUnreadNotificationCount","groupUnreadMessages"]),currentGroupUnreadMessagesCount(){return this.currentGroupId?this.groupUnreadMessages(this.currentGroupId):0},logo(){return`/assets/images/logo-transparent${this.colors.theme==="dark"?"-white":""}.png`},isInert(){return!this.ephemeral.isActive&&this.ephemeral.isTouch},notApprovedToGroupYet(){return this.$route.path==="/pending-approval"},isInGlobalDashboard(){return this.$route.path.startsWith("/global-dashboard")}},methods:{toggleMenu(){this.ephemeral.isActive=!this.ephemeral.isActive},openModal(e){c("okTurtles.events/emit",z,e)},checkIsTouch(){this.ephemeral.isTouch=window.innerWidth<1200},onMenuItemsClick(){this.ephemeral.isActive=!1}}},Td=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("nav",{staticClass:"c-navigation",class:{"is-active":e.ephemeral.isActive},attrs:{"aria-label":e.L("Main"),"data-test":"navMenu"}},[o("toggle",{attrs:{element:"navigation","aria-expanded":e.ephemeral.isActive,"data-test":"NavigationToggleBtn"},on:{toggle:e.toggleMenu}},[e.totalUnreadNotificationCount?o("badge",{staticClass:"c-toggle-badge",attrs:{"data-test":"dashboardBadge"}},[e._v(e._s(e.totalUnreadNotificationCount))]):e.currentGroupUnreadMessagesCount?o("badge",{staticClass:"c-toggle-badge",attrs:{"data-test":"dashboardBadge"}},[e._v(e._s(e.currentGroupUnreadMessagesCount))]):e._e()],1),e.groupsByName.length>=1?o("groups-list",{attrs:{inert:e.isInert}}):e._e(),o("div",{staticClass:"c-navigation-wrapper",attrs:{inert:e.isInert}},[e.isInGlobalDashboard?[o("div",{staticClass:"c-navigation-header"},[o("i18n",{staticClass:"sr-only",attrs:{tag:"h1"}},[e._v("Global Dashboard Menu")]),o("img",{staticClass:"c-logo",attrs:{src:e.logo,alt:"GroupIncome's logo"}})],1),o("div",{staticClass:"c-navigation-body"},[o("div",{staticClass:"c-navigation-body-top"},[o("ul",{staticClass:"c-menu-list"},e._l(e.config.globalDashboard,function(r){return o("list-item",{key:r.id,attrs:{tag:"router-link",icon:r.icon,to:r.routeTo,"data-test":"global-dashboard_"+r.id}},[e._v(e._s(r.title))])}),1)])])]:[o("div",{staticClass:"c-navigation-header"},[o("i18n",{staticClass:"sr-only",attrs:{tag:"h1"}},[e._v("Main Menu")]),o("router-link",{attrs:{to:"/home"}},[o("img",{staticClass:"c-logo",attrs:{src:e.logo,alt:"GroupIncome's logo"}})]),e.notApprovedToGroupYet?e._e():o("notification-bell",{attrs:{"data-test":"notificationBell"}})],1),!e.notApprovedToGroupYet&&e.groupsByName.length?o("div",{staticClass:"c-navigation-body",on:{click:function(r){return r.stopPropagation(),e.onMenuItemsClick(r)}}},[o("div",{staticClass:"c-navigation-body-top"},[o("ul",{staticClass:"c-menu-list"},[o("list-item",{attrs:{tag:"router-link",icon:"columns",to:"/dashboard","data-test":"dashboard"}},[o("i18n",[e._v("Dashboard")])],1),o("list-item",{attrs:{tag:"router-link",icon:"chart-pie",to:"/contributions","data-test":"contributionsLink"}},[o("i18n",[e._v("Contributions")])],1),o("list-item",{attrs:{tag:"router-link",icon:"tag",to:"/payments","data-test":"paymentsLink"}},[o("i18n",[e._v("Payments")])],1),o("list-item",{attrs:{tag:"router-link",icon:"comments",to:"/group-chat",badgeCount:e.currentGroupUnreadMessagesCount,"data-test":"groupChatLink"}},[o("i18n",[e._v("Chat")])],1),o("list-item",{attrs:{tag:"router-link",icon:"cog",to:"/group-settings","data-test":"groupSettingsLink"}},[o("i18n",[e._v("Group Settings")])],1)],1),e.groupsByName.length<2?o("div",{staticClass:"c-navigation-separator"},[o("button",{staticClass:"is-small is-outlined",attrs:{"data-test":"createGroup","aria-label":e.L("Add a group")},on:{click:function(r){return e.openModal("GroupCreationModal")}}},[o("i",{staticClass:"icon-plus is-prefix"}),o("i18n",[e._v("Add a group")])],1)]):e._e()]),o("div",{staticClass:"c-navigation-bottom"},[o("ul",{staticClass:"c-menu-list-bottom"},[o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.BLOG_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Blog")]),o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.COMMUNITY_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Help & Feedback")]),o("i18n",{attrs:{tag:"a",href:e.ALLOWED_URLS.DONATE_PAGE,target:"_blank",rel:"noopener noreferrer"}},[e._v("Donate")])],1)])]):e._e()],e.showNav?o("div",{staticClass:"c-navigation-footer"},[o("profile")],1):e._e()],2)],1)},Cd=[],Ed=function(e){e&&e("data-v-813981b2_0",{source:".c-navigation[data-v-813981b2]{display:flex;flex-direction:row;font-weight:400;background:var(--general_2)}.c-navigation-wrapper[data-v-813981b2]{display:flex;flex-direction:column;min-width:14.375rem;justify-content:space-between;height:100%}.c-navigation-header[data-v-813981b2]{display:flex;justify-content:space-between;align-items:center;flex-shrink:0;padding:0 1rem;height:4.6rem;margin-bottom:-.1rem}.c-navigation-body[data-v-813981b2]{display:flex;overflow:auto;-webkit-overflow-scrolling:touch;flex-direction:column;justify-content:space-between;flex-grow:1}.c-navigation-separator[data-v-813981b2]{text-align:center;margin:1.5rem 1.5rem 0 1.5rem;border-top:1px solid var(--general_0);padding-top:1.5rem}.c-navigation-bottom[data-v-813981b2]{padding-top:2rem;padding-bottom:.5rem}.c-navigation-footer[data-v-813981b2]{flex-shrink:0}.c-menu-list-bottom[data-v-813981b2]{display:flex;flex-direction:column;margin-left:1rem;font-size:.75rem}.c-menu-list-bottom a[data-v-813981b2]{line-height:1.65rem;color:var(--text_1)}.c-menu-list-bottom a[data-v-813981b2]:focus,.c-menu-list-bottom a[data-v-813981b2]:hover{color:var(--text_0);outline:0}.c-logo[data-v-813981b2]{min-width:8rem;width:8rem}.c-toggle[data-v-813981b2]{left:100%}",map:void 0,media:void 0})},Ad="data-v-813981b2",Nd=void 0,Rd=!1;function Od(e,t,o,r,s,a,n,l,m,p){let i=(typeof o=="function"?o.options:o)||{};i.__file=`style>
`,i.render||(i.render=e.render,i.staticRenderFns=e.staticRenderFns,i._compiled=!0,s&&(i.functional=!0)),i._scopeId=r;{let u;if(t&&(u=n?function(d){t.call(this,p(d,this.$root.$options.shadowRoot))}:function(d){t.call(this,l(d))}),u!==void 0)if(i.functional){let d=i.render;i.render=function(g,v){return u.call(v),d(g,v)}}else{let d=i.beforeCreate;i.beforeCreate=d?[].concat(d,u):[u]}}return i}function Rr(){let e=Rr.styles||(Rr.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,s){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?s.media||"default":r,n=e[a]||(e[a]={ids:[],parts:[],element:void 0});if(!n.ids.includes(r)){let l=s.source,m=n.ids.length;if(n.ids.push(r),s.map&&(l+=`
/*# sourceURL=`+s.map.sources[0]+" */",l+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(s.map))))+" */"),t&&(n.element=n.element||document.querySelector("style[data-group="+a+"]")),!n.element){let p=document.head||document.getElementsByTagName("head")[0],i=n.element=document.createElement("style");i.type="text/css",s.media&&i.setAttribute("media",s.media),t&&(i.setAttribute("data-group",a),i.setAttribute("data-next-index","0")),p.appendChild(i)}if(t&&(m=parseInt(n.element.getAttribute("data-next-index")),n.element.setAttribute("data-next-index",m+1)),n.element.styleSheet)n.parts.push(l),n.element.styleSheet.cssText=n.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(l),i=n.element.childNodes;i[m]&&n.element.removeChild(i[m]),i.length?n.element.insertBefore(p,i[m]):n.element.appendChild(p)}}}}var Pd=Od({render:Td,staticRenderFns:Cd},Ed,kd,Ad,Rd,Nd,!1,Rr,void 0,void 0),Ws=Pd;var qs=Re(Vs());var Ld=["primary","warning","danger","success"],Pr=Xt.light;c("sbp/selectors/register",{"gi.utils/avatar/create":function(){let e,t;try{let o=zn(Ld);e=qs.default.create({bgcolor:Pr[`${o}_0`],color:Pr[`${o}_1`],spotcolor:Pr[`${o}_2`],size:6,scale:12}).toDataURL("image/png"),t=Oi(e)}catch(o){return console.warn("utils/avatar.js Avatar generation process didn't go well.",o),null}return t}});var Ys=Re(Dr());Q();var Xs=Re(Dr());Q();var Gr={ALLOWED_ATTR:["class"],ALLOWED_TAGS:["b","br","em","i","p","small","span","strong","sub","sup","u","s","code","ul","li","pre","blockquote","del"],RETURN_DOM_FRAGMENT:!0},Ks=(e,t)=>{if(t.oldValue!==t.value){let o=Gr,r={a:["href","target"],button:["type"]};Object.keys(r).includes(t.arg)&&(o=F(o),o.ALLOWED_TAGS.push(t.arg),o.ALLOWED_ATTR.push(...r[t.arg]||[])),e.textContent="",e.appendChild(Xs.default.sanitize(t.value,o))}};I.directive("safe-html",{bind:Ks,update:Ks});I.prototype.L=b;I.prototype.LTags=ye;var Md={...Gr,ALLOWED_ATTR:["class","href","rel","target"],ALLOWED_TAGS:["a","b","br","button","em","i","p","small","span","strong","sub","sup","u"],RETURN_DOM_FRAGMENT:!1};function Js(e){return Ys.default.sanitize(e,Md)}I.component("i18n",{functional:!0,props:{args:[Object,Array],tag:{type:String,default:"span"},compile:Boolean},render:function(e,t){let o=t.children[0].text,r=b(o,t.props.args||{});return r?(t.props.tag==="a"&&t.data.attrs.target==="_blank"&&(t.data.attrs.rel="noopener noreferrer"),t.props.compile?I.compile("<wrap>"+Js(r)+"</wrap>").render.call({_c:(a,...n)=>a==="wrap"?e(t.props.tag,t.data,...n):e(a,...n),_v:a=>a}):(t.data.domProps||(t.data.domProps={}),t.data.domProps.innerHTML=Js(r),e(t.props.tag,t.data))):(console.warn("The following i18n text was not translated correctly:",o),e(t.props.tag,t.data,o))}});Q();I.directive("error",{inserted(e,t,o){if(!t.arg)throw new Error(`v-error: missing argument on ${e.outerHTML}`);if(!o.context.$v.form[t.arg])throw new Error(`v-error: vuelidate doesn't have validation for ${t.arg}`);let r=t.value||{},s=document.createElement(r.tag||"span");for(let a in r.attrs)s.setAttribute(a,r.attrs[a]);s.classList.add("error","is-hidden"),e.insertAdjacentElement("afterend",s)},update(e,t,o){if(o.context.$v.form[t.arg].$error){for(let r in o.context.$v.form[t.arg].$params)if(!o.context.$v.form[t.arg][r]){e.nextElementSibling.innerText=r;break}e.nextElementSibling.classList.remove("is-hidden")}else e.nextElementSibling.classList.add("is-hidden")},unbind(e){e.nextElementSibling.remove()}});Q();I.directive("focus",{inserted:(e,t)=>{(!t||t.value!==!1)&&e.focus()}});var Qs={fetch:typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",streams:typeof ReadableStream=="function",webSocket:typeof WebSocket=="function",reflect:typeof Reflect=="object",serviceWorker:typeof Navigator=="function"&&typeof navigator=="object"&&navigator instanceof Navigator&&typeof navigator=="object"&&typeof ServiceWorkerContainer=="function"&&navigator.serviceWorker instanceof ServiceWorkerContainer,indexedDB:typeof IDBFactory=="function"&&typeof indexedDB=="object"&&indexedDB instanceof IDBFactory,sessionStorage:typeof Storage=="function"&&typeof sessionStorage=="object"&&sessionStorage instanceof Storage};console.info("Feature check",Qs);var Dd=Object.values(Qs).every(Boolean),Fr=Dd;Q();var Ur,it={MIN1:"1MIN",MIN5:"5MIN",MIN15:"15MIN",MIN30:"30MIN"},ee={notifications:[],partition:Object.create(null)},Gd={[it.MIN1]:1*yt,[it.MIN5]:5*yt,[it.MIN15]:15*yt,[it.MIN30]:30*yt},Fd=di({stateKey:e=>{if(e=pi(e),e.length===0)throw new TypeError("Empty notification data state key");return e},emitCondition:Kt,emit:Kt,shouldClearStateKey:Kt});async function Zs(){let e=c("state/vuex/state"),t=c("state/vuex/getters"),o=e.periodicNotificationAlreadyFiredMap.alreadyFired,r=e.periodicNotificationAlreadyFiredMap.lastRun,s=(l,m)=>l.call(ee.partition[m],{rootState:e,rootGetters:t});if(ee.clearTimeout)return;let a=!1,n=()=>{a=!0};ee.clearTimeout=n,await Promise.all(Object.entries(c("okTurtles.eventQueue/queuedInvocations")).map(([l,m])=>!!m.length&&c("okTurtles.eventQueue/queueEvent",l,()=>{}).catch(()=>{})));for(let l of ee.notifications){if(a)break;let m=l.stateKey,p=r[m]||0,i=l.delay;if(Date.now()-p>=i){try{!o[m]&&s(l.emitCondition,m)&&(await s(l.emit,m),o[m]=!0),o[m]&&s(l.shouldClearStateKey,m)&&delete o[m]}catch(u){console.error("runNotificationListRecursive: Error calling notification",m,u)}r[m]=Date.now()}}ee.clearTimeout===n&&(ee.clearTimeout=(()=>{let l=setTimeout(()=>{delete ee.clearTimeout,Zs()},Ur);return()=>clearTimeout(l)})())}function Ud(){ee.clearTimeout&&(ee.clearTimeout(),delete ee.clearTimeout),ee.notifications.forEach(({stateKey:e})=>{ee.partition[e]=Object.create(null)})}c("sbp/selectors/register",{"gi.periodicNotifications/init":function(){return Zs().catch(e=>{console.error("[gi.periodicNotifications/init] Error",e)})},"gi.periodicNotifications/clearStatesAndStopTimers":function(){let e=c("state/vuex/state");e.periodicNotificationAlreadyFiredMap={alreadyFired:Object.create(null),lastRun:Object.create(null)},Ud()},"gi.periodicNotifications/importNotifications":function(e){let t=new Set;for(let{type:o,notificationData:r}of e){if(!o||!r)throw new Error("A required field in a periodic notification entry is missing.");let s=Gd[o];if(!s)throw new RangeError("Invalid delay");if(Ur<=s||(Ur=s),Fd(r),t.has(r.stateKey))throw new Error("Duplicate periodic notification state key: "+r.stateKey);t.add(r.stateKey),ee.partition[r.stateKey]=Object.create(null),ee.notifications.push({...r,delay:s})}}});var $d=(e,t="")=>(t?c("state/vuex/getters").notificationsByGroup(t):c("state/vuex/getters").currentNotifications).some(r=>e(r)),Bd=[{name:"INCOME_DETAILS_OLD",emitCondition({rootGetters:e}){let{incomeDetailsLastUpdatedDate:t}=e.ourGroupProfile||{},o=qt(new Date);return t&&ai(o,t)>6*ri&&!$d(r=>r.type==="INCOME_DETAILS_OLD"&&r.data.lastUpdatedDate===t)},emit({rootGetters:e}){c("gi.notifications/emit","INCOME_DETAILS_OLD",{months:6,lastUpdatedDate:e.ourGroupProfile.incomeDetailsLastUpdatedDate})}}],jd=[{type:it.MIN30,notificationData:{stateKey:"username-fetch",emitCondition:()=>!0,emit({rootState:e,rootGetters:t}){Object.values(t.ourContactProfilesById).filter(({username:o,contractID:r})=>!o&&!!e[r]?.attributes?.username).forEach(({contractID:o})=>{let r=e[o].attributes.username;c("namespace/lookup",r,{skipCache:!0}).then(s=>{s!==o&&console.error(`[periodic notification] Mismatched username. The lookup result was ${s} instead of ${o}`)}).catch(s=>{console.error("[periodic notification] Error looking up username",r,"for",o,s)})})},shouldClearStateKey:()=>!0}}],zd={methods:{initOrResetPeriodicNotifications(){c("gi.periodicNotifications/clearStatesAndStopTimers"),c("gi.periodicNotifications/init")},async checkAndEmitOneTimeNotifications(){let e={rootState:c("state/vuex/state"),rootGetters:c("state/vuex/getters")};for(let t of Bd)t.emitCondition(e)&&await t.emit(e)}},mounted(){c("gi.periodicNotifications/importNotifications",jd)}},ea=zd;var st=null,Ct=null,Be,Tt=null,Ne={},je=Math.ceil(window.devicePixelRatio)||1,at=16*je,$r={width:8,height:8,background:"#ff0000",crossOrigin:!0},Hd=()=>{let e=document.getElementsByTagName("link");for(let t=0,o=e.length;t<o;t++)if((e[t].getAttribute("rel")||"").match(/\bicon\b/i))return e[t];return null},Wd=()=>{let e=document.getElementsByTagName("link");for(let t=0,o=e.length;t<o;t++)typeof e[t]<"u"&&(e[t].getAttribute("rel")||"").match(/\bicon\b/i)&&e[t].parentNode?.removeChild(e[t])},Vd=()=>((!Ct||!st)&&(st=Hd()?.getAttribute("href")||"/assets/images/group-income-icon-transparent.png",Ct||(Ct=st)),st),Br=()=>(Tt||(Tt=document.createElement("canvas"),Tt.width=at,Tt.height=at),Tt),ta=e=>{if(e){Wd();let t=document.createElement("link");t.type="image/x-icon",t.rel="icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},qd=e=>{let t=Br().getContext("2d"),o=Vd();Be=document.createElement("img"),Be.onload=function(){t.clearRect(0,0,at,at),t.drawImage(Be,0,0,Be?.width,Be?.height,0,0,at,at),e&&Kd(t),oa()},!o?.match(/^data/)&&Ne.crossOrigin&&(Be.crossOrigin="anonymous"),Be.src=o},Kd=e=>{let t=Ne.width*je+6*je,o=Ne.height*je,r=16*je,s=16*je,a=Math.min(t,o)/2;e.fillStyle=Ne.background,e.strokeStyle=Ne.background,e.lineWidth=je,e.arc(s-a,r-a,a,0,2*Math.PI),e.fill()},oa=()=>{Br()instanceof HTMLCanvasElement&&ta(Br().toDataURL())},ra={setOptions:function(e){Ne={};for(let t in $r)Ne[t]=e[t]||$r[t]},setImage:function(e){st=e,oa()},setBubble:function(e){qd(e)},reset:function(){st=Ct,ta(Ct)}};Object.keys(Ne).length||ra.setOptions($r);var na=ra;Q();var la=Re(ca());"ontouchstart"in window||"msMaxTouchPoints"in navigator?import("./vue2-touch-events-JB3IBENJ-cached.js").then(e=>I.use(e.default)):I.directive("touch",{});I.use(la.default);Q();I.component("v-style",{render:function(e){return e("style",this.$slots.default)}});console.info("GI_VERSION:","2.0.0");console.info("GI_GIT_VERSION:","v2.0.0");console.info("CONTRACTS_VERSION:","2.0.0");console.info("LIGHTWEIGHT_CLIENT:","true");console.info("NODE_ENV:","production");c("okTurtles.data/set","API_URL",self.location.origin);I.config.errorHandler=function(e,t,o){console.error(`uncaught Vue error in ${o}:`,e)};async function pp(){let e=new URLSearchParams(window.location.search).get("debug");if(e==="true"){let s=(l,m)=>(l[m]=!0,l),a=["sbp","okTurtles.data"].reduce(s,{}),n=["chelonia.db/get","chelonia.db/set","chelonia/rootState","chelonia/haveSecretKey","chelonia/private/enqueuePostSyncOps","chelonia/private/invoke","state/vuex/state","state/vuex/getters","state/vuex/settings","gi.db/settings/save"].reduce(s,{});c("sbp/filters/global/add",(l,m,p)=>{a[l]||n[m]||console.debug(`[sbp] ${m}`,p)}),c("sbp/filters/selector/add","gi.db/settings/save",(l,m,p)=>{console.debug("[sbp] 'gi.db/settings/save'",p[0])})}c("chelonia/externalStateSetup",{stateSelector:"state/vuex/state",reactiveSet:I.set,reactiveDel:I.delete}),c("okTurtles.events/on",Rn,({name:s,value:a,deletedValue:n})=>{let l=c("state/vuex/state").namespaceLookups,m=c("state/vuex/state").reverseNamespaceLookups;n?(I.delete(l,s),m[n]===s&&I.delete(m,n)):(I.set(l,s,a),I.set(m,a,s))}),c("okTurtles.events/on",Fn,(s,{contractID:a})=>{if(console.error("Serious error",a,s),c("gi.ui/seriousErrorBanner",s),s?.name==="ChelErrorForkedChain"){let n=c("state/vuex/state");if(!n.contracts[a]){console.error("Forked chain detected. However, there is no contract entry.",{contractID:a},s);return}let l=n.contracts[a].type||"(unknown)";console.error("Forked chain detected",{contractID:a,type:l},s),confirm(b(`The server's history for '{type}' has diverged from ours. This can happen in extremely rare circumstances due to either malicious activity or a bug.

To fix this, the contract needs to be resynced, and some recent events may be missing. Would you like to do so now?

(If problems persist, please open the Troubleshooting page under the User Settings and resync all contracts.)`,{type:l}))&&(c("gi.ui/clearBanner"),(n.loggedIn?.identityContractID===a?c("gi.actions/identity/logout",null,!0):c("chelonia/contract/sync",a,{resync:!0})).catch(p=>{console.error("Error during re-sync",a,p),alert(b(`There was a problem resyncing the contract: {errMsg}

Please see the Application Logs under User Settings for more details. The Troubleshooting page in User Settings may be another way to fix the problem.`,{errMsg:p?.message||p}))}))}}),(window.Cypress||e)&&(window.sbp=c);let t={ephemeral:{debouncedSyncBanner(){},syncs:[]}},o=function(s,a){a?(this.ephemeral.syncs.push(s),this.ephemeral.debouncedSyncBanner()):this.ephemeral.syncs.includes(s)&&(this.ephemeral.syncs=this.ephemeral.syncs.filter(n=>n!==s))},r=o.bind(t);try{await c("translations/init",navigator.language)}catch(s){let a=`Fatal error while initializing Group Income: ${s.name} - ${s.message}

Please report this bug here: ${zt.ISSUE_PAGE}`;console.error(a,s),alert(a);return}Fr&&await Promise.race([c("service-worker/setup"),new Promise((s,a)=>{setTimeout(()=>{a(new Error("Timed out setting up service worker"))},8e3)})]).catch(s=>{throw console.error("[main] Error setting up service worker",s),alert(b("Error while setting up service worker: {err}",{err:s.message})),window.location.reload(),s}),new I({router:mo,mixins:[ea,Yt],components:{AppStyles:Gs,BackgroundSounds:$s,BannerGeneral:Fs,Navigation:Ws,Modal:Us},data(){return{ephemeral:{syncs:[],finishedLogin:"no",debouncedSyncBanner:null,isCorrupted:!1,ready:!1}}},created(){c("okTurtles.events/on",jt,s=>{this.ephemeral.syncs=s})},mounted(){let s=null;((window.matchMedia("(prefers-reduced-motion: reduce)")||{}).matches||this.isInCypress)&&this.setReducedMotion(!0);let{bannerGeneral:n}=this.$refs;if(c("okTurtles.data/set","BANNER",n),!Fr){this.removeLoadingAnimation(),c("gi.ui/prompt",{heading:b("Unsupported browser"),question:b("This browser doesn't support all features required to use Group Income. Please try a different browser.")});return}this.ephemeral.debouncedSyncBanner=n.debouncedShow({message:()=>b("Loading events from server..."),icon:"wifi",seconds:2,clearWhen:()=>!this.ephemeral.syncs.length}),this.ephemeral.syncs=t.ephemeral.syncs,this.ephemeral.syncs.length&&this.ephemeral.debouncedSyncBanner(),c("okTurtles.events/off",zo,r),c("okTurtles.events/on",zo,o.bind(this)),c("okTurtles.events/on",we,()=>{if(Wn(),!c("state/vuex/state").loggedIn){console.warn("Received LOGIN_COMPLETE event but there state.loggedIn is not an object");return}this.ephemeral.finishedLogin="yes",this.$store.state.currentGroupId&&(this.initOrResetPeriodicNotifications(),this.checkAndEmitOneTimeNotifications()),I.use(ua.default,{store:se,idleTime:2*60*1e3})}),c("okTurtles.events/on",Ye,()=>{let l=c("state/vuex/state");l.loggedIn&&(this.ephemeral.finishedLogin="no",c("gi.periodicNotifications/clearStatesAndStopTimers"),c("gi.db/settings/delete",l.loggedIn.identityContractID).catch(m=>{console.error("Logout event: error deleting settings")}),c("state/vuex/reset"),mo.currentRoute.path!=="/"&&mo.push({path:"/"}).catch(console.error))}),c("okTurtles.events/once",Oe,()=>{this.removeLoadingAnimation()}),c("okTurtles.events/on",$t,({contractID:l,isNewlyCreated:m})=>{this.initOrResetPeriodicNotifications(),this.checkAndEmitOneTimeNotifications()}),c("okTurtles.events/on",yn,()=>{c("state/vuex/state").loggedIn&&c("service-worker/setup-push-subscription").catch(m=>{console.error("came back online, tried to report push subscription, but got:",m)}),c("gi.ui/clearBanner")}),c("okTurtles.events/on",Fo,()=>{c("gi.ui/showBanner",b("Your device appears to be offline."),"wifi")}),c("okTurtles.events/on",xn,()=>{c("gi.ui/showBanner",b("Trying to reconnect..."),"wifi")}),c("okTurtles.events/on",wn,()=>{c("gi.ui/showBanner",b("We could not connect to the server. Please refresh the page."),"wifi")}),c("okTurtles.events/on",Sn,({contractID:l,key:m,data:p})=>{switch(m){case vt.LAST_LOGGED_IN:{c("state/vuex/commit","setLastLoggedIn",[l,p]);break}case vt.UNREAD_MESSAGES:c("state/vuex/commit","setUnreadMessages",p);break;case vt.PREFERENCES:c("state/vuex/commit","setPreferences",p);break;case vt.NOTIFICATIONS:c("state/vuex/commit","setNotificationStatus",p);break}}),navigator.onLine===!1&&c("okTurtles.events/emit",Fo),this.ephemeral.isCorrupted&&c("gi.ui/dangerBanner",b("Your app seems to be corrupted. Please {a_}re-sync your app data.{_a}",{a_:`<a class="link" href="${window.location.pathname}?modal=UserSettingsModal&tab=troubleshooting">`,_a:"</a>"}),"times-circle"),c("okTurtles.events/emit",ft,this.$store.state.settings.themeColor),this.setBadgeOnTab(),(async()=>{try{let l=await c("gi.db/settings/load",ns);if(s=l,l&&this.ephemeral.finishedLogin!=="yes"){let m=c("okTurtles.events/once",z,()=>{this.removeLoadingAnimation()});await c("gi.app/identity/login",{identityContractID:l}),m(),await c("chelonia/contract/wait",l)}this.ephemeral.ready=!0,this.removeLoadingAnimation()}catch(l){this.removeLoadingAnimation(),s&&c("appLogs/clearLogs",s).catch(m=>{console.error("[main] Error clearing logs for old session",s,m)}),console.error(`[main] caught ${l?.name} while fetching settings or handling a login error: ${l?.message||l}`,l),await c("gi.app/identity/logout"),await c("gi.ui/prompt",{heading:b("Failed to login"),question:b("Error details: {reportError}",Xe(l)),primaryButton:b("Close")})}})()},computed:{...H(["groupsByName","ourUnreadMessages","totalUnreadNotificationCount"]),...oe(["contracts"]),ourUnreadMessagesCount(){return Object.keys(this.ourUnreadMessages).map(s=>this.ourUnreadMessages[s].unreadMessages.length).reduce((s,a)=>s+a,0)},shouldSetBadge(){return this.ourUnreadMessagesCount+this.totalUnreadNotificationCount>0},appClasses(){return{"l-with-navigation":this.showNav,"l-no-navigation":!this.showNav,"js-reducedMotion":this.$store.state.settings.reducedMotion,"is-dark-theme":this.$store.getters.isDarkTheme}},isInCypress(){return!!window.Cypress}},methods:{...Vn(["setReducedMotion"]),setBadgeOnTab(){na.setBubble(this.shouldSetBadge)},removeLoadingAnimation(){let s=document.querySelector("#main-loading-screen");s&&s.remove()}},watch:{shouldSetBadge(s,a){this.setBadgeOnTab()}},store:se}).$mount("#app")}pp();
/*!
 * FaviconBadge - A small library for manipulating the Favicon
 * Modified from Tinycon.js by Tom Moor
 * Original project: https://github.com/tommoor/tinycon
 * Copyright (c) 2023 Alex Jin
 * @license MIT Licensed
 */
/*! Bundled license information:

dompurify/dist/purify.js:
  (*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.2.2/LICENSE *)

portal-vue/dist/portal-vue.common.js:
  (*! 
   * portal-vue  Thorsten Lnborg, 2019 
   * 
   * Version: 2.1.7
   * 
   * LICENCE: MIT 
   * 
   * https://github.com/linusborg/portal-vue
   * 
  *)
*/
//# sourceMappingURL=main.js.map
